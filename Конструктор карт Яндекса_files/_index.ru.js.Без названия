!function(t){var e,i={NOT_RESOLVED:"NOT_RESOLVED",IN_RESOLVING:"IN_RESOLVING",RESOLVED:"RESOLVED"},o=function(){var u={trackCircularDependencies:!0,allowMultipleDeclarations:!0},h={},p=!1,m=[],g=function(t,o,n){n||(n=o,o=[]);var s=h[t];s||(s=h[t]={name:t,decl:e}),s.decl={name:t,prev:s.decl,fn:n,state:i.NOT_RESOLVED,deps:o,dependents:[],exports:e}},f=function(e,i,o){"string"==typeof e&&(e=[e]),p||(p=!0,d(y)),m.push({deps:e,cb:function(e,s){s?(o||n)(s):i.apply(t,e)}})},_=function(t){var e=h[t];return e?i[e.decl.state]:"NOT_DEFINED"},b=function(t){return!!h[t]},v=function(t){for(var e in t)t.hasOwnProperty(e)&&(u[e]=t[e])},y=function(){p=!1,M()},M=function(){var t,e=m,i=0;for(m=[];t=e[i++];)j(null,t.deps,[],t.cb)},j=function(t,e,o,n){var a=e.length;a||n([]);for(var c,d,p=[],m=0,g=a;g>m;){if(c=e[m++],"string"==typeof c){if(!h[c])return void n(null,s(c,t));d=h[c].decl}else d=c;if(d.state===i.IN_RESOLVING&&u.trackCircularDependencies&&l(d,o))return void n(null,r(d,o));p.push(d),I(d,o,function(t,e){if(e)return void n(null,e);if(!--a){for(var i,o=[],s=0;i=p[s++];)o.push(i.exports);n(o)}})}},I=function(e,o,n){if(e.state===i.RESOLVED)return void n(e.exports);if(e.dependents.push(n),e.state!==i.IN_RESOLVING){if(e.prev&&!u.allowMultipleDeclarations)return void k(e,c(e));u.trackCircularDependencies&&(o=o.slice()).push(e);var s=!1,r=e.prev?e.deps.concat([e.prev]):e.deps;e.state=i.IN_RESOLVING,j(e,r,o,function(i,o){return o?void k(e,o):(i.unshift(function(t,i){return s?void n(null,a(e)):(s=!0,void(i?k(e,i):C(e,t)))}),void e.fn.apply({name:e.name,deps:e.deps,global:t},i))})}},C=function(t,o){t.exports=o,t.state=i.RESOLVED;for(var n,s=0;n=t.dependents[s++];)n(o);t.dependents=e},k=function(t,e){t.state=i.NOT_RESOLVED;for(var o,n=0;o=t.dependents[n++];)o(null,e);t.dependents=[]};return{create:o,define:g,require:f,getState:_,isDefined:b,setOptions:v}},n=function(t){d(function(){throw t})},s=function(t,e){return Error(e?'Module "'+e.name+'": can\'t resolve dependence "'+t+'"':'Required module "'+t+"\" can't be resolved")},r=function(t,e){for(var i,o=[],n=0;i=e[n++];)o.push(i.name);return o.push(t.name),Error('Circular dependence has been detected: "'+o.join(" -> ")+'"')},a=function(t){return Error('Declaration of module "'+t.name+'" has already been provided')},c=function(t){return Error('Multiple declarations of module "'+t.name+'" have been detected')},l=function(t,e){for(var i,o=0;i=e[o++];)if(t===i)return!0;return!1},d=function(){var e=[],i=function(t){return 1===e.push(t)},o=function(){var t=e,i=0,o=e.length;for(e=[];o>i;)t[i++]()};if("object"==typeof process&&process.nextTick)return function(t){i(t)&&process.nextTick(o)};if(t.setImmediate)return function(e){i(e)&&t.setImmediate(o)};if(t.postMessage&&!t.opera){var n=!0;if(t.attachEvent){var s=function(){n=!1};t.attachEvent("onmessage",s),t.postMessage("__checkAsync","*"),t.detachEvent("onmessage",s)}if(n){var r="__modules"+ +new Date,a=function(t){t.data===r&&(t.stopPropagation&&t.stopPropagation(),o())};return t.addEventListener?t.addEventListener("message",a,!0):t.attachEvent("onmessage",a),function(e){i(e)&&t.postMessage(r,"*")}}}var c=t.document;if("onreadystatechange"in c.createElement("script")){var l=c.getElementsByTagName("head")[0],d=function(){var t=c.createElement("script");t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,o()},l.appendChild(t)};return function(t){i(t)&&d()}}return function(t){i(t)&&setTimeout(o,0)}}();"object"==typeof exports?module.exports=o():t.modules=o()}(this),"undefined"==typeof window&&"undefined"!=typeof module&&(modules=module.exports),function(t){var e=function(){function t(){this._lastMatchId=0,this._matchers=[],this._infiniteLoopDetection=!1,this.lib={},this._shortTags={};for(var t=0;t<i.length;t++)this._shortTags[i[t]]=1;this._options={},this._optJsAttrName="onclick",this._optJsAttrIsJs=!0,this._optJsCls="i-bem",this._optJsElem=!0,this._optEscapeContent=!1,this._optNobaseMods=!1,this._optDelimElem="__",this._optDelimMod="_",this._optShortTagCloser="/>",this.utils={_expandoId:(new Date).getTime(),bh:this,isSimple:function(t){if(!t||t===!0)return!0;var e=typeof t;return"string"===e||"number"===e},extend:function(t){t&&"object"==typeof t||(t={});for(var e=1,i=arguments.length;i>e;e++){var o,n=arguments[e];if(n)for(o in n)t[o]=n[o]}return t},position:function(){var t=this.node;return"content"===t.index?1:t.position},isFirst:function(){var t=this.node;return"content"===t.index||1===t.position},isLast:function(){var t=this.node;return"content"===t.index||t.position===t.arr._listLength},tParam:function(t,e,i){var o="__tp_"+t,n=this.node;if(arguments.length>1)return(i||!this.tParam(t))&&(n[o]=e),this;for(;n;){if(n.hasOwnProperty(o))return n[o];n=n.parentNode}return void 0},process:function(t){var e=this.ctx,i=this.node,o=this.bh.processBemJson(t,e.block);return this.ctx=e,this.node=i,o},applyBase:function(){var t=this.node,e=t.json,i=e.block,o=e.mods,n=this.bh._fastMatcher(this,e);return void 0!==n&&(this.ctx=t.arr[t.index]=t.json=n,t.block=i,t.mods=o),this},stop:function(){return this.ctx._stop=!0,this},generateId:function(){return"uniq"+this._expandoId+ ++e},mod:function(t,e,i){var o=this.ctx.elem?"elemMods":"mods";if(arguments.length>1){var n=this.ctx[o];return n[t]=!n.hasOwnProperty(t)||i?e:n[t],this}return this.ctx[o][t]},mods:function(t,e){var i=this.ctx.elem?"elemMods":"mods",o=this.ctx[i];return void 0!==t?(this.ctx[i]=e?this.extend(o,t):this.extend(t,o),this):o},tag:function(t,e){return void 0===t?this.ctx.tag:((e||void 0===this.ctx.tag)&&(this.ctx.tag=t),this)},mix:function(t,e){return void 0===t?this.ctx.mix:(this.ctx.mix=e||!this.ctx.mix?t:(Array.isArray(this.ctx.mix)?this.ctx.mix:[this.ctx.mix]).concat(t),this)},attr:function(t,e,i){var o;return arguments.length>1?(o=this.ctx.attrs||(this.ctx.attrs={}),o[t]=!o.hasOwnProperty(t)||i?e:o[t],this):(o=this.ctx.attrs,o?o[t]:void 0)},attrs:function(t,e){var i=this.ctx.attrs||{};return void 0===t?i:(this.ctx.attrs=e?this.extend(i,t):this.extend(t,i),this)},bem:function(t,e){return void 0===t?this.ctx.bem:((e||void 0===this.ctx.bem)&&(this.ctx.bem=t),this)},js:function(t,e){var i=this.ctx;return void 0===t?i.js:(e||void 0===i.js?i.js=t:i.js!==!1&&(i.js=this.extend(i.js,t)),this)},cls:function(t,e){return void 0===t?this.ctx.cls:((e||void 0===this.ctx.cls)&&(this.ctx.cls=t),this)},param:function(t,e,i){return void 0===e?this.ctx[t]:((i||void 0===this.ctx[t])&&(this.ctx[t]=e),this)},content:function(t,e){return void 0===t?this.ctx.content:((e||void 0===this.ctx.content)&&(this.ctx.content=t),this)},html:function(t,e){return void 0===t?this.ctx.html:((e||void 0===this.ctx.html)&&(this.ctx.html=t),this)},json:function(){return this.ctx}}}var e=0;t.prototype={constructor:t,setOptions:function(t){var e;for(e in t)this._options[e]=t[e];if(t.jsAttrName&&(this._optJsAttrName=t.jsAttrName),t.jsAttrScheme&&(this._optJsAttrIsJs="js"===t.jsAttrScheme),void 0!==t.jsCls&&(this._optJsCls=t.jsCls),t.hasOwnProperty("jsElem")&&(this._optJsElem=t.jsElem),t.clsNobaseMods&&(this._optNobaseMods=!0),t.escapeContent&&(this._optEscapeContent=t.escapeContent),t.delimElem&&(this._optDelimElem=t.delimElem),t.delimMod&&(this._optDelimMod=t.delimMod),t.xhtml===!1&&(this._optShortTagCloser=">"),t.shortTags)for(var i=0;i<t.shortTags.length;i++)this._shortTags[t.shortTags[i]]=1;return this},getOptions:function(){return this._options},enableInfiniteLoopDetection:function(t){return this._infiniteLoopDetection=t,this},apply:function(t){return this.toHtml(this.processBemJson(t))},match:function(t,e){if(!t)return this;if(Array.isArray(t))return t.forEach(function(i,o){this.match(t[o],e)},this),this;if("object"==typeof t){for(var i in t)this.match(i,t[i]);return this}return e.__id="__func"+this._lastMatchId++,this._matchers.push([t,e]),this._fastMatcher=null,this},beforeEach:function(t){return this.match("$before",t)},afterEach:function(t){return this.match("$after",t)},buildMatcher:function(){function t(t,e){for(var i={},o=0,n=t.length;n>o;o++){var s=t[o],r=s[e]||"__no_value__";(i[r]||(i[r]=[])).push(s)}return i}function e(t,e,i){t.push("json."+e+" = true;","subRes = _m"+i+"(ctx, json);",'if (subRes !== undefined) return (subRes || "");',"if (json._stop) return;")}var i,o,n,s,r,a,c,l,d=[],u=["bh = this"],h=this._matchers,p=[];for(i=h.length-1;i>=0;i--)a=h[i],r=a[0],u.push("_m"+i+" = ms["+i+"][1]"),s={fn:a[1],index:i},~r.indexOf(this._optDelimElem)?(c=r.split(this._optDelimElem),l=c[0].split(this._optDelimMod),s.block=l[0],l.length>1&&(s.blockMod=l[1],s.blockModVal=l[2]||!0),c=c[1].split(this._optDelimMod),s.elem=c[0],c.length>1&&(s.elemMod=c[1],s.elemModVal=c[2]||!0)):(c=r.split(this._optDelimMod),s.block=c[0],c.length>1&&(s.blockMod=c[1],s.blockModVal=c[2]||!0)),p.push(s);var m=t(p,"block"),g=m.$before,f=m.$after;if(f&&delete m.$after,d.push("var "+u.join(", ")+";","function applyMatchers(ctx, json) {","var subRes;"),g)for(delete m.$before,o=0,n=g.length;n>o;o++)s=g[o],e(d,s.fn.__id,s.index);d.push("switch (json.block) {");for(var _ in m){d.push('case "'+_+'":');var b=t(m[_],"elem");d.push("switch (json.elem) {");for(var v in b){d.push("__no_value__"===v?"case undefined:":'case "'+v+'":');var y=b[v];for(o=0,n=y.length;n>o;o++){s=y[o];var M=s.fn,j=[];j.push("!json."+M.__id),s.elemMod&&j.push('json.elemMods && json.elemMods["'+s.elemMod+'"] === '+(s.elemModVal===!0||'"'+s.elemModVal+'"')),s.blockMod&&j.push('json.mods && json.mods["'+s.blockMod+'"] === '+(s.blockModVal===!0||'"'+s.blockModVal+'"')),d.push("if ("+j.join(" && ")+") {"),e(d,M.__id,s.index),d.push("}")}d.push("break;")}d.push("}","break;")}if(d.push("}"),f)for(o=0,n=f.length;n>o;o++)s=f[o],e(d,s.fn.__id,s.index);return d.push("};","return applyMatchers;"),d.join("\n")},processBemJson:function(t,e,i){function o(){this.ctx=null}if(null!=t){var n,s,r,a,c,l,d,u,h,p,m=[t],g=[{json:t,arr:m,index:0,block:e,mods:null}],f=this._fastMatcher||(this._fastMatcher=Function("ms",this.buildMatcher())(this._matchers)),_=!i,b=this._infiniteLoopDetection;o.prototype=this.utils;for(var v=new o;n=g.shift();){if(s=n.json,r=n.block,a=n.mods,Array.isArray(s)){for(c=0,l=0,d=s.length;d>c;c++)h=s[c],h!==!1&&null!=h&&"object"==typeof h&&g.push({json:h,arr:s,index:c,position:++l,block:r,mods:a,parentNode:n});s._listLength=l}else{var y,M=!1;if(s.elem?(r=s.block=s.block||r,s.elemMods||(s.elemMods=s.mods||{},s.mods=null),a=s.mods=s.mods||a):s.block&&(r=s.block,a=s.mods=s.mods||{}),"object"==typeof s){if(b){if(s.__processCounter=(s.__processCounter||0)+1,f.__processCounter=(f.__processCounter||0)+1,s.__processCounter>100)throw new Error('Infinite json loop detected at "'+s.block+(s.elem?this._optDelimElem+s.elem:"")+'".');if(f.__processCounter>1e3)throw new Error('Infinite matcher loop detected at "'+s.block+(s.elem?this._optDelimElem+s.elem:"")+'".')}p=void 0,s._stop||(v.node=n,v.ctx=s,p=f(v,s),void 0!==p&&(s=p,n.json=s,n.block=r,n.mods=a,g.push(n),M=!0))}if(!M&&_&&(y=s.content))if(Array.isArray(y)){var j;do{for(j=!1,c=0,d=y.length;d>c;c++)if(Array.isArray(y[c])){j=!0;break}j&&(s.content=y=y.concat.apply([],y))}while(j);for(c=0,l=0,d=y.length,u=d-1;d>c;c++)h=y[c],h!==!1&&null!=h&&"object"==typeof h&&g.push({json:h,arr:y,index:c,position:++l,block:r,mods:a,parentNode:n});y._listLength=l}else g.push({json:y,arr:s,index:"content",block:r,mods:a,parentNode:n})}n.arr[n.index]=s}return m[0]}},toHtml:function(t){this._buf="",this._html(t);var e=this._buf;return delete this._buf,e},_html:function(t){var e,i,a;if(t!==!1&&null!=t)if("object"!=typeof t)this._buf+=this._optEscapeContent?o(t):t;else if(Array.isArray(t))for(e=0,i=t.length;i>e;e++)a=t[e],a!==!1&&null!=a&&this._html(a);else{if(t.toHtml){var c=t.toHtml.call(this,t)||"";return void(this._buf+=c)}var l=t.bem!==!1;if("undefined"!=typeof t.tag&&!t.tag)return void(t.html?this._buf+=t.html:this._html(t.content));t.mix&&!Array.isArray(t.mix)&&(t.mix=[t.mix]);var d,u,h,p="",m="",g=!1;if(d=t.attrs)for(e in d)u=d[e],u===!0?m+=" "+e:u!==!1&&null!==u&&void 0!==u&&(m+=" "+e+'="'+n(u)+'"');if(l){var f=t.block+(t.elem?this._optDelimElem+t.elem:"");t.block&&(p=r(t,f,null,this._optNobaseMods,this._optDelimMod),t.js&&((h={})[f]=t.js===!0?{}:t.js));var _=this._optJsCls&&(this._optJsElem||!t.elem),b=t.mix;if(b&&b.length)for(e=0,i=b.length;i>e;e++){var v=b[e];if(v&&v.bem!==!1){var y=v.block||t.block||"",M=v.elem||(v.block?null:t.block&&t.elem),j=y+(M?this._optDelimElem+M:"");y&&(p+=r(v,j,f,this._optNobaseMods,this._optDelimMod),v.js&&((h=h||{})[j]=v.js===!0?{}:v.js,g=!0,_||(_=y&&this._optJsCls&&(this._optJsElem||!M))))}}if(h){_&&(p+=" "+this._optJsCls);var I=g||t.js!==!0?s(JSON.stringify(h)):'{"'+f+'":{}}';m+=" "+(t.jsAttr||this._optJsAttrName)+"='"+(this._optJsAttrIsJs?"return "+I:I)+"'"}}t.cls&&(p=(p?p+" ":"")+n(t.cls).trim());var C=t.tag||"div";this._buf+="<"+C+(p?' class="'+p+'"':"")+(m?m:""),this._shortTags[C]?this._buf+=this._optShortTagCloser:(this._buf+=">",t.html?this._buf+=t.html:this._html(t.content),this._buf+="</"+C+">")}}};var i="area base br col command embed hr img input keygen link menuitem meta param source track wbr".split(" "),o=t.prototype.xmlEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},n=t.prototype.attrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;")},s=t.prototype.jsAttrEscape=function(t){return(t+"").replace(/&/g,"&amp;").replace(/'/g,"&#39;")},r=function(t,e,i,o,n){var s,r,a,c="";if(i!==e&&(i&&(c+=" "),c+=e),s=t.elem&&t.elemMods||t.mods)for(a in s)r=s[a],(r||0===r)&&(c+=" "+(o?n:e+n)+a+(r===!0?"":n+r));return c};return t}();"undefined"!=typeof module&&(module.exports=e);var i=new e;i.setOptions({jsAttrName:"data-bem",jsAttrScheme:"json"});var o=function(){!function(){i.match("page",function(t,e){return t.tag("body").tParam("nonceCsp",e.nonce).content([t.content(),e.scripts],!0),[{html:e.doctype||"<!DOCTYPE html>",tag:!1},{tag:"html",attrs:{lang:e.lang},cls:"ua_js_no",content:[{elem:"head",content:[{tag:"meta",attrs:{charset:"utf-8"}},e.uaCompatible===!1?"":{tag:"meta",attrs:{"http-equiv":"X-UA-Compatible",content:e.uaCompatible||"IE=edge"}},{tag:"title",content:e.title},{block:"ua",attrs:{nonce:e.nonce}},e.head,e.styles,e.favicon?{elem:"favicon",url:e.favicon}:""]},e]}]}),i.match("page__head",function(t){t.bem(!1).tag("head")}),i.match("page__meta",function(t){t.bem(!1).tag("meta")}),i.match("page__link",function(t){t.bem(!1).tag("link")}),i.match("page__favicon",function(t,e){t.bem(!1).tag("link").attr("rel","shortcut icon").attr("href",e.url)})}(),function(){i.match("page",function(t){t.js(!0)})}(),function(){i.match("ua",function(t){t.bem(!1).tag("script").content(["(function(e,c){",'e[c]=e[c].replace(/(ua_js_)no/g,"$1yes");','})(document.documentElement,"className");'],!0)})}(),function(){i.match("page__css",function(t,e){t.bem(!1),e.url?t.tag("link").attr("rel","stylesheet").attr("href",e.url):t.tag("style")})}(),function(){i.match("page__js",function(t,e){var i=t.tParam("nonceCsp");t.bem(!1).tag("script"),e.url?t.attr("src",e.url):i&&t.attr("nonce",i)})}(),function(){i.match("config",function(t){t.tag("script"),t.attr("id","config"),t.attr("type","text/json"),t.content(t.param("data"))})}(),function(){i.match("popup",function(t,e){t.js({mainOffset:e.mainOffset,secondaryOffset:e.secondaryOffset,viewportOffset:e.viewportOffset,directions:e.directions,zIndexGroupLevel:e.zIndexGroupLevel}).attrs({"aria-hidden":"true"})})}(),function(){i.match("button",function(t,e){t.tag(e.tag||"button");var i=t.mod("type"),o="button"===t.tag()&&(!i||"submit"===i);t.tParam("_button",e).js(!0).attrs({role:"button",tabindex:e.tabIndex,id:e.id,type:o?i||"button":void 0,name:e.name,value:e.val,title:e.title}).mix({elem:"control"}),t.mod("disabled")&&(o?t.attr("disabled","disabled"):t.attr("aria-disabled","true"));var n=t.content();"undefined"==typeof n&&(n=[e.icon],"text"in e&&n.push({elem:"text",content:e.text}),t.content(n))})}(),function(){i.match("button_focused",function(t,e){t.js(t.extend(e.js,{lazyInit:!1}),!0)})}(),function(){i.match("button__text",function(t){t.tag("span")})}(),function(){i.match("spin",function(t){t.tag("span")})}(),function(){i.match("map-selection-item",function(t){var e=t.json();t.js(!0).attr("tabindex",0).attr("data-index",e.id).attr("data-type",e.sourceType).content([{elem:"maininfo",content:[{elem:"title",content:[{elem:"tag",content:i.lib.i18n("map-selection","mymaps_source")},{elem:"title-text"}]},{elem:"description",content:""}]},{elem:"updated",content:""},{block:"dropdown",mix:{block:"map-selection-item",elem:"more-menu-dropdown"},mods:{switcher:"button",theme:"islands",size:"s"},switcher:"",popup:{block:"popup",directions:["bottom-right","top-right"],mainOffset:5,mods:{mode:"menu"},mix:{block:"map-selection-item",elem:"popup"},content:[{block:"menu",mods:{theme:"islands",size:"m"},mix:{block:"map-selection-item",elem:"more-menu"},content:[{elem:"group",content:[{elem:"item",content:i.lib.i18n("map-selection","share")},{elem:"item",content:i.lib.i18n("map-selection","dublicate")}]},{elem:"group",content:[{elem:"item",content:[{block:"icon",mix:{block:"map-selection-item",elem:"trash-icon"}},i.lib.i18n("map-selection","remove")]}]}]},{elem:"share-holder",mix:[{block:"map-selection-item",elem:"share-holder"}],content:[{block:"input",mods:{theme:"islands",size:"s",autoselect:!0,readonly:!0},val:"",mix:{block:"map-selection-item",elem:"share-input"}},{block:"menu",mods:{theme:"islands",size:"m"},content:[{elem:"item",elemMods:{mode:"copy"},content:[{elem:"copyCaption",content:i.lib.i18n("map-selection","copy_link"),mix:{block:"map-selection-item",elem:"copyCaption"}},{elem:"copiedCaption",content:i.lib.i18n("map-selection","copy_link_complete"),mix:{block:"map-selection-item",elem:"copiedCaption"}}]}]}]}]}}])})}(),function(){i.match("input",function(t,e){t.tag("span").js(!0).tParam("_input",e).content({elem:"box",content:{elem:"control"}},!0)})}(),function(){i.match("input",function(t,e){e.validate&&t.attr("data-validate",JSON.stringify(e.validate)),e.mods.range&&(t.attr("data-min",e.min),t.attr("data-max",e.max))})}(),function(){i.match("input__box",function(t){t.tag("span")})}(),function(){i.match("input__control",function(t){t.tag("input");var e=t.tParam("_input"),i={id:e.id,name:e.name,value:e.val,maxlength:e.maxLength,tabindex:e.tabIndex,placeholder:e.placeholder};e.autocomplete===!1&&(i.autocomplete="off"),e.mods&&e.mods.disabled&&(i.disabled="disabled"),t.attrs(i)})}(),function(){i.match("error-hint",function(t){t.js(!0)})}(),function(){i.match("link",function(t,e){t.tag("a").mix({elem:"control"});var o,n="object"==typeof e.url?i.apply(e.url):e.url,s={role:"link"};t.mod("disabled")?(t.js(n?{url:n}:!0),s["aria-disabled"]="true"):(n?(s.href=n,o=e.tabIndex):o=e.tabIndex||0,t.js(!0)),"undefined"==typeof o||(s.tabindex=o),e.title&&(s.title=e.title),e.target&&(s.target=e.target),t.attrs(s)})}(),function(){i.match("link",function(t,e){if(e.download){var o=i.lib.data.uatraits.BrowserName.toLowerCase().indexOf("safari")>-1;o||t.attr("target","_blank");var n=e.download;if(n===!0){var s=(e.url||"").match(/\/[^\/]+/g);n=s?s[s.length-1].substr(1):""}t.attr("download",n)}})}(),function(){i.match("link_pseudo",function(t,e){e.url||t.tag("span").attr("role","button")})}(),function(){i.match("menu",function(t,e){var i=t.mods(),o={role:"menu"};t.tParam("menuMods",i).mix({elem:"control"}),i.disabled?(o["aria-disabled"]="true",t.js({tabIndex:0})):(o.tabindex=0,t.js(!0)),t.attrs(o);var n,s=[];if(e.content){var r="undefined"!=typeof e.val,a="check"===t.mod("mode"),c=function(t){return r&&(a?e.val.indexOf(t)>-1:e.val===t)},l=function(t){for(var e,i=0;e=t[i++];)"item"===e.elem?(n||(n=e),c(e.val)&&((e.elemMods=e.elemMods||{}).checked=!0,s.push(e))):e.content&&l(e.content)};if(!Array.isArray(e.content))throw Error("menu: content must be an array of the menu items");l(e.content)}t.tParam("firstItem",n).tParam("checkedItems",s)})}(),function(){i.match("menu",function(t,e){var i=t.mods(),o={role:"menu"};t.tParam("menuMods",i).mix({elem:"control"}),i.disabled?(o["aria-disabled"]="true",t.js({tabIndex:0})):(o.tabindex=0,t.js(!0)),t.attrs(o);var n,s=[];if(e.content){var r="undefined"!=typeof e.val,a="check"===t.mod("mode"),c=function(t){return r&&(a?e.val.indexOf(t)>-1:e.val===t)},l=function(t){for(var e=0,i=t[e++];i;)i.elemMods=i.elemMods||{},i.elemMods.index=e-1,"item"===i.elem?(n||(n=i),c(i.val)&&(i.checked=!0,s.push(i))):i.content&&l(i.content),i=t[e++]};if(!Array.isArray(e.content))throw Error("menu: content must be an array of the menu items");l(e.content)}t.tParam("firstItem",n).tParam("checkedItems",s)})}(),function(){i.match("menu_focused",function(t){var e=t.extend(t.js()||{},{lazyInit:!1});t.js(e)})}(),function(){i.match("menu__item",function(t,e){var i=t.tParam("menuMods"),o=i&&i.mode,n=o?"check"===o?"menuitemcheckbox":"menuitemradio":"menuitem";i&&t.mods({theme:i.theme,disabled:i.disabled}),t.js({val:e.val}).attrs({role:n,id:e.id||t.generateId(),"aria-disabled":t.mod("disabled")&&"true","aria-checked":o&&String(!!t.mod("checked"))})})}(),function(){i.match("menu__group",function(t,e){var i=e.title;if(t.attr("role","group"),"undefined"!=typeof i){var o=t.generateId();t.attr("aria-labelledby",o).content([{elem:"group-title",attrs:{role:"presentation",id:o},content:i},t.content()],!0)}})}(),function(){i.match("header",function(t){t.js(!0),t.content([{elem:"left",content:[{elem:"logo"}]},{elem:"right",content:[{elem:"login",content:{block:"button",mods:{theme:"islands",size:"l",id:"loginBtn"},text:i.lib.i18n("login-form","login")}},{elem:"user",content:[{block:"button",mods:{theme:"islands",size:"l",id:"mapListBtn"},text:i.lib.i18n("map-notice","return-to-map-list")},{block:"user-button",mix:{block:"header",elem:"user-button"}}]}]}])})}(),function(){i.match("user-button",function(t){t.js(!0);var e,o=i.lib.data;o.user&&(e=[{block:"user-data",mix:{block:"user-button",elem:"avatar"},user:o.user},{block:"user-menu",users:o.user.users||[]}]),t.content({block:"button",tag:"span",tabIndex:0,content:e})})}(),function(){i.match("user-menu",function(t,e){t.js(!0);var o=i.lib.data,n=e.users.slice(0,5);t.content({block:"popup",mods:{theme:"islands",target:"anchor",autoclosable:!0},mix:{block:"user-menu"},directions:["bottom-right"],mainOffset:15,secondaryOffset:4,content:{block:"menu",mods:{theme:"islands",size:"m"},content:[{elem:"group",content:[{content:i.lib.i18n("login-form","user_disk"),url:o.hosts.diskFront},{content:i.lib.i18n("login-form","user_settings"),url:o.hosts.tune},{content:i.lib.i18n("login-form","user_passport"),url:o.hosts.passport}].map(function(t){return{elem:"item",elemMods:{type:"link"},content:{block:"link",target:"_blank",mods:{theme:"islands"},url:t.url,content:t.content}}}).concat(n.map(function(t){return{elem:"item",elemMods:{type:"link"},mix:{block:"menu__item",elem:"theme_dark"},content:{block:"user-data",user:t,attrs:{"data-id":t.id}}}}),[{elem:"item",elemMods:{type:"link"},mix:{block:"menu__item",elem:"theme_dark"},content:{block:"link",mix:{block:"user-menu",elem:"add-user-link"},mods:{theme:"islands"},url:o.hosts.passportLogin,content:[{block:"user-menu",elem:"add-user-icon",tag:"span"},{block:"user-menu",elem:"add-user-text",tag:"span",content:i.lib.i18n("login-form","user_add_user")}]}},{elem:"item",elemMods:{type:"separator"}},{elem:"item",elemMods:{type:"link"},mix:{block:"menu__item",elem:"theme_dark"},content:{block:"link",mods:{theme:"islands"},mix:{block:"user-menu",elem:"exit-link"},url:o.hosts.passportLogout,content:i.lib.i18n("login-form","user_exit")}}])}]}})})}(),function(){i.match("user-data",function(t,e){t.js(!0);var o,n=i.lib.data;n.user.avatar&&(o=[n.hosts.portalStatic,e.user.avatar.default,"/islands-middle"].join(""));var s=e.user.displayName;s&&s.length>16&&(s=s.substr(0,16)+"..."),t.content({tag:"span",content:[{block:"user-data",elem:"userpic",userpic:o},{block:"user-data",elem:"username",content:i.xmlEscape(s)}]})}),i.match("user-data__userpic",function(t,e){t.tag("span"),e.userpic&&t.attr("data-url",e.userpic)}),i.match("user-data__username",function(t){t.tag("span")})}(),function(){i.match("promo",function(t){t.js(!0),t.content([{block:"carousel-helper"},{elem:"buttons-holder",content:[{block:"button",mods:{theme:"islands",size:"l",view:"action"},mix:{block:"promo",elem:"create-map-button"},text:i.lib.i18n("map-selection","create-map")},{block:"button",mods:{theme:"islands",size:"l"},mix:{block:"promo",elem:"open-map-button"},text:i.lib.i18n("map-selection","open_map")}]},{block:"popup-close-button",mods:{inmodal:!0}}])})}(),function(){i.match("carousel-helper",function(t){t.js(!0),t.content([{elem:"arrow",mods:{direction:"left"},content:" "},{elem:"container",content:[{elem:"slider",tag:"ul",content:[{elem:"slider-item",tag:"li",content:[{elem:"slider-item-icon",mods:{step:"1"}},{elem:"slider-item-header",content:i.lib.i18n("popup","helper_step_1_header")},{elem:"slider-item-description",content:i.lib.i18n("popup","helper_step_1_desc")}]},{elem:"slider-item",tag:"li",content:[{elem:"slider-item-icon",mods:{step:"2"}},{elem:"slider-item-header",content:i.lib.i18n("popup","helper_step_2_header")},{elem:"slider-item-description",content:i.lib.i18n("popup","helper_step_2_desc")}]},{elem:"slider-item",tag:"li",content:[{elem:"slider-item-icon",mods:{step:"3"}},{elem:"slider-item-header",content:i.lib.i18n("popup","helper_step_3_header")},{elem:"slider-item-description",content:i.lib.i18n("popup","helper_step_3_desc")}]}]},{elem:"pager",content:[{elem:"pager-item",tag:"a",attrs:{"data-slide-index":"0",href:"#"}},{elem:"pager-item",tag:"a",attrs:{"data-slide-index":"1",href:"#"}},{elem:"pager-item",tag:"a",attrs:{"data-slide-index":"2",href:"#"}}]}]},{elem:"arrow",mods:{direction:"right"},content:" "}])})}(),function(){i.match("export-modal",function(t){t.js(!0),t.content([{elem:"switcher-wrapper",content:[{block:"radio-group",mods:{theme:"export-type",type:"button",id:"filetype-switcher"},mix:[{block:"export-modal",elem:"filetype-switcher"}],val:"xlsx",options:[{val:"kml",text:"KML"},{val:"xlsx",text:"XLSX"},{val:"gpx",text:"GPX"},{val:"geojson",text:"GEO JSON"},{val:"csv",text:"CSV"}]}]},{elem:"heading",content:i.lib.i18n("popup","data_export_header")},{block:"link",url:i.lib.data.hosts.exportHelp,title:i.lib.i18n("popup","data_export_help_hint"),target:"_blank",mix:[{block:"export-modal",elem:"help-link"}]},{block:"popup-close-button",mods:{inmodal:!0}},{elem:"export-description",content:[{elem:"export-description-text",content:[{elem:"file-icon",content:[{elem:"file-icon-name",content:"KML",mix:[{block:"export-modal",elem:"kml-group"}]},{elem:"file-icon-name",content:"CSV",mix:[{block:"export-modal",elem:"csv-group"}]},{elem:"file-icon-name",content:"GPX",mix:[{block:"export-modal",elem:"gpx-group"}]},{elem:"file-icon-name",content:"GEO JSON",mix:[{block:"export-modal",elem:"geojson-group"},{block:"export-modal",elem:"file-icon-name-geojson"}]},{elem:"file-icon-name",content:"XLSX",mix:[{block:"export-modal",elem:"xlsx-group"}]}]},{elem:"export-description-text-item",content:i.lib.i18n("popup","data_export_kml_desc"),mix:[{block:"export-modal",elem:"kml-group"}]},{elem:"export-description-text-item",content:i.lib.i18n("popup","data_export_csv_desc"),mix:[{block:"export-modal",elem:"csv-group"}]},{elem:"export-description-text-item",content:i.lib.i18n("popup","data_export_gpx_desc"),mix:[{block:"export-modal",elem:"gpx-group"}]},{elem:"export-description-text-item",content:i.lib.i18n("popup","data_export_geojson_desc"),mix:[{block:"export-modal",elem:"geojson-group"}]},{elem:"export-description-text-item",content:i.lib.i18n("popup","data_export_xlsx_desc"),mix:[{block:"export-modal",elem:"xlsx-group"}]}]},{elem:"settings",content:[{elem:"settings-label",content:i.lib.i18n("popup","data_export_csv_separator")},{block:"radio-group",mods:{theme:"islands",size:"m",type:"button"},name:"separator",val:";",mix:[{block:"export-modal-settings-radio"}],options:[{val:";",text:i.lib.i18n("popup","data_export_csv_separator_semicolon")},{val:",",text:i.lib.i18n("popup","data_export_csv_separator_comma")},{val:"	",text:i.lib.i18n("popup","data_export_csv_separator_tab")}]}],mix:[{block:"export-modal",elem:"csv-group"}]},{elem:"can-be-exported-label",content:i.lib.i18n("popup","data_export_limits_header")},{elem:"can-be-exported-list",content:[{elem:"can-be-exported-item",content:[{block:"icon"},[i.lib.i18n("sidebar","point"),i.lib.i18n("popup","data_export_kml_point_limits")].join(" ")],mix:[{block:"export-modal",elem:"kml-group"},{block:"can-be-exported-list",elem:"point"}]},{elem:"can-be-exported-item",content:[{block:"icon"},i.lib.i18n("sidebar","line")],mix:[{block:"export-modal",elem:"kml-group"},{block:"can-be-exported-list",elem:"lines"}]},{elem:"can-be-exported-item",content:[{block:"icon"},i.lib.i18n("sidebar","polygon")],mix:[{block:"export-modal",elem:"kml-group"},{block:"can-be-exported-list",elem:"poly"}]},{elem:"can-be-exported-item",content:[{block:"icon"},[i.lib.i18n("sidebar","point"),i.lib.i18n("popup","data_export_csv_point_limits")].join(" ")],mix:[{block:"export-modal",elem:"csv-group"},{block:"can-be-exported-list",elem:"point"}]},{elem:"can-be-exported-item",content:[{block:"icon"},[i.lib.i18n("sidebar","point"),i.lib.i18n("popup","data_export_gpx_point_limits")].join(" ")],mix:[{block:"export-modal",elem:"gpx-group"},{block:"can-be-exported-list",elem:"point"}]},{elem:"can-be-exported-item",content:[{block:"icon"},[i.lib.i18n("sidebar","line"),i.lib.i18n("popup","data_export_gpx_line_limits")].join(" ")],mix:[{block:"export-modal",elem:"gpx-group"},{block:"can-be-exported-list",elem:"lines"}]},{elem:"can-be-exported-item",content:[{block:"icon"},i.lib.i18n("sidebar","point")],mix:[{block:"export-modal",elem:"geojson-group"},{block:"can-be-exported-list",elem:"point"}]},{elem:"can-be-exported-item",content:[{block:"icon"},i.lib.i18n("sidebar","line")],mix:[{block:"export-modal",elem:"geojson-group"},{block:"can-be-exported-list",elem:"lines"}]},{elem:"can-be-exported-item",content:[{block:"icon"},i.lib.i18n("sidebar","polygon")],mix:[{block:"export-modal",elem:"geojson-group"},{block:"can-be-exported-list",elem:"poly"}]},{elem:"can-be-exported-item",content:[{block:"icon"},[i.lib.i18n("sidebar","point"),i.lib.i18n("popup","data_export_xlsx_point_limits")].join(" ")],mix:[{block:"export-modal",elem:"xlsx-group"},{block:"can-be-exported-list",elem:"point"}]}]}]},{elem:"button-wrapper",content:[{block:"button",mods:{theme:"islands",size:"l"},mix:[{block:"export-modal",elem:"download-button"}],text:i.lib.i18n("sidebar","download")},{block:"button",mods:{theme:"islands",size:"l",view:"action"},mix:[{block:"export-modal",elem:"save-button"}],text:i.lib.i18n("sidebar","save-to-yadisk")},{block:"button",mods:{theme:"islands",size:"l",view:"action",expanded:!0},mix:[{block:"export-modal",elem:"download-file-button"}],text:i.lib.i18n("sidebar","download-file")}]}])})}(),function(){i.match("icon",function(t,e){var i={},o=e.url;o&&(i.style="background-image:url("+o+")"),t.tag("span").attrs(i)})}(),function(){i.match("radio-group",function(t,e){t.tag("span").attrs({role:"radiogroup"}).js(!0).mix({block:"control-group"});var i=t.mods(),o="undefined"!=typeof e.val;t.content((e.options||[]).map(function(t,n){return[!!n&&!i.type&&{tag:"br"},{block:"radio",mods:{type:i.type,mode:i.mode,theme:i.theme,size:i.size,checked:o&&e.val===t.val,disabled:t.disabled||i.disabled},name:e.name,val:t.val,text:t.text,title:t.title,icon:t.icon}]}))})}(),function(){i.match("radio-group",function(t,e){t.tag("span").attrs({role:"radiogroup"}).js(!0).mix({block:"control-group"});var i=t.mods(),o="undefined"!=typeof e.val;t.content((e.options||[]).map(function(t,n){return[Boolean(n)&&!Boolean(i.type)&&{tag:"br"},{block:"radio",mods:{type:i.type,mode:i.mode,theme:i.theme,size:i.size,checked:o&&e.val===t.val,disabled:t.disabled||i.disabled,index:n},name:e.name,notice:t.notice,val:t.val,text:t.text,title:t.title,icon:t.icon}]}))})}(),function(){i.match("radio",function(t,e){t.tag("label").js(!0).content([{elem:"box",content:{elem:"control",checked:t.mod("checked"),disabled:t.mod("disabled"),name:e.name,val:e.val}},e.text&&{elem:"text",content:e.text}])
})}(),function(){i.match("radio__box",function(t){t.tag("span")})}(),function(){i.match("radio__control",function(t,e){t.tag("input");var i={type:"radio",autocomplete:"off",name:e.name,value:e.val};e.checked&&(i.checked="checked"),e.disabled&&(i.disabled="disabled"),t.attrs(i)})}(),function(){i.match("radio__text",function(t){t.tag("span").attrs({role:"presentation"})})}(),function(){function t(t){return t?i.lib.i18n("popup","data_import_warning_vlimit",{$thousands:["num"],num:i.lib.data.limits.count.vertexes}):i.lib.i18n("popup","data_import_warning_limit",{$thousands:["num"],num:i.lib.data.limits.count.geoObjects})}i.match("import-modal",function(e){e.js(!0),e.content([{elem:"load",content:[{elem:"heading",content:i.lib.i18n("popup","data_import_header")},{block:"popup-close-button",mods:{inmodal:!0}},{elem:"drop-zone",content:[{elem:"formats",content:i.lib.i18n("popup","data_import_formats")},{block:"attach",mix:{block:"import-modal",elem:"upload-button"},mods:{theme:"islands",size:"m",focused:!0},button:{block:"button",text:i.lib.i18n("popup","data_import_button"),mods:{view:"action"},title:i.lib.i18n("popup","data_import_button")},accept:".csv, .xls, .xlsx, .geojson, .json, .kml, .gpx"},{elem:"desc",content:i.lib.i18n("popup","data_import_desc")}]},{block:"templates",mix:{block:"import-modal",elem:"templates"},content:{elem:"content",content:[{elem:"label",content:i.lib.i18n("popup","data_import_template")},{block:"link",url:i.lib.data.hosts.importTemplate.replace("{type_l}","xlsx").replace("{type_u}","XLSX"),mods:{view:"minor"},download:!0,content:"XLSX",attrs:{"data-filetype":"XLSX"}},{block:"link",url:i.lib.data.hosts.importTemplate.replace("{type_l}","csv").replace("{type_u}","CSV"),mods:{view:"minor"},download:!0,content:"CSV",attrs:{"data-filetype":"CSV"}}]}}]},{elem:"status",content:[{elem:"left",content:[{elem:"result",content:""},{elem:"result-comment",content:i.lib.i18n("popup","data_import_canbeadded")},{block:"button",mods:{theme:"islands",size:"xl",focused:!0,view:"action"},text:i.lib.i18n("popup","data_import_approve"),mix:{block:"import-modal",elem:"approve-button"}},{elem:"abort-button",content:i.lib.i18n("popup","data_import_abort")}]},{elem:"right",content:[{elem:"warnings",content:[{elem:"warning-header",content:i.lib.i18n("popup","data_import_warning")},{elem:"warning-errors",content:i.lib.i18n("popup","data_import_warning_template")},{elem:"warning-missed-data",content:i.lib.i18n("popup","data_import_warning_obs")},{elem:"warning-point-limit",content:t(!1)},{elem:"warning-vert-limit",content:t(!0)},{elem:"warning-link",content:i.lib.i18n("popup","data_import_warning_link")}]}]}]},{elem:"dragging",content:[{elem:"overlabel",content:i.lib.i18n("popup","data_import_dragheader")},{elem:"underlabel",content:i.lib.i18n("popup","data_import_formats")}]}])})}(),function(){i.match("button",function(t){t.tParam("_attach")&&t.tag("span",!0).applyBase().content([{block:"attach",elem:"control"},t.content()],!0)})}(),function(){i.match("attach__control",function(t){var e={type:"file"},i=t.tParam("_attach");i&&(e.name=i.name,i.mods&&i.mods.disabled&&(e.disabled="disabled"),i.tabIndex&&(e.tabindex=i.tabIndex)),t.tag("input").attrs(e)})}(),function(){i.match("attach__control",function(t){var e=t.tParam("_attach");e.accept&&t.attr("accept",e.accept)})}(),function(){i.match("attach__no-file",function(t){t.tag("span")})}(),function(){i.match("attach__file",function(t){t.tag("span")})}(),function(){i.match("attach__text",function(t){t.tag("span")})}(),function(){i.match("attach__clear",function(t){t.tag("span")})}(),function(){i.match("notify",function(t){t.js(!0),t.content([{block:"popup-close-button",mods:{inmodal:!0}},{elem:"image"},{elem:"header",content:""},{elem:"description",content:""},{block:"button",mix:[{block:"notify",elem:"button"}],content:""}])})}(),function(){i.match("sidebar__map-content-panel",function(t){t.js(!0),t.content([{elem:"map-content-panel-inner",content:[{elem:"map-content-panel-inner-middle",content:[{elem:"map-content-panel-heading",content:i.lib.i18n("sidebar","title_new")},{elem:"map-content-panel-label",tag:"label",content:[{block:"input",mods:{theme:"islands",size:"m",width:"available",id:"name","fire-blur-change":!0},validate:{message:i.lib.i18n("popup","limit_warning_name"),conditionals:"length:"+i.lib.data.limits.size.mapName,mods:{width:"auto"}},placeholder:i.lib.i18n("sidebar","map_name")}]},{elem:"description-holder",content:{block:"textarea",attrs:{rows:2},mods:{theme:"islands",size:"m",width:"available",id:"desc","fire-blur-change":!0},validate:{message:i.lib.i18n("popup","limit_warning_desc"),conditionals:"length:"+i.lib.data.limits.size.mapDescription,mods:{width:"auto"}},placeholder:i.lib.i18n("sidebar","map_description")}},{elem:"map-content-panel-heading",content:[{elem:"map-content-panel-heading-label",content:i.lib.i18n("sidebar","places")},{block:"link",mix:{block:"sidebar",elem:"map-content-panel-heading-limit"},mods:{id:"limit-link"},content:"",target:"_blank",url:i.lib.data.hosts.createHelp}]},{elem:"geoObject-list-holder",mods:{hidden:!0},content:[{block:"geoObject-list"}]},{elem:"no-geoobjects",content:[{block:"button",mods:{theme:"islands",size:"m",id:"importBtn"},mix:{block:"sidebar",elem:"map-content-panel-import-button"},text:i.lib.i18n("popup","data_import_header")},{tag:"span",content:i.lib.i18n("sidebar","no-items")}]}]},{elem:"map-content-panel-inner-bottom",content:[{elem:"map-content-panel-separator"},{block:"button",mods:{theme:"islands",size:"l",expanded:!0,id:"saveBtn"},text:i.lib.i18n("sidebar","next")},{elem:"notice",mods:{center:!0},content:i.lib.i18n("sidebar","terms_of_use"),mix:{block:"sidebar",elem:"map-content-panel-terms"}}]}]}])})}(),function(){i.match("geoObject-list",function(t){t.js(!0),t.content([{elem:"point-holder",mix:{block:"geoObject-list",elem:"holder"}},{elem:"separator",elemMods:{type:"linestring",hidden:!0}},{elem:"linestring-holder",mix:{block:"geoObject-list",elem:"holder"}},{elem:"separator",elemMods:{type:"polygon",hidden:!0}},{elem:"polygon-holder",mix:{block:"geoObject-list",elem:"holder"}}])})}(),function(){i.match("geoObject-list-item",function(t,e){t.js(!0),t.content([{elem:"icon",content:e.iconContent},{elem:"title",content:e.caption},{elem:"measure"}])})}(),function(){i.match("textarea",function(t,e){var i={id:e.id,name:e.name,tabindex:e.tabIndex,placeholder:e.placeholder};e.autocomplete===!1&&(i.autocomplete="off"),t.mod("disabled")&&(i.disabled="disabled"),t.js(!0).tag("textarea").mix({elem:"control"}).attrs(i).content(e.val,!0)})}(),function(){i.match("textarea",function(t,e){e.validate&&t.attr("data-validate",JSON.stringify(e.validate))})}(),function(){i.match(["button_togglable_check","button_togglable_radio"],function(t){t.attr("aria-pressed",String(!!t.mod("checked")))})}(),function(){i.match("sidebar__export-settings-panel",function(t){var e="export-settings-panel-";t.js(!0),t.content([{elem:e+"top",content:[{block:"link",mods:{theme:"islands",size:"m",id:"back-button",type:"minor"},content:i.lib.i18n("sidebar","return-back"),mix:[{block:"sidebar",elem:e+"return-button"},{block:"sidebar",elem:"back-button"}]}]},{elem:e+"content",content:[{block:"link",mods:{theme:"islands",size:"m",id:"export-link",type:"minor"},content:i.lib.i18n("sidebar","data_export_button"),mix:[{block:"sidebar",elem:e+"export-data"}]},{elem:e+"heading",content:i.lib.i18n("sidebar","map_created")},{block:"radio-group",mods:{theme:"map-usage",type:"button",id:"main-switcher"},mix:[{block:"sidebar",elem:e+"export-type-switch-primary"}],val:"site",options:[{val:"site",text:i.lib.i18n("sidebar","interactive-map")},{val:"print",text:i.lib.i18n("sidebar","map-usage-print")}]},{block:"radio-group",mods:{theme:"islands",type:"line",size:"m",id:"static-switcher"},val:"interactiveScript",options:[{val:"interactiveScript",text:i.lib.i18n("sidebar","online-map")},{val:"static",text:i.lib.i18n("sidebar","static-map")}],mix:[{block:"sidebar",elem:e+"unprint-group"},{block:"sidebar",elem:e+"site-type-map"}]},{elem:e+"map-type-notice",content:[{elem:e+"map-type-notice-item",content:i.lib.i18n("sidebar","interactive-map-notice"),mix:[{block:"sidebar",elem:e+"interactive-group"},{block:"sidebar",elem:e+"map-usage-notice"}]},{elem:e+"map-type-notice-item",content:i.lib.i18n("sidebar","static-map-notice"),mix:[{block:"sidebar",elem:e+"static-group"},{block:"sidebar",elem:e+"map-usage-notice"}]},{elem:e+"map-type-notice-item",content:i.lib.i18n("sidebar","printed-map-notice"),mix:[{block:"sidebar",elem:e+"print-group"},{block:"sidebar",elem:e+"map-usage-notice"}]},{elem:e+"print-error-zoom",content:i.lib.i18n("sidebar","print-error-zoom"),mods:{hidden:!0}},{elem:e+"print-error-map",content:i.lib.i18n("sidebar","print-error-map"),mods:{hidden:!0}},{elem:e+"print-error-browser",content:i.lib.i18n("sidebar","print-error-browser"),mods:{hidden:!0}},{elem:e+"print-error-notice",content:i.lib.i18n("sidebar","print-error-notice"),mods:{hidden:!0},mix:[{block:"sidebar",elem:e+"print-error-notice"}]}]},{elem:e+"web-group",mix:{block:"sidebar",elem:e+"web-group"},content:[{elem:e+"table",content:[{elem:e+"table-row",content:[{elem:e+"table-cell",content:{elem:e+"caption",content:i.lib.i18n("sidebar","map-size")}},{elem:e+"table-cell",content:[{block:"input",mods:{theme:"islands",size:"m",delay:1e3,type:"number",id:"map-width"},mix:[{block:"sidebar",elem:e+"map-size-width"},{block:"sidebar",elem:e+"print-control"}]},{elem:e+"map-size-x",content:"×"},{block:"input",mods:{theme:"islands",size:"m",delay:1e3,type:"number",id:"map-height"},mix:[{block:"sidebar",elem:e+"map-size-height"},{block:"sidebar",elem:e+"print-control"}]},{elem:e+"map-size-units",content:i.lib.i18n("sidebar","pixels"),mix:[{block:"sidebar",elem:e+"unprint-group"}]},{block:"select",mods:{theme:"islands",mode:"radio",size:"m",id:"image-size-type"},options:[{val:"px",text:"px"},{val:"in",text:"in"},{val:"cm",text:"cm"}],mix:[{block:"sidebar",elem:e+"image-size-type"},{block:"sidebar",elem:e+"image-export-selector"},{block:"sidebar",elem:e+"print-group"},{block:"sidebar",elem:e+"map-size-selector"},{block:"sidebar",elem:e+"print-control"}]}]}]},{elem:e+"table-row",content:[{elem:e+"table-cell",content:""},{elem:e+"table-cell",content:{elem:e+"fit-width-holder",content:[{block:"checkbox",mods:{theme:"islands",size:"m",checked:!1,id:"fit-width"},text:i.lib.i18n("sidebar","stretch_by_width"),mix:{block:"sidebar",elem:e+"fit-width"}}]}}],mix:{block:"sidebar",elem:e+"interactive-group"}},{elem:e+"table-row",content:[{elem:e+"table-cell",content:{elem:e+"caption",content:i.lib.i18n("sidebar","file-extension")}},{elem:e+"table-cell",content:{block:"select",mods:{theme:"islands",mode:"radio",size:"m",id:"image-extension"},options:[{val:"png",text:"PNG"},{val:"jpeg",text:"JPG"}],mix:[{block:"sidebar",elem:e+"image-export-selector"},{block:"sidebar",elem:e+"image-extension"},{block:"sidebar",elem:e+"print-control"}]}}],mix:[{block:"sidebar",elem:e+"print-group"}]},{elem:e+"table-row",content:[{elem:e+"table-cell",content:{elem:e+"caption",content:i.lib.i18n("sidebar","image-dpi")}},{elem:e+"table-cell",content:[{block:"select",mods:{theme:"islands",mode:"radio",size:"m",id:"dpi-selector"},options:[{val:1,text:"96"},{val:3.125,text:"300"}],mix:[{block:"sidebar",elem:e+"image-export-selector"},{block:"sidebar",elem:e+"image-export-dpi"},{block:"sidebar",elem:e+"print-control"}]},{elem:e+"map-size-units",content:"DPI"}]}],mix:[{block:"sidebar",elem:e+"print-group"}]}]},{elem:e+"get-code-button-holder",content:{block:"button",mods:{theme:"islands",size:"l",expanded:!0,view:"action",id:"get-code-btn"},text:i.lib.i18n("sidebar","get_code"),mix:[{block:"sidebar",elem:e+"get-code"},{block:"sidebar",elem:e+"unprint-group"}]}},{elem:e+"table",content:[{elem:e+"table-row",content:[{elem:e+"table-cell",content:{elem:e+"caption",content:i.lib.i18n("sidebar","yandex-map-link")}},{elem:e+"table-cell",content:{elem:e+"ymaps-input-holder",content:[{content:{block:"input",mods:{theme:"islands",size:"m",width:"available",readonly:!0,autoselect:!0,id:"map-link"},val:"",mix:{block:"sidebar",elem:e+"map-link"}}},{content:{block:"button",mods:{theme:"islands",size:"m",id:"open-in-ymaps"},text:"&#160;",title:i.lib.i18n("sidebar","open_in_ymap"),mix:[{block:"sidebar",elem:e+"open-in-ymaps"},{block:"sidebar",elem:e+"print-control"}]}}]}}]}],mix:{block:"sidebar",elem:e+"interactive-group"}},{elem:e+"image-buttons",content:[{block:"button",mods:{theme:"islands",size:"l",id:"download-button"},text:i.lib.i18n("sidebar","download"),mix:[{block:"sidebar",elem:e+"download-button"},{block:"sidebar",elem:e+"print-group"}]},{block:"button",mods:{theme:"islands",size:"l",view:"action",id:"export-image-button"},text:i.lib.i18n("sidebar","save-to-yadisk"),mix:[{block:"sidebar",elem:e+"print-button"},{block:"sidebar",elem:e+"print-group"},{block:"sidebar",elem:e+"yadisk-button"}]}]},{block:"button",mods:{theme:"islands",size:"l",view:"action",expanded:!0,id:"download-file-button"},text:i.lib.i18n("sidebar","download-file"),mix:[{block:"sidebar",elem:e+"download-file-button"},{block:"sidebar",elem:e+"print-group"}]},{elem:"notice",mods:{center:!0},content:i.lib.i18n("sidebar","or-use-standart-print"),mix:[{block:"sidebar",elem:e+"standard-print-block"},{block:"sidebar",elem:e+"map-usage-notice"},{block:"sidebar",elem:e+"print-group"}]}]},{block:"popup",content:{block:"error-hint",content:""},directions:["right-center"],mods:{theme:"islands",autoclosable:!1,target:"anchor",id:"error-popup"},mix:[{block:"sidebar",elem:e+"error-hint"},{block:"z-index-group",mods:{level:6}}],mainOffset:10},{block:"popup",content:[{elem:e+"get-code-holder",mix:[{block:"sidebar",elem:e+"get-code-holder"},{block:"sidebar",elem:e+"message-hint"}],content:[{elem:e+"label-text-bold",mix:{block:"sidebar",elem:e+"label-text-bold"},content:i.lib.i18n("sidebar","html-code")},{block:"radio-group",mods:{theme:"islands",size:"m",type:"button",id:"interactive-map-switcher"},mix:[{block:"sidebar",elem:"interactive-switcher"}],val:"interactiveScript",options:[{val:"interactiveScript",text:"JavaScript"},{val:"interactiveIframe",text:"iframe"}]},{block:"textarea",attrs:{rows:5},mods:{theme:"islands",size:"m",width:"available",id:"code-preview",readonly:!0},mix:{block:"sidebar",elem:e+"code-preview"}},{elem:"iframe-error-map",content:i.lib.i18n("sidebar","iframe-error-map"),mix:[{block:"sidebar",elem:"iframe-error-map"},{block:"sidebar",elem:e+"iframe-error-map",mods:{hidden:!0}}]},{elem:"iframe-error-zoom",content:i.lib.i18n("sidebar","iframe-error-zoom"),mix:[{block:"sidebar",elem:"iframe-error-zoom"},{block:"sidebar",elem:e+"iframe-error-zoom",mods:{hidden:!0}}]},{elem:"notice-script",content:i.lib.i18n("sidebar","about_constructor_api"),mix:[{block:"sidebar",elem:"notice-script"},{block:"sidebar",elem:e+"about-api-link"}]},{elem:"notice-iframe",content:i.lib.i18n("sidebar","about_iframe_confines"),mix:[{block:"sidebar",elem:"notice-iframe"},{block:"sidebar",elem:e+"iframe-confines-link",mods:{hidden:!0}}]},{block:"popup-close-button",mix:[{block:"sidebar",elem:"export-settings-panel-get-code-close-button"},{block:"sidebar",elem:"export-settings-panel-close-button"}]}]}],directions:["right-center"],mods:{theme:"islands",autoclosable:!1,target:"anchor",id:"code-popup"},mix:[{block:"sidebar",elem:e+"get-code-hint"},{block:"z-index-group",mods:{level:5}}],mainOffset:30}]}])})}(),function(){i.match("radio_type_button",function(t,e){var i=t.mods();t.content([{block:"button",mods:{togglable:"radio-check"===i.mode?"check":"radio",checked:i.checked,disabled:i.disabled,theme:i.theme,size:i.size},title:e.title,content:[e.icon,"undefined"!=typeof e.text?{elem:"text",content:e.text}:""]},{block:"radio",elem:"control",checked:i.checked,disabled:i.disabled,name:e.name,val:e.val}])})}(),function(){i.match("checkbox",function(t,e){t.tag("label").js(!0).content([{elem:"box",content:{elem:"control",checked:t.mod("checked"),disabled:t.mod("disabled"),name:e.name,val:e.val}},e.text&&{elem:"text",content:e.text}])})}(),function(){i.match("checkbox__box",function(t){t.tag("span")})}(),function(){i.match("checkbox__control",function(t,e){t.tag("input");var i={type:"checkbox",autocomplete:"off"};i.name=e.name,i.value=e.val,e.checked&&(i.checked="checked"),e.disabled&&(i.disabled="disabled"),t.attrs(i)})}(),function(){i.match("checkbox__text",function(t){t.tag("span").attrs({role:"presentation"})})}(),function(){i.match("select",function(t,e){function i(t){return s&&(r?e.val.indexOf(t)>-1:e.val===t)}function o(e){for(var s,r=0;s=e[r++];)s.group?o(s.group):(n||(n=s),c.push(s.id=t.generateId()),i(s.val)&&(s.checked=!0,a.push(s)))}if(!t.mod("mode"))throw Error("Can't build select without mode modifier");var n,s="undefined"!=typeof e.val,r="check"===t.mod("mode"),a=[],c=[];o(e.options),t.js({name:e.name,optionsMaxHeight:e.optionsMaxHeight}).tParam("select",e).tParam("firstOption",n).tParam("checkedOptions",a).tParam("optionIds",c).content([{elem:"button"},{block:"popup",mods:{target:"anchor",theme:t.mod("theme"),autoclosable:!0},directions:["bottom-left","bottom-right","top-left","top-right"],content:{block:e.block,mods:t.mods(),elem:"menu"}}])})}(),function(){i.match("select_focused",function(t){t.applyBase().extend(t.js(),{lazyInit:!1})})}(),function(){i.match("select__control",function(t,e){var i=e.blockMods||e.mods;t.tag("input").attrs({type:"hidden",name:t.tParam("select").name,value:e.val,disabled:i.disabled?"disabled":void 0,autocomplete:"off"})})}(),function(){i.match("select__button",function(t,e){var i=e.blockMods||e.mods,o=t.tParam("select"),n=t.tParam("checkedOptions"),s=t.generateId();return t.tParam("selectTextId",s),{block:"button",mix:{block:e.block,elem:e.elem},mods:{size:i.size,theme:i.theme,view:i.view,focused:i.focused,disabled:i.disabled,checked:"radio"!==i.mode&&!!n.length},id:o.id,attrs:{role:"listbox","aria-owns":t.tParam("optionIds").join(" "),"aria-multiselectable":"check"===i.mode?"true":null,"aria-labelledby":s},tabIndex:o.tabIndex,content:[t.content(),{block:"icon",mix:{block:"select",elem:"tick"}}]}}),i.match("button__text",function(t){t.tParam("select")&&t.attr("id",t.tParam("selectTextId"))})}(),function(){i.match("select__menu",function(t,e){var i=t.mods(),o=t.tParam("select"),n=function(t){var e={block:"menu",elem:"item",elemMods:{disabled:i.disabled||t.disabled},attrs:{role:"option"},id:t.id,val:t.val,js:{checkedText:t.checkedText},content:t.text};return t.icon&&(e.js.text=t.text,e.content=[t.icon,e.content]),e};return{block:"menu",mix:{block:e.block,elem:e.elem},mods:{size:i.size,theme:i.theme,disabled:i.disabled,mode:i.mode},val:o.val,attrs:{role:null,tabindex:null},content:o.options.map(function(t){return t.group?{elem:"group",title:t.title,content:t.group.map(n)}:n(t)})}})}(),function(){i.match("help-button",function(t){t.js(!0),t.attr("title",i.lib.i18n("sidebar","help")),t.content([{block:"dropdown",mods:{switcher:"link",theme:"islands",size:"m"},mix:{block:"help-button",elem:"dropdown"},switcher:"?",popup:{block:"popup",mix:{block:"help-button",elem:"popup"},directions:["right-bottom"],mods:{target:"anchor"},mainOffset:10,secondaryOffset:5,content:[{elem:"hint",mix:{block:"help-button",elem:"popup-hint"}},{block:"menu",mods:{theme:"islands",size:"m"},content:[{elem:"group",content:[{elem:"item",mix:{block:"help-button",elem:"help"},content:i.lib.i18n("sidebar","help_help")},{elem:"item",mix:{block:"help-button",elem:"hotkeys"},content:i.lib.i18n("sidebar","help_hotkeys")},{elem:"item",mix:{block:"help-button",elem:"support"},content:i.lib.i18n("sidebar","help_support")}]},{elem:"group",content:[{elem:"item",content:i.lib.i18n("sidebar","help_nk"),mix:{block:"help-button",elem:"nk"}}]}]}]}}])})}(),function(){i.match("map-editor",function(t){t.js(!0),t.mod("mapType","interactiveScript"),t.mod("mode","edit"),t.content([{elem:"map-holder"},{elem:"preview-holder"},{elem:"resizer-holder"}])})}(),function(){i.match("menu_theme_icons",function(t){t.applyBase(),t.content({elem:"content",content:t.content()},!0)})}(),function(){i.match("simplify-popup",function(t){t.js(!0),t.content([{block:"popup",mods:{theme:"islands"},mix:[{block:"z-index-group",mods:{level:5}}],content:[{block:"popup-close-button"},{elem:"header",content:"",mix:{block:"simplify-popup",elem:"header"}},{elem:"desc",content:i.lib.i18n("popup","import_vlimit_desc"),mix:{block:"simplify-popup",elem:"desc"}},{block:"button",text:i.lib.i18n("popup","simplify_poly"),mods:{theme:"islands",size:"s"},mix:{block:"simplify-popup",elem:"button"}}]}])})}(),function(){i.match("resizer",function(t){t.js(!0);var e=[{elem:"filler"},{elem:"blackout"},{elem:"blackout"},{elem:"blackout"},{elem:"blackout"}],i=["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"];i.forEach(function(t){e.push({elem:"slider",elemMods:{direction:t},attrs:{"data-position":t}})}),t.content(e)})}(),function(){i.match("modal",function(t,e){t.js(!0).mix({block:"popup",js:{zIndexGroupLevel:e.zIndexGroupLevel||20},mods:{autoclosable:t.mod("autoclosable")}}).attrs({role:"dialog","aria-hidden":"true"}).content({elem:"table",content:{elem:"cell",content:{elem:"content",content:t.content()}}},!0)})}(),function(){i.match("map-selection",function(t){t.js(!0),t.content([{elem:"select-section",content:[{elem:"header",content:[{elem:"heading",content:i.lib.i18n("map-selection","select_map"),tag:"h1"},{block:"button",mods:{theme:"islands",size:"m",view:"action",id:"create-button2"},mix:{block:"map-selection",elem:"create-button2"},text:i.lib.i18n("map-selection","create_new_map")},{block:"button",mods:{theme:"islands",size:"m",id:"import-button"},mix:{block:"map-selection",elem:"import-button"},text:i.lib.i18n("map-selection","import-button")}]},{elem:"map-list",content:[{elem:"map-list-constructor-holder",mix:{block:"constructor-holder"}},{elem:"map-list-no-items-message",content:i.lib.i18n("map-selection","no_maps"),mods:{hidden:!0}},{elem:"map-list-loader",content:{block:"spin",mods:{theme:"islands",size:"xl",visible:!0}},mods:{hidden:!0}}]}]},{block:"popup-close-button",mods:{inmodal:!0}}])})}(),function(){i.match("input_readonly__control",function(t){t.attr("readonly",!0)})}(),function(){i.match({dropdown:function(t){var e=t.json();return t.js(t.extend({id:t.generateId()},t.js())).tParam("dropdown",e).tParam("popupId",t.generateId()).tParam("theme",t.mod("theme")).tParam("mix",[e].concat(e.switcher.mix||[],e.mix||[])),[{elem:"popup"},{elem:"switcher"}]},dropdown__popup:function(t){var e=t.tParam("dropdown"),i=e.popup;(t.isSimple(i)||"popup"!==i.block)&&(i={block:"popup",content:i});var o=i.mods||(i.mods={}),n=i.attrs||(i.attrs={});return o.theme||(o.theme=t.tParam("theme")),o.hasOwnProperty("autoclosable")||(o.autoclosable=!0),o.target="anchor",n.id=t.tParam("popupId"),i.mix=[e].concat(i.mix||[]),i},dropdown__switcher:function(t){var e=t.tParam("dropdown"),i=e.switcher;return i.block&&(i.mix=t.tParam("mix")),i}})}(),function(){i.match("dropdown_switcher_link__switcher",function(t,e){var i=t.tParam("dropdown"),o=i.switcher;if(Array.isArray(o))return o;var n=t.isSimple(o)?{block:"link",mods:{pseudo:!0},content:o}:o;if("link"===n.block){var s=n.mods||(n.mods={}),r=n.attrs||(n.attrs={}),a=e.blockMods||e.mods;s.theme||(s.theme=a.theme),s.disabled=a.disabled,r["aria-haspopup"]="true",r["aria-controls"]=t.tParam("popupId"),r["aria-expanded"]="false",n.mix=t.tParam("mix")}return n})}(),function(){i.match("menu__item_type_link",function(t){t.applyBase(),t.mod("disabled")&&t.tParam("_menuItemDisabled",!0)}),i.match("link",function(t){t.tParam("_menuItemDisabled")&&t.mod("disabled",!0)})}(),function(){i.match("radio_type_line",function(t,e){Boolean(t.param("notice"))&&t.js(!0).content({elem:"table",content:[{elem:"table-cell",content:{elem:"box",content:{elem:"control",checked:t.mod("checked"),disabled:t.mod("disabled"),name:e.name,val:e.val}}},{elem:"table-cell",content:[e.text,{tag:"br"},{tag:"span",elem:"notice",content:t.param("notice")}]}]})})}(),function(){i.match("attach",function(t,e){t.tParam("_attach",e).tag("span").js(!0);var i=e.button;"object"==typeof i||(i={block:"button",tag:"span",text:i});var o=t.mods(),n=i.mods||(i.mods={});["size","theme","disabled","focused"].forEach(function(t){n[t]||(n[t]=o[t])}),t.content([i,{elem:"no-file",content:e.noFileText}],!0)})}(),function(){i.match("sidebar",function(t){t.js(!0),t.mod("mode","map-content"),t.content([{elem:"map-content-panel"},{elem:"export-settings-panel",elemMods:{hidden:!0}}])})}(),function(){i.match("textarea_readonly",function(t){t.attr("readonly",!0)})}(),function(){i.match("select_mode_radio",function(t){t.applyBase();var e=t.tParam("checkedOptions"),i=t.tParam("firstOption");i&&!e.length&&(i.checked=!0,e=[i]),t.tParam("checkedOption",e[0]).content([{elem:"control",val:e[0].val},t.content()],!0)}),i.match("select_mode_radio__button",function(t){t.content({elem:"text",content:t.tParam("checkedOption").text})})}(),function(){i.match("menu_mode_radio",function(t){t.applyBase();var e=t.tParam("firstItem");e&&!t.tParam("checkedItems").length&&((e.elemMods=e.elemMods||{}).checked=!0)})}(),function(){i.match("dropdown_switcher_button__switcher",function(t,e){var i=t.tParam("dropdown"),o=i.switcher;if(Array.isArray(o))return o;var n=t.isSimple(o)?{block:"button",text:o}:o;if("button"===n.block){var s=n.mods||(n.mods={}),r=n.attrs||(n.attrs={}),a=e.blockMods||e.mods;s.size||(s.size=a.size),s.theme||(s.theme=a.theme),s.disabled=a.disabled,r["aria-haspopup"]="true",r["aria-controls"]=t.tParam("popupId"),r["aria-expanded"]="false",n.mix=t.tParam("mix")}return n})}(),function(){i.match("popup-close-button",function(t){t.js(!0),t.content([{elem:"button"}])})}()},n=!0;"object"==typeof modules?(modules.define("BH",[],function(t){o(),t(i)}),modules.define("bh",["BH"],function(t){t(i)}),n=!1):"object"==typeof exports&&(o(),i.bh=i,module.exports=i,n=!1),n&&(o(),t.BH=i,t.bh=i)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),modules.define("page",["i-bem-dom","bh","jquery","util-deferred-action","ymaps-api","ymaps-utils","vow","config","map-data-manager","i18n-plus","yametrika","hotkey-manager","history-manager","copy-manager","result-link","export-image","auth-data","sidebar","map-editor","modal","help-button","button","header"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p,m,g,f,_,b,v,y,M,j,I){i.lib.i18n=d,i.lib.data=c,t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._sidebar=this.findChildBlock(b),this._mapEditor=this.findChildBlock(v),this._helpButton=this.findChildBlock(M),this._events(this.findChildBlock(I)).on("showLoginRequest",function(){this._login()},this).on("openMapListRequest",this._goToMapList,this),this._events(this._sidebar).on("userSaveMapRequest",function(){this._checkPrivateMap()&&(this._showLoader(),this._makeSaveRequest().then(function(){this._sidebar.setMod("step","export-settings"),this._hideLoader()},function(t){return u.logBulkSaveError(this._mapDataProvider,t),this.showErrorMessage(t),t},this),u.reachGoal("CLICK_SAVE"))},this).on("importMapRequest",function(){this.setMod("step","import-modal"),u.reachGoal("CLICK_IMPORT")},this).on("saveMapToImageRequest",function(t,e){this._renderMap(e)},this).on("saveMapDataRequest",function(){this.showExportPopup(),u.reachGoal("CLICK_SHOW_EXPORT_MODAL")},this).on({modName:"step",modVal:"*"},function(t,e){this._applySidebarStep(e.modVal)},this).on("classicPrintRequest",this._classicPrintMapRequest,this),this._applySidebarStep(this._sidebar.getMod("step")),this._events(this._mapEditor).on("simplifyStart",function(t,e){this._showLoader(),this._setLoaderStatus(e.text)},this).on("simplifyEnd",function(){this._hideLoader()},this),this._events(this._helpButton).on("support-open",function(){window.open(c.hosts.support)}).on("hotkeys-open",function(){window.open(c.hosts.hotkeysHelp)}).on("nmaps-open",function(){var t=this._mapDataProvider.get("zoom"),e=this._mapDataProvider.get("center");window.open([c.hosts.nmap,"#!/?z=",t,"&ll=",e.join("%2C")].join(""))},this),this._selectFirstMap();var t=this.getInitialStep();t&&this.setMod("step",t),e.destruct(this.findChildBlock({block:y,modName:"id",modVal:"page-preloader"}).domElem),window.onbeforeunload=function(){return"unsaved"===this._mapDataProvider.get("geoObjectsSaveState")?d("map-selection","close-editor-confirm"):void 0}.bind(this),u.params({cnstExportEnabled:c.canExportMap})}},step:function(t,e,i){this.applyState(e,i),o(":focus").blur(),this._checkHotkeys()}},getInitialStep:function(){c.user.hasMaps=0!==l.getTotal();var t;if(c.user.isUserAuthorized){if(c.getParamsMapState.exist||l.getPreloadedMapEntry())t="editor";else{var e=_.getValue("afterLoginState");c.user.hasMaps?t="newmap"===e?"editor":"mapselection":(t=e?"editor":"promo",this.findChildBlock(I).setMod("nomaps",!0)),_.removeValue("afterLoginState")}u.reachGoal("SHOW_WELCOME")}else t="promo",_.getSessionValue("showAuthSended")||(u.reachGoal("SHOW_AUTH"),_.setSessionValue("showAuthSended",!0));return t},getDataProvider:function(){return this._mapDataProvider},applyState:function(){},_checkHotkeys:function(){var t=this.getMod("loading"),e=this.getMod("step"),i=this._mapEditor.getMod("step"),o="editor"===e&&"edit"===i&&!t;h.setEnabled(o)},selectMap:function(t,e){if(t)this._showLoader(),l.getMapEntry(t,e).then(function(t){this._hideLoader(),this._processMapEntry(t),this._sidebar.setMod("step","map-content"),this._mapEditor.setMod("step","edit")},this);else{var i=l.createEmptyMapEntry(e);this._processMapEntry(i),this._sidebar.setMod("step","map-content"),this._mapEditor.setMod("step","edit")}},_selectFirstMap:function(){var t=l.getPreloadedMapEntry();t?(this._processMapEntry(t),this._sidebar.setMod("step","map-content"),this._mapEditor.setMod("step","edit")):this.selectMap(null)},_login:function(t){location.href=t?c.hosts.passportLoginNew:c.hosts.passportLogin},_showLoader:function(){this.setMod("loading",!0),this._checkHotkeys()},_hideLoader:function(){this.setMod("loading",!1),this._checkHotkeys()},_setLoaderStatus:function(t){this.setMod("loaderStatus",t)},_applySidebarStep:function(t){if(this.setMod("preview","export-settings"===t),"export-settings"===t){var e=this._mapDataProvider;this._mapEditor.setMod("step",e.get("previewError").mapPreview?"preview":"hidden"),this._mapStateListerner=e.createListener(),this._mapStateListerner.add(["zoom","center","containerSize"],function(){n.createAction("saveMap",this._makeSaveRequest.bind(this),1e3)},this)}else this._mapEditor.setMod("step","edit"),this._mapStateListerner&&(this._mapStateListerner.removeAll(),this._mapStateListerner=null);this._checkHotkeys()},_processMapEntry:function(t){return this._mapDataProvider=t,t.createListener().add("previewError",function(t){var e=this._mapEditor.getMod("step");t.mapPreview?"hidden"===e&&this._mapEditor.setMod("step","preview"):"preview"===e&&this._mapEditor.setMod("step","hidden")},this),this._sidebar.setDataProvider(t),this._mapEditor.setDataProvider(t),h.setDataProvider(t),p.setDataProvider(t),m.setDataProvider(t),t},_goToMapList:function(){("unsaved"!==this._mapDataProvider.get("geoObjectsSaveState")||window.confirm(d("map-selection","close-editor-confirm")))&&(u.reachGoal("CLICK_MAPSLIST"),this.setMod("step","mapselection"))},_checkPrivateMap:function(){var t=this._mapDataProvider;return"private"!==t.get("access")||window.confirm(d("map-selection","PRIVATE_MYMAPS"))?!0:!1},_classicPrintMapRequest:function(){var t=this._mapDataProvider,e=window.open(c.hosts.constructor+"loader","_blank");this._showLoader(),this._makeSaveRequest().then(function(){this._hideLoader(),e.location=g.getMapLink(t.get("sid"),{path:"print",source:"constructorPrint"}),u.clickPrint(t)},function(t){return this.showErrorMessage(t),t},this)},_makeSaveRequest:function(){return this._mapDataProvider.save()},_renderMap:function(t){var e=this._mapDataProvider;u.saveImage(e,t.saveToDisk),this._showLoader();var i=f(e,t),o=Number(new Date);i.then(function(e){t.saveToDisk?this.showNotify("mapSaved"):this.showDownloadPopup(e.blob,e.fileName)
},function(e){u.saveImageError(e,t.saveToDisk),this.showErrorMessage(e,!0)},function(t){console.log(t.message+" ("+t.step+"/"+t.total+") "+(Number(new Date)-o)),o=Number(new Date),this._setLoaderStatus(t.message)},this)}}))}),modules.define("i-bem-dom",["i-bem","i-bem__internal","i-bem-dom__collection","i-bem-dom__events_type_dom","i-bem-dom__events_type_bem","inherit","identify","objects","functions","jquery","dom"],function(t,e,i,o,n,s,r,a,c,l,d,u){function h(t,e,i){var o,n,s,r,a=t[0],c=_(a);for(o in c)i&&(n=o.split(B),s=n[0],r=n[1],r&&((i[s]||(i[s]={}))[r]=!0)),p(o,t,g(c[o],o,e))}function p(t,e,i,o,n){var s=e[0];if(!L[a(s)]){i||(i=g(b(s,t),t));var r=i.uniqId,l=D[r];if(l)return l.domElem.index(s)<0&&(l.domElem=l.domElem.add(e),c.extend(l.params,i)),l;w[r]=w[r]?w[r].add(e):e;var u=s.parentNode;u&&11!==u.nodeType||d.unique(w[r]);var h=m(t);return h._processInit(),!h.lazyInit||o||i.lazyInit===!1?(o&&e.addClass(E),l=new h(w[r],i,!!o),delete w[r],n&&n.apply(l,V.call(arguments,4)),l):void 0}}function m(t){if(O[t])return O[t];var e=t.split(B);return e[1]?x.declElem(e[0],e[1],{},{lazyInit:!0},!0):x.declBlock(t,{},{lazyInit:!0},!0)}function g(t,e,i){return t.uniqId||(t.uniqId=(t.id?e+"-id-"+t.id:a())+(i||a())),t}function f(t,e,i){var o=t.find(e);return i?o:o.add(t.filter(e))}function _(t){var e=a(t);return N[e]||(N[e]=v(t))}function b(t,e){var i=_(t);return i[e]||(i[e]={})}function v(t){var e=t.getAttribute(z);return e?JSON.parse(e):{}}function y(t,e){1===t.domElem.length?(t._delInitedMod(),delete D[t._uniqId]):t.domElem=t.domElem.not(e)}function M(t){t.each(function(){S[a(this)]=this.parentNode})}function j(t,e){t.add(t.parents()).each(function(t,i){var o=N[a(i)];o&&c.each(o,function(t){var i=D[t.uniqId];if(i){var o=e[i.__self._blockName];o&&i._dropElemCache(Object.keys(o))}})}),e={}}function I(t){return"string"==typeof t?t={elem:t}:l.isFunction(t)?t={elem:t.getName()}:l.isFunction(t.elem)&&(t.elem=t.elem.getName()),{elem:t.elem,mod:G(t.modName,t.modVal)}}function C(t){return d("string"==typeof t?d.parseHTML(t,null,!0):t)}var k,x,w={},D={},S={},N={},L={},O=e.entities,E="i-bem",A="."+E,z="data-bem",T=i.NAME_PATTERN,P=i.MOD_DELIM,B=i.ELEM_DELIM,G=i.buildModPostfix,Y=i.buildClassName,R=Array.prototype.reverse,V=Array.prototype.slice,U=new n.EventManagerFactory(m),Z=new s.EventManagerFactory(m),W=r({__constructor:function(t,e,i){this.domElem=t,this._elemsCache={},this._elemCache={},this._findBackRefs=[],D[e.uniqId||a(this)]=this,this.__base(null,e,i)},_block:function(){},_elems:function(t){var e=I(t),i=this._elemsCache[e.elem];if(i&&e.mod in i)return i[e.mod];var o=(i||(this._elemsCache[e.elem]={}))[e.mod]=this.findMixedElems(t).concat(this.findChildElems(t));return o.forEach(function(t){t._findBackRefs.push(this)},this),o},_elem:function(t){var e=I(t),i=this._elemCache[e.elem];if(i&&e.mod in i)return i[e.mod];var o=(i||(this._elemCache[e.elem]={}))[e.mod]=this.findMixedElem(t)||this.findChildElem(t);return o&&o._findBackRefs.push(this),o},_dropElemCache:function(t){return arguments.length?((Array.isArray(t)?t:V.call(arguments)).forEach(function(t){var e=I(t);e.mod?(this._elemsCache[e.elem]&&delete this._elemsCache[e.elem][e.mod],this._elemCache[e.elem]&&delete this._elemCache[e.elem][e.mod]):(delete this._elemsCache[e.elem],delete this._elemCache[e.elem])},this),this):(this._elemsCache={},this._elemCache={},this)},findChildBlock:function(t){return this._findEntities("find",t,!0)},findChildBlocks:function(t){return this._findEntities("find",t)},findParentBlock:function(t){return this._findEntities("parents",t,!0)},findParentBlocks:function(t){return this._findEntities("parents",t)},findMixedBlock:function(t){return this._findEntities("filter",t,!0)},findMixedBlocks:function(t){return this._findEntities("filter",t)},findChildElem:function(t,e){return e?this._filterFindElemResults(this._findEntities("find",t)).get(0):this._findEntities("find",t,!0)},findChildElems:function(t,e){var i=this._findEntities("find",t);return e?this._filterFindElemResults(i):i},findParentElem:function(t,e){return e?this._filterFindElemResults(this._findEntities("parents",t))[0]:this._findEntities("parents",t,!0)},findParentElems:function(t,e){var i=this._findEntities("parents",t);return e?this._filterFindElemResults(i):i},findMixedElem:function(t){return this._findEntities("filter",t,!0)},findMixedElems:function(t){return this._findEntities("filter",t)},_filterFindElemResults:function(t){var e=this._block();return t.filter(function(t){return t._block()===e})},_findEntities:function(t,e,i){var n=l.isFunction(e)?e.getEntityName():"object"==typeof e?e.block?e.block.getEntityName():"string"==typeof e.elem?this.__self._blockName+B+e.elem:e.elem.getEntityName():this.__self._blockName+B+e,s="."+("object"==typeof e?Y(n,e.modName,"undefined"==typeof e.modVal?!0:e.modVal):Y(n))+(i?":first":""),r=this.domElem[t](s);if(i)return r[0]?p(n,r.eq(0),k,!0)._setInitedMod():null;var a=[],c={};return r.each(function(t,e){var i=p(n,d(e),k,!0)._setInitedMod();c[i._uniqId]||(c[i._uniqId]=!0,a.push(i))}),new o(a)},_domEvents:function(t){return U.getEventManager(this,t,this.domElem)},_events:function(t){return Z.getEventManager(this,t,this.domElem)},_emit:function(t,e){return("object"==typeof t&&"js"===t.modName||this.hasMod("js","inited"))&&s.emit(this,t,e),this},_extractModVal:function(t){var e,i=this.domElem[0];return i&&(e=i.className.match(this.__self._buildModValRE(t))),e?e[2]||!0:""},_onSetMod:function(t,e,i){var o=this.__self,n=o.getName();if(this._findBackRefs.forEach(function(o){""===i||o._dropElemCache({elem:n,modName:t,modVal:i}),o._dropElemCache(""===e?n:{elem:n,modName:t,modVal:e})}),this.__base.apply(this,arguments),"js"!==t||""!==e){var s=o._buildModClassNamePrefix(t),r=o._buildModValRE(t),a=""===e;this.domElem.each(function(){var t=this.className,o=s;e!==!0&&(o+=P+e),(i===!0?r.test(t):(" "+t).indexOf(" "+s+P)>-1)?this.className=t.replace(r,a?"":"$1"+o):a||d(this).addClass(o)})}},_afterSetMod:function(t,e,i){var o={modName:t,modVal:e,oldModVal:i};this._emit({modName:t,modVal:"*"},o)._emit({modName:t,modVal:e},o)},containsEntity:function(t){return u.contains(this.domElem,t.domElem)}},{create:function(){throw Error("bemDom entities can not be created otherwise than from DOM")},_processInit:function(t){if(this.onInit&&this._inited==t){this.__base(t),this.onInit();var e=this.getName(),i=this.onInit;this.init=function(){this.getName()===e&&i.apply(this,arguments)}}},_domEvents:function(t){return U.getEventManager(this,t,x.scope)},_events:function(t){return Z.getEventManager(this,t,x.scope)},_buildModClassNamePrefix:function(t){return this.getEntityName()+P+t},_buildModValRE:function(t){return new RegExp("(\\s|^)"+this._buildModClassNamePrefix(t)+"(?:"+P+"("+T+"))?(?=\\s|$)")},_buildClassName:function(t,e){return Y(this.getEntityName(),t,e)},_buildSelector:function(t,e){return"."+this._buildClassName(t,e)}}),F=r([e.Block,W],{_block:function(){return this}}),Q=r([e.Elem,W],{_block:function(){return this._blockInstance||(this._blockInstance=this.findParentBlock(m(this.__self._blockName)))}});d.fn.bem=function(t,e){var i=p(t.getEntityName(),this,e,!0);return i?i._setInitedMod():null},d(function(){x={scope:d("body"),doc:d(document),win:d(window),Block:F,Elem:Q,isEntity:function(t){return t instanceof F||t instanceof Q},declBlock:function(t,i,o,n){return(!i||"object"==typeof i&&!Array.isArray(i))&&(n=o,o=i,i="string"==typeof t?O[t]||F:t),e.declBlock(t,i,o,n)},declElem:function(t,i,o,n,s){return(!o||"object"==typeof o&&!Array.isArray(o))&&(s=n,n=o,o=O[t+B+i]||Q),e.declElem(t,i,o,n,s)},declMixin:e.declMixin,init:function(t){t="string"==typeof t?d(t):t||x.scope;var i=t===x.scope?{}:k,o=a();return f(t,A).each(function(){h(d(this),o,i)}),e._runInitFns(),i&&j(t,i),t},_destruct:function(t,e,i){var o,n=[];M(o=e?t.children():t),R.call(f(o,A)).each(function(t,e){var i=_(e),o=a(e);L[o]=!0,n.push(o),c.each(i,function(t){if(t.uniqId){var i=D[t.uniqId];i?y(i,e):delete w[t.uniqId]}}),delete N[a(e)]}),i&&(e?t.empty():t.remove()),S={},n.forEach(function(t){delete L[t]})},destruct:function(t,e){this._destruct(t,e,!0)},detach:function(t,e){this._destruct(t,e)},update:function(t,e){return this.destruct(t,!0),this.init(t.html(e))},replace:function(t,e){var i=t.prev(),o=t.parent();return e=C(e),this.destruct(t),this.init(i.length?e.insertAfter(i):e.prependTo(o))},append:function(t,e){return this.init(C(e).appendTo(t))},prepend:function(t,e){return this.init(C(e).prependTo(t))},before:function(t,e){return this.init(C(e).insertBefore(t))},after:function(t,e){return this.init(C(e).insertAfter(t))}},t(x)})}),function(){var t=modules.define,e=[];modules.define=function(i,o){t.apply(modules,arguments),"i-bem-dom__init"!==i&&arguments.length>2&&~o.indexOf("i-bem-dom")&&(e.push(i),1===e.length&&modules.define("i-bem-dom__init",e,function(t){t(arguments[arguments.length-1]),e=[]}))}}(),function(t){function e(t){var e=l(t);if(g)for(var i,o=0;i=b[o++];)t.hasOwnProperty(i)&&e.push(i);return e}function i(t,i,o){for(var n,r,a=e(o),c=0,l=a.length;l>c;)"__self"!==(n=a[c++])&&(r=o[n],i[n]=p(r)&&(!s||r.toString().indexOf(".__base")>-1)?function(e,o){var n=t[e]?t[e]:"__constructor"===e?i.__self.__parent:m;return function(){var t=this.__base;this.__base=n;var e=o.apply(this,arguments);return this.__base=t,e}}(n,r):r)}function o(t,e){for(var i,o=1;i=t[o++];)e?p(i)?n.self(e,i.prototype,i):n.self(e,i):e=p(i)?n(t[0],i.prototype,i):n(t[0],i);return e||t[0]}function n(){var t=arguments,e=h(t[0]),n=e||p(t[0]),s=n?e?o(t[0]):t[0]:r,a=t[n?1:0]||{},l=t[n?2:1],u=a.__constructor||n&&s.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:n?function(){return s.apply(this,arguments)}:function(){};if(!n)return u.prototype=a,u.prototype.__self=u.prototype.constructor=u,d(u,l);d(u,s),u.__parent=s;var m=s.prototype,g=u.prototype=c(m);return g.__self=g.constructor=u,a&&i(m,g,a),l&&i(s,u,l),u}var s=function(){"_"}.toString().indexOf("_")>-1,r=function(){},a=Object.prototype.hasOwnProperty,c=Object.create||function(t){var e=function(){};return e.prototype=t,new e},l=Object.keys||function(t){var e=[];for(var i in t)a.call(t,i)&&e.push(i);return e},d=function(t,e){for(var i in e)a.call(e,i)&&(t[i]=e[i]);return t},u=Object.prototype.toString,h=Array.isArray||function(t){return"[object Array]"===u.call(t)},p=function(t){return"[object Function]"===u.call(t)},m=function(){},g=!0,f={toString:""};for(var _ in f)f.hasOwnProperty(_)&&(g=!1);var b=g?["toString","valueOf"]:null;n.self=function(){var t=arguments,e=h(t[0]),n=e?o(t[0],t[0][0]):t[0],s=t[1],r=t[2],a=n.prototype;return s&&i(a,a,s),r&&i(n,n,r),n};var v=!0;"object"==typeof exports&&(module.exports=n,v=!1),"object"==typeof modules&&(modules.define("inherit",function(t){t(n)}),v=!1),"function"==typeof define&&(define(function(t,e,i){i.exports=n}),v=!1),v&&(t.inherit=n)}(this),modules.define("jquery",["loader_type_js","jquery__config"],function(t,e,i){function o(e){t(e?jQuery:jQuery.noConflict(!0))}"undefined"!=typeof jQuery?o(!0):e(i.url,o)}),modules.define("jquery__config",function(t){t({url:"https://yastatic.net/jquery/3.1.0/jquery.min.js"})}),modules.define("jquery__config",["ua","objects"],function(t,e,i,o){t(e.msie&&parseInt(e.version,10)<9?i.extend(o,{url:"https://yastatic.net/jquery/1.12.3/jquery.min.js"}):o)}),modules.define("ua",function(t){var e=navigator.userAgent.toLowerCase(),i=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],o={browser:i[1]||"",version:i[2]||"0"},n={};o.browser&&(n[o.browser]=!0,n.version=o.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),t(n)}),modules.define("objects",function(t){var e=Object.prototype.hasOwnProperty;t({extend:function(t){("object"!=typeof t||null===t)&&(t={});for(var i=1,o=arguments.length;o>i;i++){var n=arguments[i];if(n)for(var s in n)e.call(n,s)&&(t[s]=n[s])}return t},isEmpty:function(t){for(var i in t)if(e.call(t,i))return!1;return!0},each:function(t,i,o){for(var n in t)e.call(t,n)&&(o?i.call(o,t[n],n):i(t[n],n))}})}),modules.define("functions",function(t){var e=Object.prototype.toString;t({isFunction:function(t){return"[object Function]"===e.call(t)},noop:function(){}})}),modules.define("dom",["jquery"],function(t,e){t({contains:function(t,e){var i=!1;return e.each(function(){var e=this;do if(~t.index(e))return!(i=!0);while(e=e.parentNode);return i}),i},getFocused:function(){try{return e(document.activeElement)}catch(t){}},containsFocus:function(t){return this.contains(t,this.getFocused())},isFocusable:function(t){var e=t[0];if(!e)return!1;if(e.hasAttribute("tabindex"))return!0;switch(e.tagName.toLowerCase()){case"iframe":return!0;case"input":case"button":case"textarea":case"select":return!e.disabled;case"a":return!!e.href}return!1},isEditable:function(t){var e=t[0];if(!e)return!1;switch(e.tagName.toLowerCase()){case"input":var i=e.type;return!("text"!==i&&"password"!==i||e.disabled||e.readOnly);case"textarea":return!e.disabled&&!e.readOnly;default:return"true"===e.contentEditable}}})}),modules.define("i-bem-dom__init",["i-bem-dom"],function(t,e){t(function(t){return e.init(t)})}),modules.define("i-bem",["i-bem__internal","inherit","identify","next-tick","objects","functions"],function(t,e,i,o,n,s,r){function a(t,e,i){return"__"+t+"__mod"+(e?"_"+e:"")+(i?"_"+i:"")}function c(t,e,i,o){return i||o?function(n,s,r){var a,c;return i&&(a=i.apply(this,arguments)===!1),(o?o(t,s,r):!0)&&(c=e.apply(this,arguments)===!1),a||c?!1:void 0}:e}function l(t,e,i){if(r.isFunction(e))i[a(t,"*","*")]=e;else{var o,n,s;for(o in e)if(s=e[o],r.isFunction(s))i[a(t,o,"*")]=s;else{var l=a(t,o,"*");for(n in s){var d=s[n],u=n[0];"!"===u||"~"===u||"*"===n?("*"===n||(n=n.substr(1)),i[l]=c(n,d,i[l],b[u])):i[a(t,o,n)]=d}}}}function d(t,e){return e?Array.isArray(e)?function(i){for(var o=0,n=e.length;n>o;)if(u(i,t,e[o++]))return!0;return!1}:function(i){return u(i,t,e)}:function(e){return u(e,t,!0)}}function u(t,e,i){var o=t._processingMods[e];return"*"===i?t.hasMod(e)||null!=o:t.hasMod(e,i)||o===i}function h(t){t.beforeSetMod&&(l("before",t.beforeSetMod,t),delete t.beforeSetMod),t.onSetMod&&(l("after",t.onSetMod,t),delete t.onSetMod)}function p(t,e,o,n,s){o||(o=_[e]||t),Array.isArray(o)||(o=[o]),o[0].__bemEntity||(o=o.slice(),o.unshift(_[e]||t)),n&&h(n);var r;return e===o[0].getEntityName()?(r=i.self(o,n,s))._processInit(!0):r=_[e]=i(o,n,s),r}var m,g=e.ELEM_DELIM,f=[],_={},b={"!":function(t,e){return e!==t},"~":function(t,e,i){return i===t}},v=i({__constructor:function(t,e,i){this._modCache=t||{},this._processingMods={},this.params=s.extend(this._getDefaultParams(),e),this._uniqId=this.params.uniqId||o(this),i!==!1?this._setInitedMod():f.push(this._setInitedMod,this)},_setInitedMod:function(){return this.setMod("js","inited")},_delInitedMod:function(){this.delMod("js")},hasMod:function(t,e){var i=typeof e;"undefined"===i||"boolean"===i||(e=e.toString());var o=this.getMod(t)===(e||"");return 1===arguments.length?!o:o},getMod:function(t){var e=this._modCache;return t in e?e[t]||"":e[t]=this._extractModVal(t)},setMod:function(t,e){var i=typeof e;if("undefined"===i?e=!0:"boolean"===i?e===!1&&(e=""):e=e.toString(),null!=this._processingMods[t])return this;var o=this.getMod(t);if(o===e)return this;this._processingMods[t]=o;for(var n,s,r,a=!0,c=[t,e,o],l=[["*","*"],[t,"*"],[t,e]],d=["before","after"],u=0;n=d[u++];){for(s=0;r=l[s++];)if(this._callModFn(n,r[0],r[1],c)===!1){a=!1;break}if(!a)break;"before"===n&&(this._modCache[t]=e,this._onSetMod(t,e,o))}return this._processingMods[t]=null,a&&this._afterSetMod(t,e,o),this},_onSetMod:function(){},_afterSetMod:function(){},toggleMod:function(t,e,i,o){"undefined"==typeof e&&(e=!0),"undefined"==typeof i?i="":"boolean"==typeof i&&(o=i,i="");var n=this.getMod(t);return(n===e||n===i)&&this.setMod(t,"boolean"==typeof o?o?e:i:this.hasMod(t,e)?i:e),this},delMod:function(t){return this.setMod(t,"")},_callModFn:function(t,e,i,o){var n=a(t,e,i);return this[n]?this[n].apply(this,o):m},_extractModVal:function(){return""},_getDefaultParams:function(){return{}},_nextTick:function(t){var e=this;return n(function(){e.hasMod("js","inited")&&t.call(e)}),this}},{create:function(t,e){return new this(t,e)},declMod:function(t,e,o){e&&h(e);var n=d(t.modName,t.modVal),a=this.prototype;return s.each(e,function(t,i){r.isFunction(t)&&(e[i]=function(){var e;if(n(this))e=t;else{var o=a[i];o&&o!==t&&(e=this.__base)}return e?e.apply(this,arguments):m})}),i.self(this,e,o)},__bemEntity:!0,_name:null,_processInit:function(){this._inited=!0},getName:function(){return this._name},getEntityName:function(){return this._name}}),y=v,M=i(v,{_block:function(){return this._blockInstance}},{create:function(t,e,i){var o=new this(e,i);return o._blockInstance=t,o},getEntityName:function(){return this._blockName+g+this._name}});t({Block:y,Elem:M,entities:_,declBlock:function(t,e,i,o){"object"!=typeof e||Array.isArray(e)||(o=i,i=e,e=m);var n=y;"string"!=typeof t&&(n=t,t=t.getEntityName());var s=p(n,t,e,i,o);return s._name=s._blockName=t,s},declElem:function(t,e,i,o,n){var s,r=M;"string"!=typeof t?(n=o,o=i,i=e,e=t._name,r=t,t=r._blockName,s=r.getEntityName()):s=t+g+e,"object"!=typeof i||Array.isArray(i)||(n=o,o=i,i=m);var a=p(r,s,i,o,n);return a._blockName=t,a._name=e,a},declMixin:function(t,e){return h(t||(t={})),i(t,e)},_runInitFns:function(){if(f.length){var t,e=f,i=0;for(f=[];t=e[i];)t.call(e[i+1]),i+=2}}})}),modules.define("i-bem__internal",function(t){function e(t){var e=typeof t;return"string"===e||"number"===e||"boolean"===e}function i(t,e){var i="";return null!=e&&e!==!1&&(i+=r+t,e!==!0&&(i+=r+e)),i}function o(t,e,o){return t+i(e,o)}function n(t,e,n,r){return o(t,s,s)+a+e+i(n,r)}var s,r="_",a="__",c="[a-zA-Z0-9-]+";t({NAME_PATTERN:c,MOD_DELIM:r,ELEM_DELIM:a,buildModPostfix:i,buildClassName:function(t,i,r,a){return e(r)?e(a)||(a=r,r=i,i=s):"undefined"!=typeof r?r=s:i&&"string"!=typeof i&&(i=s),i||r?i?n(t,i,r,a):o(t,r,a):t},buildClassNames:function(t,e,i){e&&"string"!=typeof e&&(i=e,e=s);var r=e?n(t,e,s,s):o(t,s,s);if(i)for(var a in i)i.hasOwnProperty(a)&&i[a]&&(r+=" "+(e?n(t,e,a,i[a]):o(t,a,i[a])));return r}})}),modules.define("identify",function(t){var e=0,i="__"+ +new Date,o=this.global,n=function(){return"uniq"+ ++e},s=function(t){if("object"==typeof t&&null!==t||"function"==typeof t){var e;return"uniqueID"in t?(t===o.document&&(t=t.documentElement),e="uniqueID"):e=i,e in t?t[e]:t[e]=n()}return""};t(function(t){if(arguments.length){if(1===arguments.length)return s(t);for(var e=[],i=0,o=arguments.length;o>i;i++)e.push(s(arguments[i]));return e.sort().join("")}return n()})}),modules.define("next-tick",function(t){var e=this.global,i=[],o=function(t){return i.push(t),1===i.length},n=function(){var t=i,e=0,o=i.length;for(i=[];o>e;)t[e++]()};if("object"==typeof process&&process.nextTick)return t(function(t){o(t)&&process.nextTick(n)});if(e.setImmediate)return t(function(t){o(t)&&e.setImmediate(n)});if(e.postMessage){var s=!0;if(e.attachEvent){var r=function(){s=!1};e.attachEvent("onmessage",r),e.postMessage("__checkAsync","*"),e.detachEvent("onmessage",r)}if(s){var a="__nextTick"+ +new Date,c=function(t){t.data===a&&(t.stopPropagation&&t.stopPropagation(),n())};return e.addEventListener?e.addEventListener("message",c,!0):e.attachEvent("onmessage",c),t(function(t){o(t)&&e.postMessage(a,"*")})}}var l=e.document;if("onreadystatechange"in l.createElement("script")){var d=l.getElementsByTagName("head")[0],u=function(){var t=l.createElement("script");t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,n()},d.appendChild(t)};return t(function(t){o(t)&&u()})}t(function(t){o(t)&&e.setTimeout(n,0)})}),modules.define("i-bem-dom__events",["i-bem__internal","i-bem-dom__collection","inherit","identify","objects","jquery","functions"],function(t,e,i,o,n,s,r,a){var c,l=window,d=document,u=(n(l),n(d),{}),h=o({__constructor:function(t,e,i){this._params=t,this._fnWrapper=e,this._eventBuilder=i,this._storage={}},on:function(t,e,i,o,s){var r=this._params,l=this._eventBuilder(t,r);a.isFunction(e)&&(s=o,o=i,i=e,e=c);var d=this._storage[l]||(this._storage[l]={}),u=n(i,o);if(!d[u]){var h=r.bindDomElem,p=r.bindSelector,m=this,g=d[u]=this._fnWrapper(s?function(){m.un(t,i,o),i.apply(this,arguments)}:i,o,u);h.on(l,p,e,g),p&&h.is(p)&&h.on(l,e,g)}return this},once:function(t,e,i,o){return a.isFunction(e)&&(o=i,i=e,e=c),this.on(t,e,i,o,!0)},un:function(t,e,i){var o=arguments.length;if(o){var r=this._params,a=this._eventBuilder(t,r);if(1===o)this._unbindByEvent(this._storage[a],a);else{var c,l=n(e,i),d=this._storage[a],u=r.bindDomElem,h=r.bindSelector;(c=d&&d[l])&&delete d[l];var p=c||e;u.off(a,r.bindSelector,p),h&&u.is(h)&&u.off(a,p)}}else s.each(this._storage,this._unbindByEvent,this);return this},_unbindByEvent:function(t,e){var i=this._params,o=i.bindDomElem,n=i.bindSelector,r=n&&o.is(n);t&&s.each(t,function(t){o.off(e,n,t),r&&o.off(e,t)}),this._storage[e]=null}}),p=function(t){return function(){var e=arguments;return this._eventManagers.forEach(function(i){i[t].apply(i,e)}),this}},m=o({__constructor:function(t){this._eventManagers=t},on:p("on"),once:p("once"),un:p("un")}),g=o({__constructor:function(t){this._storageSuffix=n(),this._getEntityCls=t,this._eventManagerCls=h},getEventManager:function(t,e,o){if(e instanceof i)return new m(e.map(function(e){return this.getEventManager(t,e,o)},this));var s,r=n(t),a=u[r],c=this._storageSuffix,l="function"!=typeof t,d="";l?s=t.__self:(s=t,d=t._buildSelector());var h=this._buildEventManagerParams(e,o,d,s),p=h.key+c;return a||(a=u[r]={},l&&t._events().on({modName:"js",modVal:""},function(){h.bindToArbitraryDomElem&&a[p]&&a[p].un(),delete a[r]})),a[p]||(a[p]=this._createEventManager(t,h,l))},_buildEventManagerParams:function(t,i,o,s){var a={bindEntityCls:null,bindDomElem:i,bindToArbitraryDomElem:!1,bindSelector:o,ctxSelector:o,key:""};if(t){var c=typeof t;if(t.jquery)a.bindDomElem=t,a.key=n.apply(null,t.get()),a.bindToArbitraryDomElem=!0;else if(t===l||t===d||"object"===c&&1===t.nodeType)a.bindDomElem=r(t),a.key=n(t),a.bindToArbitraryDomElem=!0;else if("object"===c&&t.__self)a.bindDomElem=t.domElem,a.key=t._uniqId,a.bindEntityCls=t.__self;else if("string"===c||"object"===c||"function"===c){var u,h,p,m;"string"===c?(u=s._blockName,h=t):"object"===c?(u=t.block?t.block.getName():s._blockName,h="function"==typeof t.elem?t.elem.getName():t.elem,p=t.modName,m=t.modVal):t.getName()===t.getEntityName()?u=t.getName():(u=s._blockName,h=t.getName());var g=e.buildClassName(u,h);a.bindEntityCls=this._getEntityCls(g),a.bindSelector="."+(a.key=g+e.buildModPostfix(p,m))}}else a.bindEntityCls=s;return a},_createEventManager:function(){throw new Error("not implemented")}});t({EventManagerFactory:g})}),modules.define("i-bem-dom__collection",["inherit","i-bem__collection"],function(t,e,i){function o(t,e,i){return t.map(function(t){return t[e].apply(t,i)})}function n(t){return function(){return new r(o(this,t,arguments))}}function s(t){return function(){var e=[];return o(this,t,arguments).forEach(function(t){t.forEach(function(t){e.push(t)})}),new r(e)}}var r=e(i,{findChildBlock:n("findChildBlock"),findChildBlocks:s("findChildBlocks"),findParentBlock:n("findParentBlock"),findParentBlocks:s("findParentBlocks"),findMixedBlock:n("findMixedBlock"),findMixedBlocks:s("findMixedBlocks"),findChildElem:n("findChildElem"),findChildElems:s("findChildElems"),findParentElem:n("findParentElem"),findParentElems:s("findParentElems"),findMixedElem:n("findMixedElem"),findMixedElems:s("findMixedElems")});t(r)}),modules.define("i-bem__collection",["inherit"],function(t,e){function i(t){return function(){var e=arguments;return this._entities.forEach(function(i){i[t].apply(i,e)}),this}}function o(t){return function(){var e=this._entities;return e[t].apply(e,arguments)}}function n(t,e){return function(){var i=arguments;return this._entities[t](function(t){return t[e].apply(t,i)})}}var s=e({__constructor:function(t){var e=this._entities=[],i={};(Array.isArray(t)?t:a.call(arguments)).forEach(function(t){i[t._uniqId]||(i[t._uniqId]=!0,e.push(t))})},setMod:i("setMod"),delMod:i("delMod"),toggleMod:i("toggleMod"),everyHasMod:n("every","hasMod"),someHasMod:n("some","hasMod"),get:function(t){return this._entities[t]},forEach:o("forEach"),map:o("map"),reduce:o("reduce"),reduceRight:o("reduceRight"),filter:function(){return new this.__self(o("filter").apply(this,arguments))},some:o("some"),every:o("every"),has:function(t){return this._entities.indexOf(t)>-1},find:function(t,e){e||(e=this);for(var i,o=this._entities,n=0;i=o[n];)if(t.call(e,o[n],n++,this))return i;return null},concat:function(){for(var t,e=0,i=arguments.length,o=[];i>e;)t=arguments[e++],o.push(t instanceof s?t._entities:t);return new s(r.apply(this._entities,o))},size:function(){return this._entities.length},toArray:function(){return this._entities.slice()}}),r=Array.prototype.concat,a=Array.prototype.slice;t(s)}),modules.define("i-bem-dom__events_type_bem",["i-bem-dom__events","i-bem__internal","inherit","functions","jquery","identify","events"],function(t,e,i,o,n,s,r,a){var c="__bem__",l="modchange",d=s.event.special,u={},h=function(t){return{setup:function(){u[t]||(u[t]=!0)},teardown:n.noop}},p=function(t,e){var o=c+e.bindEntityCls.getEntityName()+("object"==typeof t?t instanceof a.Event?t.type:i.buildModPostfix(t.modName,t.modVal):t);return d[o]||(d[o]=h(o)),o},m=o(e.EventManagerFactory,{_createEventManager:function(t,e,i){function o(o,n,r){return function(a,c,l,d){if(!l.fns[r]){var u,h;i?(u=t,h=u.domElem):(h=s(a.target).closest(e.ctxSelector),h.length&&(u=h.bem(t))),!u||l.propagationStoppedDomNode&&s.contains(h[0],l.propagationStoppedDomNode)||(d.data=a.data,d.bemTarget=d.target,l.fns[r]=!0,o.call(n||u,d,c),d.isPropagationStopped()&&(a.stopPropagation(),l.propagationStoppedDomNode=h[0]))}}}return new this._eventManagerCls(e,o,p)}});t({emit:function(t,e,i){var o;"string"==typeof e?o=new a.Event(e,t):e.modName?o=new a.Event(l,t):e.target||(e.target=t,o=e);var n=p(e,{bindEntityCls:t.__self});u[n]&&t.domElem.trigger(n,[i,{fns:{},propagationStoppedDomNode:null},o])},EventManagerFactory:m})}),modules.define("events",["identify","inherit","functions"],function(t,e,i,o){var n,s="__"+ +new Date+"storage",r=i({__constructor:function(t,e){this.type=t,this.target=e,this.data=n,this._isDefaultPrevented=!1,this._isPropagationStopped=!1},preventDefault:function(){this._isDefaultPrevented=!0},isDefaultPrevented:function(){return this._isDefaultPrevented},stopPropagation:function(){this._isPropagationStopped=!0},isPropagationStopped:function(){return this._isPropagationStopped}}),a=i({on:function(t,i,r,a,c){if("string"==typeof t){o.isFunction(i)&&(a=r,r=i,i=n);for(var l,d,u,h,p=e(r,a),m=this[s]||(this[s]={}),g=t.split(" "),f=0;l=g[f++];)h=m[l]||(m[l]={ids:{},list:{}}),p in h.ids||(d=h.list,u={fn:r,data:i,ctx:a,special:c},d.last?(d.last.next=u,u.prev=d.last):d.first=u,h.ids[p]=d.last=u)}else for(var _ in t)t.hasOwnProperty(_)&&this.on(_,t[_],i,c);return this},once:function(t,e,i,o){return this.on(t,e,i,o,{once:!0})},un:function(t,i,o){if("string"==typeof t||"undefined"==typeof t){var n=this[s];if(n)if(t){for(var r,a=t.split(" "),c=0;t=a[c++];)if(r=n[t])if(i){var l=e(i,o),d=r.ids;if(l in d){var u=r.list,h=d[l],p=h.prev,m=h.next;p?p.next=m:h===u.first&&(u.first=m),m?m.prev=p:h===u.last&&(u.last=p),delete d[l]}}else delete this[s][t]}else delete this[s]}else for(var g in t)t.hasOwnProperty(g)&&this.un(g,t[g],i);return this},emit:function(t){var e=this[s],i=!1;if(e)for(var o,n,a=["string"==typeof t?t:t.type,"*"],c=0;o=a[c++];)if(n=e[o])for(var l,d=n.list.first,u=n.list.last;d&&(i||(i=!0,"string"==typeof t&&(t=new r(t)),t.target||(t.target=this)),t.data=d.data,l=d.fn.apply(d.ctx||this,arguments),l===!1&&(t.preventDefault(),t.stopPropagation()),d.special&&d.special.once&&this.un(t.type,d.fn,d.ctx),d!==u);)d=d.next;return this}});t({Emitter:a,Event:r})}),modules.require(["i-bem-dom__init","jquery","next-tick"],function(t,e,i){e(function(){i(t)})}),modules.define("config",["ymaps-map-types","util-get-params"],function(t,e,i){function o(o){o.apiCoordorderParam="longlat",o.exportLoadModules=["Map","GeoObject","pane.StaticPane","traffic.provider.Actual","layer.tileContainer.CanvasContainer","overlay.Placemark","overlay.Polyline","overlay.Polygon","util.hd","mapType.storage","layer.storage","option.presetStorage","templateLayoutFactory","util.extend","meta","theme.islands.geoObject.preset.pictogram.icons"].join(","),o.getMapsLimit=25,o.printLogoLang="ru"===o.lang||"uk"===o.lang?"ru":"en",window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));var s=window.location.origin+window.location.pathname;"/"!==s.substr(-1)&&(s+="/"),o.baseURL=s;var r=o.uatraits,a=r.BrowserEngine?r.BrowserEngine.toLowerCase():"",c=r.BrowserBase?r.BrowserBase.toLowerCase():"",l=r.BrowserName?r.BrowserName.toLowerCase():"";o.browser={isSafari:"safari"===l,isMobileSafari:"mobilesafari"===l,isChromium:"chromium"===c,isGecko:"gecko"===a,isEdge:"edge"===a,isIE:"trident"===a},o.OSFamily=r.OSFamily,o.canCopyFromPage=!(void 0===document.execCommand||!document.queryCommandSupported("copy")||o.browser.isMobileSafari),o.canExportMap=!r.isMobile&&!r.isTablet&&(o.browser.isSafari||o.browser.isChromium||o.browser.isGecko||o.browser.isEdge),o.getParamsMapState={};var d=String(i.get("ll"));d&&(d=d.split(","),2===d.length?(d[0]=Number(d[0]),d[1]=Number(d[1])):d=null),!d||isNaN(d[0])||isNaN(d[1])||(o.getParamsMapState.center={longitude:d[0],latitude:d[1]},o.getParamsMapState.exist=!0);var u=i.get("um");u&&u.length&&(o.getParamsMapState.sid=u.split(":").splice(-2).join(":"));var h=Number(i.get("z"));h&&!isNaN(h)&&(o.getParamsMapState.zoom=h,o.getParamsMapState.exist=!0);var p={map:"yandex#map",sat:"yandex#satellite","sat,skl":"yandex#hybrid"},m=i.get("l");if(m&&m.indexOf("trf")>-1&&!i.get("trfm")&&!i.get("trfst")&&(m=m.replace(/,?trf,trfe,?/g,""),o.getParamsMapState.trafficControlEnabled=!0,o.getParamsMapState.exist=!0),p.hasOwnProperty(m)&&(o.getParamsMapState.type=p[m],o.getParamsMapState.exist=!0),o.defaultExportType=i.get("exportType"),e.hasMapType(o.defaultExportType)||(o.defaultExportType="default"),o.canOverrideConfig&&i.get("config")){var g;try{g=JSON.parse(i.get("config"))}catch(f){}g&&n(o,g)}o.ymaps&&o.ymaps.params&&(o.ymaps.params.csp=!0,o.ymaps.params["csp[style_nonce]"]=o.cspNonceKey),t(o)}function n(t,e){Object.keys(e).forEach(function(i){t[i]&&("object"==typeof e[i]?n(t[i],e[i]):t[i]=e[i])})}var s=document.getElementById("config");if(s){var r=JSON.parse(s.innerHTML);r.lang=r.i18n.lang,r.apiLangParam=r.i18n.apiLang,o(r)}else window.mockConfig&&o(window.mockConfig)}),modules.define("ymaps-map-types",function(t){var e=["interactiveScript","interactiveIframe","static","print"],i=e.concat();t({getMapTypes:function(){return i},hasMapType:function(t){return e.indexOf(t)>-1}})}),modules.define("util-get-params",[],function(t){for(var e,i=decodeURIComponent(window.location.search.substring(1)),o=i.split("&"),n={},s=0;s<o.length;s++)e=o[s].split("="),n[e[0]]=void 0===e[1]?!0:e[1];t({get:function(t){return n[t]}})}),modules.define("map-data-manager",["ymaps-api","ymaps-utils","rpc-client","config","vow","map-data-entry","map-data-meta-entry","map-data-default"],function(t,e,i,o,n,s,r,a,c){var l,d=c.defaultMapState,u={state:{center:[d.longitude,d.latitude],zoom:d.zoom,type:c.defaultMapType,trafficControlEnabled:d.trafficControlEnabled||!1,size:c.defaultContainerSize},properties:{access:"public",name:"",description:""}},h=e.util.defineClass(function(){this.events=new e.event.Manager,this._total=0,this._list=[],this._listItemCache={}},{getPreloadedMapEntry:function(){return l},duplicateMap:function(t){var e=s.defer();return o.getMapInfo(t).then(function(t){delete t.sid,t.properties.name=i.getClonedMapName(t.properties.name||"");var o=this.createEmptyMapEntry();
delete t.revision,o.applyData(t);var n=o.get("geoObjects");n.getAll().forEach(function(t){n.setSaveState(t,"create")}),e.resolve(o.save())},this).fail(this._fireErrorEvent,this),e.promise()},removeMap:function(t){var e=o.removeMap(t);return e.fail(this._fireErrorEvent,this),e.then(function(){return this._list.some(function(e,i){var o=t===e.get("sid");return o&&(--this._total,this._list.splice(i,1)),o},this),t},this).then(function(e){return this.events.fire("MAP_REMOVED",{sid:t}),e},this).then(this._fireListUpdatedEvent,this),e},getTotal:function(){return this._total},getLoadedList:function(){return this._list.concat()},getLoadedLength:function(){return this._list.length},getMapEntry:function(t,i){i=i||{};var n=o.getMapInfo(t);return i.ignoreErrors||n.fail(this._fireErrorEvent,this),n.then(function(t){if(i.useGetParams){var o=new r(t);return this._applyGetParams(o),this._createSaveStateListener(o)}return e.getZoomRange(t.state.type,t.state.center).then(function(e){return t.state.zoom=Math.min(t.state.zoom,e[1]),this._createSaveStateListener(new r(t))},function(){return this._createSaveStateListener(new r(t))},this)},this)},createEmptyMapEntry:function(){u.properties.timeUpdated=(new Date).getTime();var t=new r(u),e=t.createListener();return e.add("sid",function(i){var o=new a(t.getData().map);this._listItemCache[i]=o,this._total++,this._list.unshift(o),e.destroy(),this._createSaveStateListener(t),this._fireListUpdatedEvent()},this),t},loadNextPage:function(){if(this._nextPageRequest)return this._nextPageRequest;var t=this.getTotal(),e=this.getLoadedLength();return e&&e>=t?s.reject():(this._nextPageRequest=o.getMapsList(e,n.getMapsLimit),this._nextPageRequest.fail(this._fireErrorEvent,this).always(function(t){return this._nextPageRequest=null,t},this),this._nextPageRequest.then(this._processMapData,this).then(this._fireListUpdatedEvent,this))},_processMapData:function(t){this._total=t.totalCount;var e=[];return t.items.forEach(function(t){var i=new a(t);this._listItemCache[i.get("sid")]=i,e.push(i)},this),this._list=this._list.concat(e),e},_fireListUpdatedEvent:function(t){return this.events.fire("LIST_UPDATED"),t},_fireErrorEvent:function(t){return this.events.fire("NETWORK_ERROR",{error:t}),t},_createSaveStateListener:function(t){return t.createListener().add("saveState",function(e,i){var o=this._listItemCache[t.get("sid")],n=this._list.indexOf(o);o&&"saved"===e&&"saving"===i&&(n>0&&(this._list.splice(n,1),this._list.unshift(t),this._fireListUpdatedEvent()),o.applyData(t.getData().map))},this),t},_applyGetParams:function(t){var e={};n.getParamsMapState.center&&(e.center=[n.getParamsMapState.center.longitude,n.getParamsMapState.center.latitude]),n.getParamsMapState.zoom&&(e.zoom=n.getParamsMapState.zoom),n.getParamsMapState.type&&(e.type=n.getParamsMapState.type),t.set(e)}}),p=new h,m=[p.loadNextPage()],g=n.getParamsMapState.sid;g&&m.push(p.getMapEntry(g,{useGetParams:!0,ignoreErrors:!0}).then(function(t){return l=t})),s.allResolved(m).always(function(){t(p)})}),modules.define("ymaps-api",["ymaps-loader"],function(t,e){e.load().then(function(e){t(e)})}),modules.define("ymaps-loader",["config","jquery","loader_type_js","vow","ymaps-link"],function(t,e,i,o,n,s){function r(t){var e=n.defer();return t.modules.require(["theme.islands.geoObject.preset.pictogram.icons","geometryEditor.Menu"],function(i,o){t.pictogramIcons=i,t.geometryEditor.Menu=o,e.resolve(t)}),e.promise()}var a={load:function(t){var e=n.defer(),i=Number(new Date),s="callback"+i,c="ns"+i;return t=t||{},t.onload=s,t.ns=c,o(a.getLink(t)),window[s]=function(t){delete window[s],r(t).then(function(){e.resolve(t)},this)},e.promise()},getLink:function(t){return s(t)}};t(a)}),function(t){var e,i=function(){var e=[],i=function(t){return e.push(t),1===e.length},o=function(){var t=e,i=0,o=e.length;for(e=[];o>i;)t[i++]()};if("function"==typeof setImmediate)return function(t){i(t)&&setImmediate(o)};if("object"==typeof process&&process.nextTick)return function(t){i(t)&&process.nextTick(o)};var n=t.MutationObserver||t.WebKitMutationObserver;if(n){var s=1,r=document.createTextNode("");return new n(o).observe(r,{characterData:!0}),function(t){i(t)&&(r.data=s*=-1)}}if(t.postMessage){var a=!0;if(t.attachEvent){var c=function(){a=!1};t.attachEvent("onmessage",c),t.postMessage("__checkAsync","*"),t.detachEvent("onmessage",c)}if(a){var l="__promise"+Math.random()+"_"+new Date,d=function(t){t.data===l&&(t.stopPropagation&&t.stopPropagation(),o())};return t.addEventListener?t.addEventListener("message",d,!0):t.attachEvent("onmessage",d),function(e){i(e)&&t.postMessage(l,"*")}}}var u=t.document;if("onreadystatechange"in u.createElement("script")){var h=function(){var t=u.createElement("script");t.onreadystatechange=function(){t.parentNode.removeChild(t),t=t.onreadystatechange=null,o()},(u.documentElement||u.body).appendChild(t)};return function(t){i(t)&&h()}}return function(t){i(t)&&setTimeout(o,0)}}(),o=function(t){i(function(){throw t})},n=function(t){return"function"==typeof t},s=function(t){return null!==t&&"object"==typeof t},r=Object.prototype.toString,a=Array.isArray||function(t){return"[object Array]"===r.call(t)},c=function(t){for(var e=[],i=0,o=t.length;o>i;)e.push(i++);return e},l=Object.keys||function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i);return e},d=function(t){var e=function(e){this.name=t,this.message=e};return e.prototype=new Error,e},u=function(t,e){return function(i){t.call(this,i,e)}},h=function(){this._promise=new m};h.prototype={promise:function(){return this._promise},resolve:function(t){this._promise.isResolved()||this._promise._resolve(t)},reject:function(t){this._promise.isResolved()||(_.isPromise(t)?(t=t.then(function(t){var e=_.defer();return e.reject(t),e.promise()}),this._promise._resolve(t)):this._promise._reject(t))},notify:function(t){this._promise.isResolved()||this._promise._notify(t)}};var p={PENDING:0,RESOLVED:1,FULFILLED:2,REJECTED:3},m=function(t){if(this._value=e,this._status=p.PENDING,this._fulfilledCallbacks=[],this._rejectedCallbacks=[],this._progressCallbacks=[],t){var i=this,o=t.length;t(function(t){i.isResolved()||i._resolve(t)},o>1?function(t){i.isResolved()||i._reject(t)}:e,o>2?function(t){i.isResolved()||i._notify(t)}:e)}};m.prototype={valueOf:function(){return this._value},isResolved:function(){return this._status!==p.PENDING},isFulfilled:function(){return this._status===p.FULFILLED},isRejected:function(){return this._status===p.REJECTED},then:function(t,e,i,o){var n=new h;return this._addCallbacks(n,t,e,i,o),n.promise()},"catch":function(t,i){return this.then(e,t,i)},fail:function(t,i){return this.then(e,t,i)},always:function(t,e){var i=this,o=function(){return t.call(this,i)};return this.then(o,o,e)},progress:function(t,i){return this.then(e,e,t,i)},spread:function(t,e,i){return this.then(function(e){return t.apply(this,e)},e,i)},done:function(t,e,i,n){this.then(t,e,i,n).fail(o)},delay:function(t){var e,i=this.then(function(i){var o=new h;return e=setTimeout(function(){o.resolve(i)},t),o.promise()});return i.always(function(){clearTimeout(e)}),i},timeout:function(t){var e=new h,i=setTimeout(function(){e.reject(new _.TimedOutError("timed out"))},t);return this.then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise().always(function(){clearTimeout(i)}),e.promise()},_vow:!0,_resolve:function(t){if(!(this._status>p.RESOLVED)){if(t===this)return void this._reject(TypeError("Can't resolve promise with itself"));if(this._status=p.RESOLVED,t&&t._vow)return void(t.isFulfilled()?this._fulfill(t.valueOf()):t.isRejected()?this._reject(t.valueOf()):t.then(this._fulfill,this._reject,this._notify,this));if(s(t)||n(t)){var e;try{e=t.then}catch(i){return void this._reject(i)}if(n(e)){var o=this,r=!1;try{e.call(t,function(t){r||(r=!0,o._resolve(t))},function(t){r||(r=!0,o._reject(t))},function(t){o._notify(t)})}catch(i){r||this._reject(i)}return}}this._fulfill(t)}},_fulfill:function(t){this._status>p.RESOLVED||(this._status=p.FULFILLED,this._value=t,this._callCallbacks(this._fulfilledCallbacks,t),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=e)},_reject:function(t){this._status>p.RESOLVED||(this._status=p.REJECTED,this._value=t,this._callCallbacks(this._rejectedCallbacks,t),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=e)},_notify:function(t){this._callCallbacks(this._progressCallbacks,t)},_addCallbacks:function(t,i,o,s,r){o&&!n(o)?(r=o,o=e):s&&!n(s)&&(r=s,s=e);var a;this.isRejected()||(a={defer:t,fn:n(i)?i:e,ctx:r},this.isFulfilled()?this._callCallbacks([a],this._value):this._fulfilledCallbacks.push(a)),this.isFulfilled()||(a={defer:t,fn:o,ctx:r},this.isRejected()?this._callCallbacks([a],this._value):this._rejectedCallbacks.push(a)),this._status<=p.RESOLVED&&this._progressCallbacks.push({defer:t,fn:s,ctx:r})},_callCallbacks:function(t,e){var o=t.length;if(o){var n=this.isResolved(),s=this.isFulfilled(),r=this.isRejected();i(function(){for(var i,a,c,l=0;o>l;)if(i=t[l++],a=i.defer,c=i.fn){var d,u=i.ctx;try{d=u?c.call(u,e):c(e)}catch(h){a.reject(h);continue}n?a.resolve(d):a.notify(d)}else s?a.resolve(e):r?a.reject(e):a.notify(e)})}}};var g={cast:function(t){return _.cast(t)},all:function(t){return _.all(t)},race:function(t){return _.anyResolved(t)},resolve:function(t){return _.resolve(t)},reject:function(t){return _.reject(t)}};for(var f in g)g.hasOwnProperty(f)&&(m[f]=g[f]);var _={Deferred:h,Promise:m,defer:function(){return new h},when:function(t,e,i,o,n){return _.cast(t).then(e,i,o,n)},fail:function(t,i,o){return _.when(t,e,i,o)},always:function(t,e,i){return _.when(t).always(e,i)},progress:function(t,e,i){return _.when(t).progress(e,i)},spread:function(t,e,i,o){return _.when(t).spread(e,i,o)},done:function(t,e,i,o,n){_.when(t).done(e,i,o,n)},isPromise:function(t){return s(t)&&n(t.then)},cast:function(t){return t&&t._vow?t:_.resolve(t)},valueOf:function(t){return t&&n(t.valueOf)?t.valueOf():t},isFulfilled:function(t){return t&&n(t.isFulfilled)?t.isFulfilled():!0},isRejected:function(t){return t&&n(t.isRejected)?t.isRejected():!1},isResolved:function(t){return t&&n(t.isResolved)?t.isResolved():!0},resolve:function(t){var e=_.defer();return e.resolve(t),e.promise()},fulfill:function(t){var e=_.defer(),i=e.promise();return e.resolve(t),i.isFulfilled()?i:i.then(null,function(t){return t})},reject:function(t){var e=_.defer();return e.reject(t),e.promise()},invoke:function(e){var i,o=Math.max(arguments.length-1,0);if(o){i=Array(o);for(var n=0;o>n;)i[n++]=arguments[n]}try{return _.resolve(i?e.apply(t,i):e.call(t))}catch(s){return _.reject(s)}},all:function(t){var e=new h,i=a(t),o=i?c(t):l(t),n=o.length,s=i?[]:{};if(!n)return e.resolve(s),e.promise();var r=n;return _._forEach(t,function(t,i){s[o[i]]=t,--r||e.resolve(s)},e.reject,e.notify,e,o),e.promise()},allResolved:function(t){var e=new h,i=a(t),o=i?c(t):l(t),n=o.length,s=i?[]:{};if(!n)return e.resolve(s),e.promise();var r=function(){--n||e.resolve(t)};return _._forEach(t,r,r,e.notify,e,o),e.promise()},allPatiently:function(t){return _.allResolved(t).then(function(){var e,i,o,n,s=a(t),r=s?c(t):l(t),d=r.length,u=0;if(!d)return s?[]:{};for(;d>u;)o=r[u++],n=t[o],_.isRejected(n)?(e||(e=s?[]:{}),s?e.push(n.valueOf()):e[o]=n.valueOf()):e||((i||(i=s?[]:{}))[o]=_.valueOf(n));if(e)throw e;return i})},any:function(t){var e=new h,i=t.length;if(!i)return e.reject(Error()),e.promise();var o,n=0;return _._forEach(t,e.resolve,function(t){n||(o=t),++n===i&&e.reject(o)},e.notify,e),e.promise()},anyResolved:function(t){var e=new h,i=t.length;return i?(_._forEach(t,e.resolve,e.reject,e.notify,e),e.promise()):(e.reject(Error()),e.promise())},delay:function(t,e){return _.resolve(t).delay(e)},timeout:function(t,e){return _.resolve(t).timeout(e)},_forEach:function(t,e,i,o,n,s){for(var r=s?s.length:t.length,a=0;r>a;)_.when(t[s?s[a]:a],u(e,a),i,o,n),++a},TimedOutError:d("TimedOut")},b=!0;"object"==typeof module&&"object"==typeof module.exports&&(module.exports=_,b=!1),"object"==typeof modules&&n(modules.define)&&(modules.define("vow",function(t){t(_)}),b=!1),"function"==typeof define&&(define(function(t,e,i){i.exports=_}),b=!1),b&&(t.vow=_)}("undefined"!=typeof window?window:global),modules.define("ymaps-link",["config","jquery"],function(t,e,i){t(function(t){var o=e.ymaps||{},n=o.params||{};t=i.extend({},n,t)||n,t.lang=t.lang||e.apiLangParam,t.coordorder=t.coordorder||e.apiCoordorderParam;var s=(o.enterprise?e.hosts.enterprise:e.hosts.mapsapi)+o.version,r=!0;delete t.enterprise;for(var a in t)t.hasOwnProperty(a)&&(s+=(r?(r=!1,"?"):"&")+a+"="+t[a]);return s})}),modules.define("ymaps-utils",["ymaps-api","util-string","i18n-plus","config"],function(t,e,i,o,n){var s=o("sidebar","noname"),r=o("map-selection","copy"),a=o("map-selection","no-name-map"),c=r.split(" %");t({getGeoObjectCenter:function(t){return e.util.bounds.getCenter(t.geometry.getBounds())},getObjectCaption:function(t){var e=t.description&&i.strip(t.description);return e=e?e.replace(/\n/g,""):s,t.iconCaption&&(e="("+t.iconCaption+") "+e),e.length>70&&(e=e.substr(0,70)),e},getClonedMapName:function(t){if(t||(t=a),0===t.indexOf(c[0])){var e=t.indexOf(c[0])+c[0].length,i=t.indexOf(")"),o=Number(t.substr(e,i-e))||1;t=r.replace("%",o+1)+" "+t.substr(i+2)}else t=r.replace(" %","")+" "+t;return t=t.substr(0,n.limits.size.mapName)},getBoundingRect:function(t){var e;if("Point"===t.geometry.getType()){var i=t.getOverlaySync();if(i){var o=i.getLayoutSync();if(o){var n=o.getShape();if(n&&(e=n.getBounds())){var s=t.geometry.getPixelGeometry().getCoordinates();e=[[e[0][0]+s[0],e[0][1]+s[1]],[e[1][0]+s[0],e[1][1]+s[1]]]}}}}else e=t.geometry.getPixelGeometry().getBounds();return e},createCanceableCallback:function(t,e){var i=function(){if(t){var i=arguments,o=i.length;0===o?t.call(e):1===o?t.call(e,i[0]):2===o?t.call(e,i[0],i[1]):t.apply(e,i)}};return i.cancel=function(){t=e=null},i.isActive=function(){return!Boolean(t)},i},isNonExportableMap:function(t){var e=null;return"yandex#map"!==t.get("type")&&(e="map"),t.get("zoom")<4&&(e="zoom"),e},isInteractiveType:function(t){return t&&-1!==t.indexOf("interactive")}})}),modules.define("util-string",["jquery"],function(t,e){var i,o=new RegExp("[\\u0000-\\u0008\\u000b\\u000c\\u000e-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]","g");t({removeUtfMagic:function(t){return t.replace(o,"")},strip:function(t){return i||(i=document.createElement("DIV")),i.innerHTML=t,i.textContent||i.innerText||""},escape:function(t){return e("<div/>").text(t).html()}})}),modules.define("i18n-plus",["y-i18n","config"],function(t,e,i){function o(t,o,n){var r=e(t,o);return r&&(n||(n={}),n.tld=i.tld,Object.keys(n).sort().forEach(function(t){r="$"===t[0]?s[t.slice(1)](n,r):r.split("{"+t+"}").join(n[t])})),r}var n={en:",",tr:".",ru:" ",ua:" "}[i.lang]||" ",s={conjugate:function(t,e){var i=t.$conjugate,o=i%10>=2&&4>=i%10?1:i%10===1?0:3;return e.split(" / ")[o]},innerConjugate:function(t,e){var i=t.$innerConjugate,o=i%10>=2&&4>=i%10?1:i%10===1?0:3,n=e.replace("]","[").split("[");return n[0]+n[1].split(" / ")[o]+n[2]},thousands:function(t,e){return t.$thousands.forEach(function(e){var i=t[e];i=String(i),i=Array.prototype.map.call(i,function(t,e){return(i.length-e)%3===0?n+t:t}).join(""),t[e]=i[0]===n?i.substr(1):i}),e}};o.conjugate=function(t,e){var i=String(o.processThousands(e)),n=e%10>=2&&4>=e%10?1:e%10===1?0:3;return t[n].replace("{num}",i)},o.conjugateKey=function(t,e,i){return o.conjugate(o(t,e).split(" / "),i)},o.processThousands=function(t){return t=String(t),t=[].map.call(t,function(e,i){return(t.length-i)%3===0?n+e:e}).join(""),t[0]===n?t.substr(1):t},t(o)}),modules.define("rpc-client",["jquery","vow","config","yametrika","map-data-default"],function(t,e,i,o,n,s){function r(t){var e=s.defaultContainerSize;return["available"===t[0]?e[0]:t[0],"available"===t[1]?e[1]:t[1]]}function a(){return e.ajax({cache:!1,type:"GET",url:o.hosts.passport+"auth/update/",xhrFields:{withCredentials:!0}})}var c=18e4,l=o.csrfToken,d=0,u={"Need reset":function(t){t.options.secondAuthRequest?t.deferred.reject(t.error):a().always(e.proxy(function(){t.options.secondAuthRequest=!0,t.deferred.resolve(this._makeRequest(t.action,t.data,t.options))},this))},"Invalid user":function(t){d++,n.reachGoalOnce("ERROR_USER"),t.deferred.reject(t.error)},"Need to repeat the request":function(t){var e=t.error.getResponseHeader("x-csnt-sk");e&&!t.options.secondCSRFRequest?(n.reachGoalOnce("ERROR_CSRF"),l=e,t.options.secondCSRFRequest=!0,t.deferred.resolve(this._makeRequest(t.action,t.data,t.options)),t.deferred.promise().then(function(){n.reachGoalOnce("NEW_CSRF_SUCCESS")},function(){n.reachGoalOnce("NEW_CSRF_ERROR")})):t.deferred.reject(t.error)}};t({getMapsList:function(t,e){return this._makeRequest("map-list",{offset:t,limit:e||o.getMapsLimit}).then(function(t){return t.items.forEach(function(t){t.revision=t.properties.revision}),t})},getMapInfo:function(t){return this._makeRequest("get-map",{sid:t}).then(function(e){var i=e.maps[0];return i.presetStorage=e.presetStorage,i.sid=t,i.revision=i.properties.revision,i.geoObjects=i.geoObjects.features,i.properties.timeUpdated=i.properties.updated,i.state.trafficControlEnabled=i.state.traffic&&i.state.traffic.shown,i.geoObjects.forEach(function(t){t.properties.serverId=t.id,t.properties.description=t.properties.name},this),i.geoObjects.sort(function(t,e){return t.options.order-e.options.order}),i})},checkMapOwner:function(t){return this.getMapInfo(t)},saveMap:function(t){var e=t.getData().map,i=e.sid,o=i?"update-map":"create-map",n={map:JSON.stringify({properties:{name:e.properties.name,description:e.properties.description,access:e.properties.access},state:{center:e.state.center,zoom:e.state.zoom,type:e.state.type,trafficControlEnabled:e.state.trafficControlEnabled,size:r(e.state.size)},options:{},revision:e.revision})};return i&&(n.sid=i),this._makeRequest(o,n)},bulkGeoObjectsSave:function(t,e){return this._makeRequest("bulk-update",{sid:t.get("sid"),bulk:JSON.stringify({revision:t.get("revision"),operations:e})})},removeMap:function(t){return this._makeRequest("delete-map",{sid:t})},duplicateMap:function(t){var e=i.defer();return this.getMapInfo(t).then(function(t){e.resolve(this.createMap(t))},function(t){e.reject(t)},this),e.promise()},_makeRequest:function(t,s,r){var a=i.defer();if(o.user.isUserAuthorized){var h=(o.hosts.proxy||o.baseURL)+"proxy/",p=e.extend({csrfToken:l,action:t},s);p.uid=o.user.id,r=r||{},e.ajax({success:function(t){a.resolve(t),d>0&&n.reachGoalOnce("ERROR_USER_RESOLVE")},error:e.proxy(function(e){var i=e.responseText;u.hasOwnProperty(i)?u[i].call(this,{error:e,deferred:a,action:t,data:s,options:r}):a.reject(e)},this),cache:!1,data:p,type:"POST",dataType:"json",url:h,xhrFields:{withCredentials:!0}});var m=window.setTimeout(function(){a.reject({})},c);a.promise().always(function(){m&&(window.clearTimeout(m),m=0)})}else a.reject({});return a.promise()}})}),modules.define("yametrika",["loader_type_js","config","ymaps-utils","util-timer"],function(t,e,i,o,n){function s(t){var e,i=Math.round(t/1e3);for(var o in b)if(e=o,b[o]>i)break;return e}function r(){d.listener&&d.listener.removeAll(),d=null}function a(t){return new Ya.Metrika({id:t,trackLinks:!0,accurateTrackBounce:!0,clickmap:!0})}var c,l,d,u=!1,h=[],p=[],m={},g={";":"csv_sc",",":"csv_c","	":"csv_tab"},f={point:"placemark",linestring:"line",polygon:"polygon"},_={start:function(){d={timer:n.create()}},analyseStart:function(){d.timer.start()},analyse:function(t){d.timer.pause(),d.type=t.type,d.total=t.meta.total,d.valid=t.meta.point+t.meta.linestring+t.meta.polygon,this.params({cnstImportFileInfo:t.type,cnstImportFileInfoAll:[t.type,t.meta.total,d.valid,t.meta.point,t.meta.linestring,t.meta.polygon].join(".")})},analyseError:function(t){this.params({cnstImportFailError:t.code,cnstImportFailAll:[t.code,t.type,s(d.timer.pause())].join(".")}),r()},importStart:function(){d.timer.start()},"import":function(t,e){this.params({cnstImportTime:s(d.timer.pause())}),e.get("sid")?this.import("save",t,e):d.listener=e.createListener().add("sid",function(i){i&&this.import("save",t,e)},this)},importLimits:function(t){var e;t.limitVerticesReached&&t.limitObjectsReached?e="both":t.limitVerticesReached?e="vertex":t.limitObjectsReached&&(e="geoObjects"),e&&this.params({cnstImportLimits:e})},importError:function(t){this.params({cnstImportFailError:t.code,cnstImportFailAllcnstImportFromExport:[t.code,t.type,s(d.timer.pause())].join(".")}),r()},save:function(t,e){var i={cnstImportSuccessAll:[e.get("sid"),d.type,d.valid,s(d.timer.pause())].join(".")};t.fromConstructor&&(i.cnstImportFromExport=[e.get("sid"),t.type].join(".")),this.params(i),r()},cancel:function(t){this.params({cnstImportCancel:t,cnstImportCancelAll:[t,d.type,d.total||"0",s(d.timer.pause())].join(".")}),r()}},b={"0-5":5,"6-10":10,"11-30":30,"31-60":60,"61-180":180,"181-300":300,"301-600":600,"601-1200":1200,"1201-1800":1800,"1801+":99999999},v={reachGoal:function(t,e){u?p.forEach(function(i){i.reachGoal(t,e)}):h.push({type:"reachGoal",args:[t,e]})},reachGoalOnce:function(t,e){p.length&&!m[t]&&(m[t]=!0,this.reachGoal(t,e))},params:function(t){u?p.forEach(function(e){e.params(t)}):h.push({type:"params",args:[t]})},clickCode:function(t){var e=t.get("mapType").toUpperCase();e.indexOf("INTERACTIVE")>=-1&&(e="INTERACTIVE"),this.reachGoal("CLICK_CODE_"+e)},hotkeyUsedTool:function(t){this.reachGoal("HOTKEY_USED",{cnstHotKeyUsed:"tool_"+f[t]})},hotkeyUsed:function(t){this.reachGoal("HOTKEY_USED",{cnstHotKeyUsed:t})},exportDataStart:function(t){this.reachGoal("CLICK_EXPORT",{cnstExportSave:t?"yadisk":"device"})},exportDataSuccess:function(t,e){var i=t.type,o=t.saveToDisk;l!==t.sid&&(c=[],l=t.sid),c.unshift("csv"===i?g[t.separator]:i);var n=[i,e,t.objectCount,t.sid].join("."),s={cnstExportDataSuccess:(o?"yadisk":"device")+"."+i,cnstExportDataSuccessAll:n,cnstExportSessionHistory:c.join(".")+"."+t.sid};t.importFormat&&(s.cnstImportToConvert=[t.importFormat,t.type].join(".")),this.params(s)},exportDataFail:function(t,e){var i=t.type,o=t.saveToDisk,n=["csv"===i?g[t.separator]:i,t.sid,e.objectCount];e.fileSize&&n.push(e.fileSize),this.params({cnstExportDataFail:[o?"yadisk":"device",e.status?e.status:0].join("."),cnstExportDataFailAll:n.join(".")})},clickPrint:function(t){var e=t.get("sid"),n=!Boolean(o.isNonExportableMap(t));this.reachGoal("CLICK_PRINT",{cnstPrintAll:[e,i.canExportMap,n].join(","),cnstPrintExportEnabled:i.canExportMap,cnstPrintMapExportable:n})},saveImage:function(t,e){var i=t.get("imageExportScale"),o=t.get("imageExportFileType"),n=t.get("containerSize"),s=1===i?96:300,r=[t.get("sid"),t.get("imageExportScale"),t.get("imageExportFileType"),t.get("containerSize")].join(","),a=Math.ceil(n[0]/500),c=Math.ceil(n[1]/500);this.reachGoal("SAVE_PRINTABLE",{cnstPrintableSave:e?"yadisk":"device",cnstPrintableParamsDpi:s,cnstPrintableParamsScale:i,cnstPrintableParamsExtension:o,cnstPrintableParamsWidthGroup:500*(a-1)+"-"+500*a,cnstPrintableParamsHeightGroup:500*(c-1)+"-"+500*c,cnstPrintableParamsAll:r})},saveImageError:function(t,e){this.params({cnstExportPrintableSaveError:[e?"yadisk":"device",t.status?t.status:0].join(".")})},changeGeoObjectZIndex:function(t,e){this.reachGoal("CHANGE_GEOOBJECT_ZINDEX",{cnstChangeZIndexType:e,cnstChangeZIndexAll:[i.user.id,t.get("sid"),e].join(".")})},logBulkSaveError:function(t,e){this.reachGoal("BULK_SAVE_ERROR",{cnstBulkError:[e.step,e.totalSteps,t.get("sid")].join(".")})},mapSelection:function(t){this.reachGoal(t.id?"FROM_"+(0===t.id.indexOf("mymaps")?"MYMAPS":"CONSTRUCTOR"):"CLICK_CREATE")},"import":function(t){_[t]&&("start"===t||d)&&(_[t].apply(this,Array.prototype.slice.call(arguments,1)),d&&(d.lastStep=t))},printScreen:function(t){this.params({clickPrntScrn:[t.get("sid"),t.get("geoObjects").getLength()].join(".")})}};t(v),i.yametrika&&i.yametrika.id&&(window.yandex_metrika_callbacks=[function(){i.yametrika.id.map(function(t){return p.push(a(t)),!0}),u=!0,h.forEach(function(t){v[t.type].apply(v,t.args)})}],e("https://mc.yandex.ru/metrika/watch.js"))}),modules.define("util-timer",[],function(t){function e(){return Number(new Date)}t({create:function(){var t,i=!0,o=0;return{start:function(){t=e(),i=!1},pause:function(){return i||(o=this.getValue(),i=!0),o},getValue:function(){return o+(i?0:e()-t)}}}})}),modules.define("map-data-default",["ymaps-api","config","vow"],function(t,e,i,o){var n={ru_RU:{longitude:37.588628,latitude:55.734046,zoom:10},tr_TR:{longitude:28.97256128,latitude:41.01745111,zoom:13},ru_UA:{longitude:30.53063006,latitude:50.44713741,zoom:12},uk_UA:{longitude:30.53063006,latitude:50.44713741,zoom:12},en_RU:{longitude:37.588628,latitude:55.734046,zoom:10},en_US:{longitude:37.588628,latitude:55.734046,zoom:10}},s=[],r={};if(r.getDefaultMapOptions=function(t){var e=t.templateLayoutFactory.createClass("{{ properties.iconContent }}",{build:function(){e.superclass.build.call(this);var t=this.getData().properties.get("iconContent");if(t&&String(t).length>2){var i=this.getElement();i.style.fontSize="9px",i.style.lineHeight="16px",i.style.display="block"}}});return{avoidFractionalZoom:!0,geoObjectStrokeOpacity:1,geoObjectFillOpacity:1,geoObjectStrokeColor:"ed4543e6",geoObjectStrokeWidth:5,geoObjectFillColor:"ed454399",geoObjectBalloonContentLayout:t.templateLayoutFactory.createClass("{{ properties.description|raw }}"),geoObjectIconContentLayout:e,yandexMapDisablePoiInteractivity:!0,geoObjectZIndexActive:Math.pow(10,9)+10,geoObjectZIndexHover:Math.pow(10,9)+9}},e.option.presetStorage.add("cnst#defaultPreset",{strokeColor:"ed4543e6",fillColor:"ed454399",strokeWidth:5}),r.defaultMapOptions=r.getDefaultMapOptions(e),r.innerSelectionStyle={strokeColor:"000",opacity:.5,strokeWidth:2,fillColor:"00000000",pane:"selection",interactive:!1},r.outerSelectionStyle={strokeColor:"FFF",opacity:.8,strokeWidth:4,fillColor:"00000000",pane:"selection",interactive:!1},i.user.location)r.defaultMapState={latitude:i.user.location.latitude,longitude:i.user.location.longitude,zoom:10};else{var a=n.hasOwnProperty(i.apiLangParam)?i.apiLangParam:"ru_RU";r.defaultMapState=n[a]}r.defaultMapType="yandex#map",i.getParamsMapState.center&&(r.defaultMapState.latitude=i.getParamsMapState.center.latitude,r.defaultMapState.longitude=i.getParamsMapState.center.longitude),i.getParamsMapState.type&&(r.defaultMapType=i.getParamsMapState.type),i.getParamsMapState.trafficControlEnabled&&(r.defaultMapState.trafficControlEnabled=i.getParamsMapState.trafficControlEnabled),i.getParamsMapState.zoom&&(r.defaultMapState.zoom=i.getParamsMapState.zoom,s.push(e.getZoomRange(r.defaultMapType,[r.defaultMapState.longitude,r.defaultMapState.latitude]).then(function(t){var e=r.defaultMapState.zoom;return e=Math.min(e,t[1]),e=Math.max(e,t[0]),r.defaultMapState.zoom=e,t}))),r.defaultContainerSize=[500,400];var c={min:[320,240],max:[1280,720]};r.minMaxSize={interactiveIframe:c,interactiveScript:c,"static":{min:[150,150],max:[600,450]},print:{min:[200,200],max:[1500,1500]}},r.disabledGeoObjectCollection={geoObjectInteractivityModel:"default#transparent",geoObjectOpenBalloonOnClick:!1,geoObjectCursor:"grab"},r.enableGeoObjectCollection={geoObjectInteractivityModel:"default#transparent",geoObjectOpenBalloonOnClick:!0,geoObjectCursor:"pointer"},0===s.length?t(r):o.all(s).always(function(){t(r)})}),modules.define("map-data-entry",["map-data-meta-entry","config","ymaps-api","map-data-default","map-data-geoObjects-provider","map-data-bulk-update","ymaps-utils","vow","rpc-client","ymaps-preset-utils","jquery"],function(t,e,i,o,n,s,r,a,c,l,d,u){var h="default"===i.defaultExportType?"interactiveScript":i.defaultExportType,p=h,m=o.util.defineClass(function(t){m.superclass.constructor.call(this,t),this.set({geoObjectsWithBalloonIds:[],activeGeoObjectsIds:[],focusedGeoObjectsIds:[]}),this.get("geoObjects").events.add(["geoObjectsAdd","geoObjectsUpdate","geoObjectsRemove","geoObjectReorder"],function(){this.set({saveState:"unsaved",geoObjectsSaveState:"unsaved"})},this),this._setPreviewError(),this.createListener().add(["type","zoom"],this._setPreviewError,this),this.createListener().add("mapType",function(t){p=t,this._setPreviewError()},this),"default"===i.defaultExportType&&a.isInteractiveType(p)||(p=h),this.set("mapType",p),this.createListener().add("saveState",function(t){"saved"===t&&this.set({geoObjectsWithBalloonIds:[],activeGeoObjectsIds:[],focusedGeoObjectsIds:[],geoObjectsSaveState:"saved"})},this).add(["center","zoom","type","trafficShown","mapName","mapDescription"],function(){this.set("saveState","unsaved")},this).add("mapType",function(t){var e=n.minMaxSize[t];this.set({minContainerSize:e.min,maxContainerSize:e.max})},this).add("containerSize",function(t){a.isInteractiveType(this.get("mapType"))&&this.set("interactiveContainerSize",t),this.set("saveState","unsaved")},this)},e,{save:function(t){function e(t,e,i){d=t,n.notify({step:t,total:a,type:e,left:i})}function i(t){t=t||{},t.step=d,t.totalSteps=a,n.reject(t)}var n=c.defer();t=o.util.extend({updateRevision:!0},t),this.set("saveState","saving"),this.set("access","public");var s=r.create(this),a=s.totalSteps+1;setTimeout(function(){e(0)},0),l.saveMap(this).then(function(t){this.set({sid:t.sid,revision:t.revision,timeUpdated:t.properties.timeUpdated}),e(1),a>1?s.make().then(function(){n.resolve(),this.set("saveState","saved")},i,function(t){e(t.step,t.type,t.left)},this):(n.resolve(),this.set("saveState","saved"))},function(e){var o=this.get("sid");409===e.status&&o&&t.updateRevision?l.getMapInfo(this.get("sid")).then(function(t){this.set("revision",t.revision),n.resolve(this.save({updateRevision:!1}))},i,this):i(e)},this);var d=0;return n.promise()},applyData:function(t){if(m.superclass.applyData.call(this,t),!this.get("geoObjects")){var e=new s([],{limit:i.limits.count.geoObjects});this.set("geoObjects",e),this._setGeoObjectsDataProviderListeners()}d.fillPresetStorage(t);var o={imageExportFileType:"png",imageExportScale:1,imageExportSizeType:"px",mapType:h,saveState:"saved"},r=n.minMaxSize[o.mapType];o.minContainerSize=r.min,o.maxContainerSize=r.max,o.centerClientOffset=[0,0];var a=this.get("containerSize");o.containerSize=[],o.containerSize[0]=Math.max(Math.min(a[0],r.max[0]),r.min[0]),o.containerSize[1]=Math.max(Math.min(a[1],r.max[1]),r.min[1]),this.set(o),t.geoObjects&&this.get("geoObjects").fill(t.geoObjects)},getData:function(){function t(t){var i=u.extend(!0,{type:"Feature"},t);n.push(i);var r=i.options&&i.options.preset;if(r&&-1===r.indexOf("#")){var a=(s?s+"#":"#")+r,c=u.extend(!0,{},o.option.presetStorage.get(r));for(var l in c)c.hasOwnProperty(l)&&(c[l]=String(c[l]));e[a]=c,i.options.preset=a}i.properties.iconContent&&(i.properties.iconContent=i.properties.iconContent.toString())}var e={},i=this.get("geoObjects"),n=[],s=this.get("sid");i.getByType("point").forEach(t,this),i.getByType("linestring").forEach(t,this),i.getByType("polygon").forEach(t,this);var r=m.superclass.getData.call(this);return r.geoObjects={type:"FeatureCollection",features:n},{presetStorage:e,map:r}},_setPreviewError:function(){var t=null,e=this.get("mapType");"print"===e&&(t=i.canExportMap?a.isNonExportableMap(this):"browser"),"interactiveIframe"===e&&(t=a.isNonExportableMap(this)),this.set("previewError",{code:t,mapPreview:-1===["zoom","browser"].indexOf(t)})},_setGeoObjectsDataProviderListeners:function(){function t(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}this.get("geoObjects").events.group().add("geoObjectsRemove",function(e){var i=this.get("focusedGeoObjectsIds").slice(),o=this.get("activeGeoObjectsIds").slice(),n=this.get("geoObjectsWithBalloonIds").slice();e.get("geoObjectsData").forEach(function(e){var s=e.id;t(i,s),t(o,s),t(n,s)},this),this.set({focusedGeoObjectsIds:i,activeGeoObjectsIds:o,geoObjectsWithBalloonIds:n})},this)}});t(m)}),modules.define("map-data-meta-entry",["data-provider","ymaps-api","util-string"],function(t,e,i,o){var n=i.util.defineClass(function(t){n.superclass.constructor.call(this,{}),this.applyData(t)
},e,{applyData:function(t){var e={};e.sid=t.sid,e.revision=t.revision,e.mapName=t.properties.name,e.mapDescription=t.properties.description,e.access=t.properties.access||"public",e.timeUpdated=t.properties.timeUpdated,e.center=t.state.center,e.zoom=t.state.zoom,e.type=t.state.type,e.containerSize=e.interactiveContainerSize=t.state.size,e.trafficShown=t.state.trafficControlEnabled,this.set(e)},getData:function(){var t={type:this.get("type"),zoom:this.get("zoom"),size:this.get("interactiveContainerSize"),center:this.get("center")},e=this.get("centerClientOffset");if(e){var n=i.projection.wgs84Mercator,s=this.get("zoom"),r=n.toGlobalPixels(this.get("center"),s);r[0]+=e[0],r[1]+=e[1],t.center=n.fromGlobalPixels(r,s)}return t.trafficControlEnabled=this.get("trafficShown",!1),{sid:this.get("sid"),revision:this.get("revision"),properties:{name:o.removeUtfMagic(this.get("mapName")),description:o.removeUtfMagic(this.get("mapDescription")),access:this.get("access"),timeUpdated:this.get("timeUpdated")},state:t,options:{}}}});t(n)}),modules.define("data-provider",["ymaps-api"],function(t,e){function i(t,e){var o=Object.prototype.toString.call(t),n=Object.prototype.toString.call(e);if(o===n)switch(o){case"[object Array]":case"[object Object]":var s=Object.keys(t),r=Object.keys(e);return s.length!==r.length?!1:s.every(function(o){return i(t[o],e[o])});default:return t===e}return!1}var o=function(t){this._dataManager=new e.data.Manager(t)};o.prototype.set=function(t,e,i){return(i||this._isValueChanged(t,e))&&this._dataManager.set(t,e),this},o.prototype.unset=function(t){return this._dataManager.unset(t),this},o.prototype.get=function(t,e){return this._dataManager.get(t,e)},o.prototype.createListener=function(){return new e.Monitor(this._dataManager)},o.prototype.destroy=function(){return this._dataManager=null,this},o.prototype._isValueChanged=function(t,e){return!i(this.get(t),e)},t(o)}),modules.define("map-data-geoObjects-provider",["ymaps-api","ymaps-utils","ymaps-preset-utils","ymaps-calc-area","util-id","config","jquery","ymaps-zIndex"],function(t,e,i,o,n,s,r,a,c){function l(t){var i=e.projection.wgs84Mercator.getCoordSystem(),o=0,n=t.length;return t.forEach(function(e,s){s!==n-1&&(o+=i.getDistance(e,t[s+1]))}),o}var d=["delete","create","update","update_metadata","update_geometry"],u=e.util.defineClass(function(t,i){this.events=new e.event.Manager,this._dataById={},this._saveStateById={},this._removedGeoObjects=[],this._serverIdByLocal={},this._options=i||{},this._geoObjectsByType={point:[],linestring:[],polygon:[]},t&&this.fill(t)},{fill:function(t){t.forEach(function(t){this._getCollection(t).push(this._processGeoObject(t)),this._serverIdByLocal[t.properties.geoObjectId]=t.properties.serverId},this)},get:function(t){return this._dataById[t]},getLength:function(){return this.getByType("point").length+this.getByType("linestring").length+this.getByType("polygon").length},canAddGeoObject:function(){return!this._options.limit||this.getLength()<this._options.limit},getAll:function(){return[].concat(this.getByType("point"),this.getByType("linestring"),this.getByType("polygon"))},getUnsavedGeoObjects:function(){var t=[];return this.getAll().concat(this._removedGeoObjects).forEach(function(e){var i=this._saveStateById[this._getGeoObjectId(e)];i&&t.push({saveState:i,data:e})},this),t},clearUnsaveUnsavedGeoObjects:function(t){t.forEach(function(t){"delete"===this._saveStateById[t]?delete this._serverIdByLocal[t]:this._serverIdByLocal[t]=this._dataById[t].properties.serverId,delete this._saveStateById[t]},this)},getByType:function(t){return this._geoObjectsByType[t]},getIndex:function(t){var e=this.get(t);return e?this._getCollection(e).indexOf(e):void 0},getCollection:function(t){var e=this.get(t);return e?this._getCollection(e):void 0},addGeoObjects:function(t,e){var i=[];return t.forEach(function(t){if(this.canAddGeoObject()||e){t.properties&&t.properties.geoObjectId&&(this._removedGeoObjects=this._removedGeoObjects.filter(function(e){return e.properties.geoObjectId!==t.properties.geoObjectId}));var o=a.extend(!0,{},t),n=this._getCollection(o);n.push(o),this._processGeoObject(o);var s=this._getGeoObjectId(o),r=this._serverIdByLocal[s];r&&(o.properties.serverId=r);var c=r?"update":"create";this.setSaveState(o,c),i.push({id:this._getGeoObjectId(o),data:o,collection:n})}},this),i.length&&this.events.fire("geoObjectsAdd",{geoObjectsData:i,canAddMore:this.canAddGeoObject()}),i},updateGeoObjects:function(t){var e=[],i=[];return t.forEach(function(t){var o=t.id,n=t.data,s=this.get(o),r=a.extend(!0,{},s);if(s){var c,l=this.getCollection(o),d=this.getIndex(o);n.options&&(s.options=a.extend(!0,{},s.options,n.options),c="update_metadata"),n.properties&&(s.properties=a.extend(!0,{},s.properties,n.properties),c="update_metadata"),n.geometry&&(n.geometry.type&&(s.geometry.type=n.geometry.type),n.geometry.coordinates&&(s.geometry.coordinates=a.extend(!0,[],n.geometry.coordinates)),c=c?"update":"update_geometry"),l.splice(d,1,s),s=this._processGeoObject(s),c&&this.setSaveState(s,c),e.push({id:o,data:s,collection:l}),i.push({id:o,data:r})}},this),e.length&&this.events.fire("geoObjectsUpdate",{geoObjectsData:e,oldGeoObjectsData:i,updates:t}),e},removeGeoObjects:function(t){var e=[];t.length>0&&t.forEach(function(t){var i=this.get(t);if(i){delete this._dataById[t];var o=this._getCollection(i),n=o.indexOf(i);o.splice(n,1),this.setSaveState(i,"delete"),this._removedGeoObjects.push(i),e.push({id:t,data:i,collection:o}),n<=o.length-1&&this._hiddenZindexUpdate(o,n,o.length-1)}},this),e.length>0&&this.events.fire("geoObjectsRemove",{geoObjectsData:e,canAddMore:this.canAddGeoObject()})},reorderGeoObject:function(t,e,i){var o=this.get(t);if(o){var n=this._getCollection(o),s=n.indexOf(o);i&&(e=c.decodeZIndex(this._getType(o),e)),s>-1&&s!==e&&(n.splice(s,1),n.splice(e,0,o),this.events.fire("geoObjectReorder",{newIndex:e,oldIndex:s,geoObjectId:t,collection:n}),this._hiddenZindexUpdate(n,s,e))}},_hiddenZindexUpdate:function(t,e,i){if(!(t.length<1))for(var o,n=Math.min(e,i),s=Math.max(e,i);s>=n;n++)o=t[n],this._resetZIndex(o),this.setSaveState(o,"update_metadata")},_processGeoObject:function(t){t.options=t.options||{},t.properties=t.properties||{};var e=this._getType(t);t.options.preset||(t.options.preset="point"===e?"islands#blueIcon":"cnst#defaultPreset"),t.options.preset=o.fixPresetName(t.options.preset),t.options.zIndex||this._resetZIndex(t);var a=t.properties;a.caption=i.getObjectCaption(a);var c=r.limits.size.iconDescription;if(a.description&&a.description.length>c&&(a.description=a.description.substr(0,c)),t.geometry.coordinates&&("linestring"===e?t.properties.distance=l(t.geometry.coordinates):"polygon"===e&&(t.properties.area=n({type:"Feature",geometry:t.geometry}))),!t.properties.geoObjectId){var d="local_"+s.get();t.properties.geoObjectId=d}return this._dataById[t.properties.geoObjectId]=t,t},_getType:function(t){return t.geometry.type.toLowerCase()},_getCollection:function(t){return this._geoObjectsByType[this._getType(t)]},setSaveState:function(t,e){var i=this._getGeoObjectId(t),o=this._saveStateById[i];"update_metadata"===e&&"update_geometry"===o?e="update":"update_geometry"===e&&"update_metadata"===o&&(e="update");var n=!o||d.indexOf(o)>d.indexOf(e)||"delete"===o;n&&("delete"===e&&"create"===o?delete this._saveStateById[i]:this._saveStateById[i]=e)},_getGeoObjectId:function(t){return t.properties.geoObjectId},_resetZIndex:function(t){return t.options.order=t.options.zIndex=c.getZIndex(this._getType(t),this._getCollection(t).indexOf(t)),t}});t(u)}),modules.define("ymaps-preset-utils",["ymaps-api","ymaps-geoObject-colors"],function(t,e,i){function o(t){var e=Object.keys(t).sort(),i=[];return e.forEach(function(e){i.push(e,t[e])}),i.join("_")}function n(){return"id"+Number(new Date)+Math.round(1e6*Math.random())}var s=["home","auto","shopping","heart","star","info","attention","factory","medical","leisure","massTransit","delivery","repairShop","government","education","food","pocket","person","family","rapidTransit","money","discount","vegetation","run","hotel","book","waterPark","airport","railway","parking","christian","bicycle2","beach","video","souvenirs","worship","hydro","mountain","garden","waterway","fuelStation","post","sport","bar","theater","dog","park","bicycle","court","fashion","barber","cinema","pool","observation","circus","science","toilet","zoo","underpass","waste","nightClub","carWash","entertainmentCenter"],r={},a=e.meta.version.replace(/\./g,"-"),c={},l={generatePresetByData:function(t){var i=o(t);if(c.hasOwnProperty(i))return c[i];var s=n();return c[i]=s,e.option.presetStorage.add(s,t),s},fillPresetStorage:function(t,o){o||(o=e);var n=t.presetStorage;if(n)for(var s in n)if(n.hasOwnProperty(s)){var r=n[s];for(var a in r)if(r.hasOwnProperty(a)&&a.toLowerCase().indexOf("color")>-1){var c=r[a],l=i.colorToColorAndOpacity(c);r[a]=i.createRGBA(i.fixColor(l[0]),l[1])}o.option.presetStorage.add(s.substr(s.indexOf("#")+1),r)}return this},getPictograms:function(){return s.concat()},fixPresetName:function(t,e){if("[object Array]"===Object.prototype.toString.call(t))for(var i=0,o=t.length;o>i;i++)if("string"==typeof t[i]){t=t[i];break}return"string"!=typeof t&&(t=e),t},getIconType:function(t){return t=t.toLowerCase(),t.indexOf("circle")>-1?"CircleIcon":"Icon"},findPictogram:function(t){return t=e.option.presetStorage.get(t),t&&t.iconPictogram},getPresetColorToCSSRGBA:function(t,i){var o=e.option.presetStorage.get(t)[i];if(!r[o]){var n="#"===o[0]?o.substr(1):o;8===n.length&&(r[o]="rgba("+[parseInt(n.substr(0,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(4,2),16),parseInt(n.substr(6,2),16)/255].join(", ")+")"),6===n.length&&(r[o]="rgb("+[parseInt(n.substr(0,2),16),parseInt(n.substr(2,2),16),parseInt(n.substr(4,2),16)].join(", ")+")")}return r[o]},getIconClassNameByPreset:function(t){var e=this.findPictogram(t);return e?this.getIconClassName(e):""},getIconClassName:function(t){return"ymaps-"+a+"-pictogram_icon_"+t}};t(l)}),modules.define("ymaps-geoObject-colors",[],function(t){var e=["82cdff","1e98ff","177bc9","0e4779","ffd21e","ff931e","e6761b","ed4543","56db40","1bad03","97a100","595959","b3b3b3","f371d1","b51eff","793d0e"],i=["lightblue","blue","darkblue","night","yellow","orange","darkorange","red","green","darkgreen","olive","black","gray","pink","violet","brown"],o={158828:"1bad03","66c7ff":"82cdff","006cff":"1e98ff","00339a":"177bc9","33cc00":"56db40","004056":"0e4779",fd32fb:"f371d1",b832fd:"b51eff",ffea00:"ffd21e",ffb400:"ff931e",ff6600:"e6761b",ff0000:"ed4543",c2ccd2:"b3b3b3",ffffff:"b3b3b3"};t({fixColor:function(t){return o.hasOwnProperty(t)&&(t=o[t]),t},getNearestColor:function(t){return e.reduce(function(e,i){var o=this._distanceBetweenColors(t,i);return o<e.distance?{color:i,distance:o}:e}.bind(this),{color:e[0],distance:this._distanceBetweenColors(t,e[0])}).color+t.substr(6,2)},_rgbToHsl:function(t,e,i){t/=255,e/=255,i/=255;var o,n=Math.max(t,e,i),s=Math.min(t,e,i),r=n-s;o=0===r?0:n===t?60*((e-i)/r%6):n===e?60*((i-t)/r+2):60*((t-e)/r+4);var a=(n+s)/2;return[o,0===r?0:r/(1-Math.abs(2*a-1))*100,100*a]},_distanceBetweenColors:function(t,e){var i=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),n=parseInt(t.substr(4,2),16),s=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),a=parseInt(e.substr(4,2),16);return t=this._rgbToHsl(i,o,n),e=this._rgbToHsl(s,r,a),Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))},getIndexByColor:function(t){return e.indexOf(t&&t.toLowerCase())},getColorById:function(t){return e[t]},getNameByIndex:function(t){return i[t]},getIndexByName:function(t){return i.indexOf(t.toLowerCase())},getColorByName:function(t){return this.getColorById(this.getIndexByName(t))},getColorNames:function(){return i},colorToColorAndOpacity:function(t){return t&&8===t.length?[t.substr(0,6),parseInt(t.substr(-2),16)/255]:[t,1]},createRGBA:function(t,e){0>e?e=0:e>1&&(e=1);var i=Math.round(255*e).toString(16);return 1===i.length&&(i="0"+i),8===t.length?t.substr(0,6)+i:t+i},getColorNameByPreset:function(t){var e=/#(.*?)[A-Z]/.exec(t);return e?e[1]:null}})}),modules.define("ymaps-calc-area",["ymaps-api","ymaps-geoCoords"],function(t,e,i){function o(t){var e=n(t);return s(e)}function n(t){if("Feature"===t.type)return t.geometry;if(t.geometry&&t.geometry.getType)return"Circle"===t.geometry.getType()?{type:"Circle",coordinates:t.geometry.getCoordinates(),radius:t.geometry.getRadius()}:{type:t.geometry.getType(),coordinates:t.geometry.getCoordinates()};throw new Error("util.calculateArea: Unknown input object.")}function s(t){var e,i=0;switch(t.type){case"Polygon":return l(t.coordinates)?null:r(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=r(t.coordinates[e]);return i;case"Rectangle":return r([[t.coordinates[0],[t.coordinates[0][0],t.coordinates[1][1]],t.coordinates[1],[t.coordinates[1][0],t.coordinates[0][1]],t.coordinates[0]]]);case"Circle":return Math.PI*Math.pow(t.radius,2);case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}}function r(t){var e=0;if(t&&t.length>0)for(var i=u(t),o=0;o<t.length;o++)e+=Math.abs(a(t[o]))*i[o];return e}function a(t){var i,o,n,s,r,a,l,d=0,u=t.length,h="latlong"===e.meta.coordinatesOrder?1:0,p="latlong"===e.meta.coordinatesOrder?0:1;if(u>2){for(l=0;u>l;l++)l===u-2?(s=u-2,r=u-1,a=0):l===u-1?(s=u-1,r=0,a=1):(s=l,r=l+1,a=l+2),i=t[s],o=t[r],n=t[a],d+=(c(n[h])-c(i[h]))*Math.sin(c(o[p]));d=d*m*m/2}return d}function c(t){return t*Math.PI/180}function l(t){for(var e=0;e<t.length;e++)for(var i=e;i<t.length;i++)for(var o=t[e],n=t[i],s=0;s<o.length-1;s++)for(var r=0;r<n.length-1;r++)if((o!==n||1!==Math.abs(s-r)&&Math.abs(s-r)!==o.length-2)&&d(o[s][0],o[s][1],o[s+1][0],o[s+1][1],n[r][0],n[r][1],n[r+1][0],n[r+1][1]))return!0;return!1}function d(t,e,i,o,n,s,r,a){var c=(i-t)*(s-a)-(o-e)*(n-r);if(0===c)return!1;var l=(n-t)*(s-a)-(s-e)*(n-r),d=(i-t)*(s-e)-(n-t)*(o-e);return l/=c,d/=c,l>=0&&1>=l&&d>=0&&1>=d}function u(t){t=i.geoPolyAsPixel(t),t.forEach(function(t){t.pop()});for(var e=[],o=0;o<t.length;o++)e.push(h(t,o));return e}function h(t,e){var i=t[e],o=i[0];i.forEach(function(t){t[1]>o[1]&&(o=t)}),o[1]+=g;var n=1;return t.forEach(function(t){p(o[0],o[1],t)&&(n=-n)}),n}function p(t,e,i){for(var o=0,n=i.length-1,s=!1;o<i.length;o++)i[o][1]>e!=i[n][1]>e&&t<(i[n][0]-i[o][0])*(e-i[o][1])/(i[n][1]-i[o][1])+i[o][0]&&(s=!s),n=o;return s}var m=6378137;t(o);var g=1e-14}),modules.define("ymaps-geoCoords",[],function(t){function e(t,e){var o=t[1]*Math.PI/180,n=Math.tan(.25*Math.PI+.5*o),s=Math.pow(2,e+8),r=Math.pow(Math.tan(.25*Math.PI+.5*Math.asin(i*Math.sin(o))),i);return[(t[0]/360+.5)*s,(.5-Math.log(n/r)/(2*Math.PI))*s]}var i=.0818191908426;t({geoToPixels:e,geoPolyAsPixel:function(t,i){return t.map(function(t){return t.map(function(t){return e(t,i||0)})})}})}),modules.define("util-id",[],function(t){var e=0;t({get:function(){return Number(new Date)+"_"+ ++e}})}),modules.define("ymaps-zIndex",[],function(t){var e=Math.pow(10,8),i={active:10*e,focus:10*e-1,drag:10*e+1},o={point:8,circle:6,linestring:4,polygon:1};t({getZIndex:function(t,i){return o[t]*e+i},decodeZIndex:function(t,i){return i-o[t]*e},setBaseZIndex:function(t,e){this.setZIndex(t,"base",this.getZIndex(t.geometry.getType().toLowerCase(),e))},setZIndex:function(t,e,o){var n=t.properties.get("zIndexData",{});n[e]=o?o:i[e],t.options.set("zIndex",this._getZIndex(n)),t.properties.set("zIndexData",n)},unsetZIndex:function(t,e){var i=t.properties.get("zIndexData",{});delete i[e],t.options.set("zIndex",this._getZIndex(i)),t.properties.set("zIndexData",i)},_getZIndex:function(t){var e;for(var i in t)t.hasOwnProperty(i)&&(e=(e||0)<t[i]?t[i]:e);return e}})}),modules.define("map-data-bulk-update",["ymaps-api","jquery","util-string","config","rpc-client","vow","util-coordinates"],function(t,e,i,o,n,s,r,a){function c(t,e,i,o){if(o(e.data&&e.data[0]&&e.data[0].geometry&&e.data[0].geometry.type.toLowerCase(),e.data.length),0===e.data.length)return i.resolve(),null;var n=e.data.slice(0,h),r=e.clientIds.slice(0,h);s.bulkGeoObjectsSave(t,n).then(function(s){e.data.splice(0,h),e.clientIds.splice(0,h),t.set("revision",s.revision);var a=t.get("geoObjects"),l=[];s.results.forEach(function(t,e){var i=n[e];if("create"===i.type){var o=r[e];i=a.get(o),i.properties.serverId=t.id,l.push({id:o,data:i})}}),a.updateGeoObjects(l),a.clearUnsaveUnsavedGeoObjects(r),c(t,e,i,o)},function(n){if(400===n.status&&n.responseJSON&&"BulkObjectNotFoundError"===n.responseJSON.type){var s=n.responseJSON.data.operationIndex;e.data.splice(s,1),t.get("geoObjects").clearUnsaveUnsavedGeoObjects(e.clientIds.splice(s,1)),c(t,e,i,o)}else i.reject(n)},this)}function l(t){var e=[],i=[];return t.forEach(function(t){var o=p[t.saveState](t.data);e.push.apply(e,o);for(var n=o.length,s=t.data.properties.geoObjectId;--n>-1;)i.push(s)}),{data:e,clientIds:i}}function d(t){return{name:"",description:o.removeUtfMagic(t.description||""),iconCaption:o.removeUtfMagic(t.iconCaption||""),iconContent:t.iconContent?Number(t.iconContent).toString():""}}function u(t){var o=t.preset;return o&&0!==o.indexOf("islands")&&(t=i.extend({zIndex:t.zIndex,order:t.order},e.option.presetStorage.get(o))),t}var h=n.limits.count.updateGeoObjectsPerRequest,p={create:function(t){return[{type:"create",properties:d(t.properties),geometry:a.validate(t.geometry),options:u(t.options)}]},update_metadata:function(t){return[{type:"update_metadata",id:t.properties.serverId,properties:d(t.properties),options:u(t.options)}]},update_geometry:function(t){return[{type:"update_geometry",id:t.properties.serverId,geometry:a.validate(t.geometry)}]},update:function(t){return this.update_geometry(t).concat(this.update_metadata(t))},"delete":function(t){return[{type:"delete",id:t.properties.serverId}]}};t({create:function(t){var e=t.get("geoObjects").getUnsavedGeoObjects();if(!e.length)return{totalSteps:0};var i=l(e),o=i.data.length,n={step:0,totalSteps:o?Math.ceil(o/h):0,type:null,objectsLeft:null};return{totalSteps:n.totalSteps,make:function(){var e=r.defer();return c(t,i,e,function(t,i){++n.step,t&&(n.type=t),void 0!==i&&(n.left=i),e.notify(n)}),e.promise()}}}})}),modules.define("util-coordinates",[],function(t){t({validate:function(t){var e,i=t.type.toLowerCase();return"linestring"===i?(e=t.coordinates.concat(),1===e.length&&e.push(e[0]),{type:"LineString",coordinates:e}):"polygon"===i?(e=[],t.coordinates.forEach(function(t){var i=t.concat();if(i.length>0&&(e.push(i),i.length<4))for(var o=4-i.length;--o>-1;)i.push(i[0])}),{type:"Polygon",coordinates:e}):t}})}),modules.define("popup",["i-bem-dom"],function(t,e){var i,o=1e3,n={};t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._parentPopup=i,this._zIndex=null,this._zIndexGroupLevel=null,this._isAttachedToScope=!1},"":function(){this.delMod("visible")}},visible:{"true":function(){this._isAttachedToScope||(e.scope.append(this.domElem),this._isAttachedToScope=!0),this._captureZIndex()._bindToParentPopup()._domEvents().on("pointerpress pointerclick",this._setPreventHideByClick),this.domElem.removeAttr("aria-hidden")},"":function(){this._releaseZIndex()._unbindFromParentPopup()._domEvents().un("pointerpress pointerclick",this._setPreventHideByClick),this.domElem.attr("aria-hidden",!0)}}},setContent:function(t){return e.update(this.domElem,t),this},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),t},_setPreventHideByClick:function(){var t=this;do t._preventHideByClick=!0;while(t=t._getParentPopup())},_bindToParentPopup:function(){var t=this._getParentPopup();return t&&this._events(t).on({modName:"visible",modVal:""},this._onParentPopupHide,this),this},_unbindFromParentPopup:function(){return this._parentPopup&&this._events(this._parentPopup).un({modName:"visible",modVal:""},this._onParentPopupHide,this),this._parentPopup=i,this},_onParentPopupHide:function(){this.delMod("visible")},_getParentPopup:function(){return this._parentPopup},_captureZIndex:function(){var t=null===this._zIndexGroupLevel?this._zIndexGroupLevel=this._calcZIndexGroupLevel():this._zIndexGroupLevel,e=n[t]||(n[t]=[(t+1)*o]),i=this._zIndex;return this._zIndex=e[e.push(e[e.length-1]+1)-1],this._zIndex!==i&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=n[this._zIndexGroupLevel];return t.splice(t.indexOf(this._zIndex),1),this},_recaptureZIndex:function(){return this._releaseZIndex(),this._zIndexGroupLevel=null,this._captureZIndex()},_getDefaultParams:function(){return{zIndexGroupLevel:0}}},{lazyInit:!0}))}),modules.define("functions__throttle",function(t){var e=this.global;t(function(t,i,o,n){var s=typeof o;"undefined"===s?o=!0:3===arguments.length&&"boolean"!==s&&(n=o,o=!0);var r,a,c,l=function(){c?(t.apply(n,a),c=!1,r=e.setTimeout(l,i)):r=null};return function(){a=arguments,n||(n=this),c=!0,r||(o?l():r=e.setTimeout(l,i))}})}),modules.define("button",["i-bem-dom","control","jquery","dom","functions","keyboard__codes"],function(t,e,i,o,n,s,r){t(e.declBlock(this.name,i,{beforeSetMod:{pressed:{"true":function(){return!this.hasMod("disabled")||this.hasMod("togglable")}},focused:{"":function(){return!this._isPointerPressInProgress}}},onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._isPointerPressInProgress=!1,this._focusedByPointer=!1}},disabled:{"true":function(){this.__base.apply(this,arguments),this.hasMod("togglable")||this.delMod("pressed"),this.domElem.attr("aria-disabled",!0)},"":function(){this.__base.apply(this,arguments),this.domElem.removeAttr("aria-disabled")}},focused:{"true":function(){this.__base.apply(this,arguments),this._focusedByPointer||this.setMod("focused-hard")},"":function(){this.__base.apply(this,arguments),this.delMod("focused-hard")}}},getText:function(){return this._elem("text").domElem.text()},setText:function(t){return this._elem("text").domElem.text(t||""),this},_onFocus:function(){this._isPointerPressInProgress||(this.__base.apply(this,arguments),this._domEvents("control").on("keydown",this._onKeyDown))},_onBlur:function(){this._domEvents("control").un("keydown",this._onKeyDown),this.__base.apply(this,arguments)},_onMouseDown:function(t){t.preventDefault(),this._domEvents().un("mousedown",this._onMouseDown)},_onPointerPress:function(){this._domEvents().on("mousedown",this._onMouseDown),this.hasMod("disabled")||(this._isPointerPressInProgress=!0,this._domEvents(e.doc).on("pointerrelease",this._onPointerRelease),this.setMod("pressed"))},_onPointerRelease:function(t){this._isPointerPressInProgress=!1,this._domEvents(e.doc).un("pointerrelease",this._onPointerRelease),"pointerup"===t.originalEvent.type&&n.contains(this.findMixedElem("control").domElem,o(t.target))?(this._focusedByPointer=!0,this._focus(),this._focusedByPointer=!1,this._updateChecked()._emit("click")):this._blur(),this.delMod("pressed")},_onKeyDown:function(t){if(!this.hasMod("disabled")){var e=t.keyCode;(e===r.SPACE||e===r.ENTER)&&(this._domEvents("control").un("keydown",this._onKeyDown).on("keyup",this._onKeyUp),this._updateChecked().setMod("pressed"))}},_onKeyUp:function(t){this._domEvents("control").un("keyup",this._onKeyUp).on("keydown",this._onKeyDown),this.delMod("pressed"),t.keyCode===r.SPACE&&this._doAction(),this._emit("click")},_updateChecked:function(){return this.hasMod("togglable")&&(this.hasMod("togglable","check")?this.toggleMod("checked"):this.setMod("checked")),this},_doAction:s.noop},{lazyInit:!0,onInit:function(){return this._domEvents("control").on("pointerpress",this.prototype._onPointerPress),this.__base.apply(this,arguments)}}))}),modules.define("button",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{onSetMod:{js:function(){this.__base.apply(this,arguments),this._domEvents().on("blur",this._removeFocusMod,this)}},_removeFocusMod:function(){requestAnimationFrame(function(){this.setMod("focused",!1)}.bind(this))}}))}),modules.define("jquery",["next-tick"],function(t,e,i){var o,n=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,s=i.event.special.pointerclick={setup:function(){n?i(this).on("pointerdown",s.onPointerdown).on("pointerup",s.onPointerup).on("pointerleave pointercancel",s.onPointerleave):i(this).on("click",s.handler)},teardown:function(){n?i(this).off("pointerdown",s.onPointerdown).off("pointerup",s.onPointerup).off("pointerleave pointercancel",s.onPointerleave):i(this).off("click",s.handler)},handler:function(t){if(!t.button){var e=t.type;t.type="pointerclick",i.event.dispatch.apply(this,arguments),t.type=e}},onPointerdown:function(t){o=t},onPointerleave:function(){o=null},onPointerup:function(){o&&(r||(e(function(){r=!1,o=null}),r=!0),s.handler.apply(this,arguments))}},r=!1;t(i)}),function(t,e){"object"==typeof modules&&modules.isDefined("jquery")?modules.define("jquery",function(t,i){e(this.global,i),t(i)}):"function"==typeof jQuery&&e(t,jQuery)}(this,function(t,e){function i(t){var i=e.extend(new e.Event,t);return t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i}function o(t,e){return t.bubbles?a.trigger(t,null,e):a.dispatch.call(e,t)}function n(t,i){i||(i={});for(var o,n=e.Event(t),s=0;p>s;s++)o=h[s],n[o]=i[o]||m[s];n.buttons=i.buttons||0,n.x=n.clientX,n.y=n.clientY;var r=0;return r=i.pressure?i.pressure:n.buttons?.5:0,n.pointerId=i.pointerId||0,n.width=i.width||0,n.height=i.height||0,n.pressure=r,n.tiltX=i.tiltX||0,n.tiltY=i.tiltY||0,n.pointerType=i.pointerType||"",n.hwTimestamp=i.hwTimestamp||0,n.isPrimary=i.isPrimary||!1,n.which="undefined"==typeof i.which?1:i.which,n}function s(){this.array=[],this.size=0}function r(){_.eventHandler.apply(_,arguments)}var a=e.event;if(delete a.special.pointerenter,delete a.special.pointerleave,!t.PointerEvent){var c,l=document,d=t.MSPointerEvent&&"number"==typeof t.MSPointerEvent.MSPOINTER_TYPE_MOUSE,u={bubbles:!1,cancelable:!1,view:null,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null,pageX:0,pageY:0},h=Object.keys(u),p=h.length,m=h.map(function(t){return u[t]});s.prototype={set:function(t,e){return e===c?this["delete"](t):(this.has(t)||this.size++,void(this.array[t]=e))},has:function(t){return this.array[t]!==c},"delete":function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach(function(i,o){t.call(e,i,o,this)},this)}};var g=t.Map&&t.Map.prototype.forEach?Map:s,f=new g,_={eventMap:{},eventSourceList:[],registerSource:function(t,e){var i=e.events;i&&(i.forEach(function(t){e[t]&&(this.eventMap[t]=function(){e[t].apply(e,arguments)})},this),this.eventSourceList.push(e))},register:function(t){for(var e,i=this.eventSourceList.length,o=0;i>o&&(e=this.eventSourceList[o]);o++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,o=0;i>o&&(e=this.eventSourceList[o]);o++)e.unregister.call(e,t)},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){t.bubbles=!1,this.fireEvent("pointerenter",t)},leave:function(t){t.bubbles=!1,this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.enterLeave(t,this.leave)},enterOver:function(t){this.over(t),this.enterLeave(t,this.enter)},enterLeave:function(t,e){var i=t.target,o=t.relatedTarget;if(!this.contains(i,o))for(;i&&i!==o;)t.target=i,e.call(this,t),i=i.parentNode},contains:function(t,i){return t===i||e.contains(t,i)},eventHandler:function(t){if(!t._handledByPE){var e,i=t.type;(e=this.eventMap&&this.eventMap[i])&&e(t),t._handledByPE=!0}},listen:function(t,e){e.forEach(function(e){this.addEvent(t,e)},this)},unlisten:function(t,e){e.forEach(function(e){this.removeEvent(t,e)},this)},addEvent:function(t,i){e(t).on(i,r)},removeEvent:function(t,i){e(t).off(i,r)},getTarget:function(t){return t._target},makeEvent:function(t,e){var i=new n(t,e);return e.preventDefault&&(i.preventDefault=e.preventDefault),i._target=i._target||e.target,i},dispatchEvent:function(t){var e=this.getTarget(t);return e?(t.target||(t.target=e),o(t,e)):void 0},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)}},b=200,v=25,y=1,M=2500,j=20,I={POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){_.listen(t,this.events)},unregister:function(t){_.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,o=t.clientX,n=t.clientY,s=0,r=i.length;r>s&&(e=i[s]);s++){var a=Math.abs(o-e.x),c=Math.abs(n-e.y);if(v>=a&&v>=c)return!0}},prepareEvent:function(t){var e=i(t);return e.pointerId=y,e.isPrimary=!0,e.pointerType=this.POINTER_TYPE,e},mousedown:function(t){if(!this.isEventSimulatedFromTouch(t)){f.has(y)&&this.cancel(t),f.set(y,t);var e=this.prepareEvent(t);_.down(e)}},mousemove:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_.move(e)}},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=f.get(y);if(e&&e.button===t.button){var i=this.prepareEvent(t);_.up(i),this.cleanupMouse()}}},mouseover:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_.enterOver(e)}},mouseout:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=this.prepareEvent(t);_.leaveOut(e)}},cancel:function(t){var e=this.prepareEvent(t);_.cancel(e),this.cleanupMouse()},cleanupMouse:function(){f["delete"](y)}},C={events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){_.listen(t,this.events)},unregister:function(t){_.unlisten(t,this.events)},POINTER_TYPE:"touch",clickCount:0,resetId:null,firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===f.size||1===f.size&&f.has(y))&&(this.firstTouch=t.identifier,this.firstXY={X:t.clientX,Y:t.clientY},this.scrolling=null,this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.resetClickCount())},resetClickCount:function(){var t=this;this.resetId=setTimeout(function(){t.clickCount=0,t.resetId=null},b)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){return"touchstart"===t||"touchmove"===t?1:0},findTarget:function(t){return l.elementFromPoint(t.clientX,t.clientY)},touchToPointer:function(t){var e=this.currentTouchEvent,o=i(t);o.pointerId=t.identifier+2,o.target=this.findTarget(o),o.bubbles=!0,o.cancelable=!0,o.detail=this.clickCount,o.button=0,o.buttons=this.typeToButtons(e.type),o.width=t.webkitRadiusX||t.radiusX||0,o.height=t.webkitRadiusY||t.radiusY||0,o.pressure=t.mozPressure||t.webkitForce||t.force||.5,o.isPrimary=this.isPrimaryTouch(t),o.pointerType=this.POINTER_TYPE;var n=this;return o.preventDefault=function(){n.scrolling=!1,n.firstXY=null,e.preventDefault()},o},processTouches:function(t,e){var i=t.originalEvent.changedTouches;this.currentTouchEvent=t;for(var o,n=0;n<i.length;n++)o=i[n],e.call(this,this.touchToPointer(o))},shouldScroll:function(){return!0},findTouch:function(t,e){for(var i,o=0,n=t.length;n>o&&(i=t[o]);o++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.touches;if(f.size>=e.length){var i=[];f.forEach(function(t,o){o===y||this.findTouch(e,o-2)||i.push(t.outEvent)},this),i.forEach(this.cancelOut,this)}},dedupSynthMouse:function(t){var e=I.lastTouches,i=t.changedTouches[0];if(this.isPrimaryTouch(i)){var o={x:i.clientX,y:i.clientY};e.push(o),setTimeout(function(){var t=e.indexOf(o);t>-1&&e.splice(t,1)},M)}},touchstart:function(t){var e=t.originalEvent;this.vacuumTouches(e),this.setPrimaryTouch(e.changedTouches[0]),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))
},touchmove:function(t){var e=t.originalEvent;if(this.scrolling){if(this.firstXY){var i=this.firstXY,o=e.changedTouches[0],n=o.clientX-i.X,s=o.clientY-i.Y,r=Math.sqrt(n*n+s*s);r>=j&&(this.touchcancel(t),this.scrolling=!0,this.firstXY=null)}}else null===this.scrolling&&this.shouldScroll(e)?this.scrolling=!0:(t.preventDefault(),this.processTouches(t,this.moveOverOut))},touchend:function(t){var e=t.originalEvent;this.dedupSynthMouse(e),this.processTouches(t,this.upOut)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},overDown:function(t){var e=t.target;f.set(t.pointerId,{target:e,outTarget:e,outEvent:t}),_.over(t),_.enter(t),_.down(t)},moveOverOut:function(t){var e=f.get(t.pointerId);if(e){_.move(t);var i=e.outEvent,o=e.outTarget;i&&o!==t.target&&(t.relatedTarget=o,i.relatedTarget=t.target,i.target=o,t.target?(_.leaveOut(i),_.enterOver(t)):(t.target=o,t.relatedTarget=null,this.cancelOut(t))),e.outEvent=t,e.outTarget=t.target}},upOut:function(t){_.up(t),_.out(t),_.leave(t),this.cleanUpPointer(t)},cancelOut:function(t){_.cancel(t),_.out(t),_.leave(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){f["delete"](t.pointerId),this.removePrimaryPointer(t)}},k={events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel"],register:function(t){_.listen(t,this.events)},unregister:function(t){_.unlisten(t,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(t){var e=i(t);return d&&(e.pointerType=this.POINTER_TYPES[t.pointerType]),e},MSPointerDown:function(t){f.set(t.pointerId,t);var e=this.prepareEvent(t);_.down(e)},MSPointerMove:function(t){var e=this.prepareEvent(t);_.move(e)},MSPointerUp:function(t){var e=this.prepareEvent(t);_.up(e),this.cleanup(t.pointerId)},MSPointerOut:function(t){var e=this.prepareEvent(t);_.leaveOut(e)},MSPointerOver:function(t){var e=this.prepareEvent(t);_.enterOver(e)},MSPointerCancel:function(t){var e=this.prepareEvent(t);_.cancel(e),this.cleanup(t.pointerId)},cleanup:function(t){f["delete"](t)}},x=t.navigator;x.msPointerEnabled?_.registerSource("ms",k):(_.registerSource("mouse",I),"undefined"!=typeof t.ontouchstart&&_.registerSource("touch",C)),_.register(l)}}),modules.define("keyboard__codes",function(t){t({BACKSPACE:8,TAB:9,ENTER:13,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46})}),modules.define("control",["i-bem-dom","dom","next-tick"],function(t,e,i,o){t(e.declBlock(this.name,{beforeSetMod:{focused:{"true":function(){return!this.hasMod("disabled")}}},onSetMod:{js:{inited:function(){var t=this._elem("control").domElem;this._focused=i.containsFocus(t),this._focused?this._onFocus():this.hasMod("focused")&&this._focus(),this._tabIndex="undefined"!=typeof this.params.tabIndex?this.params.tabIndex:t.attr("tabindex"),this.hasMod("disabled")&&"undefined"!==this._tabIndex&&t.removeAttr("tabindex")}},focused:{"true":function(){this._focused||this._focus()},"":function(){this._focused&&this._blur()}},disabled:{"true":function(){this._elem("control").domElem.attr("disabled",!0),this.delMod("focused"),"undefined"!=typeof this._tabIndex&&this._elem("control").domElem.removeAttr("tabindex")},"":function(){this._elem("control").domElem.removeAttr("disabled"),"undefined"!=typeof this._tabIndex&&this._elem("control").domElem.attr("tabindex",this._tabIndex)}}},getName:function(){return this._elem("control").domElem.attr("name")||""},getVal:function(){return this._elem("control").domElem.val()},_onFocus:function(){this._focused=!0,this.setMod("focused")},_onBlur:function(){this._focused=!1,this.delMod("focused")},_focus:function(){i.isFocusable(this._elem("control").domElem)?this._elem("control").domElem.focus():this._onFocus()},_blur:function(){this._elem("control").domElem.blur(),this._onBlur()}},{lazyInit:!0,onInit:function(){this._domEvents("control").on("focusin",function(){this._focused||this._onFocus()}).on("focusout",this.prototype._onBlur);var t=i.getFocused();if(t.hasClass(this._buildClassName("control"))){var e=this;o(function(){if(t[0]===i.getFocused()[0]){var o=t.closest(e._buildSelector());o&&o.bem(e)}})}}}))}),modules.define("control",["i-bem-dom"],function(t,e,i){t(e.declBlock(i,{beforeSetMod:{hovered:{"true":function(){return!this.hasMod("disabled")}}},onSetMod:{disabled:{"true":function(){this.__base.apply(this,arguments),this.delMod("hovered")}},hovered:{"true":function(){this._domEvents().on("mouseleave",this._onMouseLeave)},"":function(){this._domEvents().un("mouseleave",this._onMouseLeave)}}},_onMouseOver:function(){this.setMod("hovered")},_onMouseLeave:function(){this.delMod("hovered")}},{onInit:function(){return this._domEvents().on("mouseover",this.prototype._onMouseOver),this.__base.apply(this,arguments)}}))}),modules.define("spin",["i-bem-dom"],function(t,e){t(e.declBlock(this.name))}),modules.define("map-selection-item",["i-bem-dom","i18n-plus","result-link","jquery","yametrika","config","dropdown","menu","input","util-string","util-format-date"],function(t,e,i,o,n,s,r,a,c,l,d,u){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._domEvents().on("click",this._onClick,this),this._events(this.findChildBlock(a)).on({modName:"opened",modVal:"*"},this._onDropdownModChange,this),this._domEvents().on("mouseenter",this._onMouseEnter,this),this._domEvents().on("mouseleave",this._onMouseLeave,this)}}},setMapEntry:function(t){this._mapEntryListener&&(this._mapEntryListener.destroy(),this._mapEntryListener=null),t&&(this._mapEntryListener=t.createListener().add("mapName",this._applyMapName,this).add("mapDescription",this._applyMapDescription,this).add("timeUpdated",this._applyTimeUpdated,this),this._applyMapName(t.get("mapName")),this._applyMapDescription(t.get("mapDescription")),this._applyTimeUpdated(t.get("timeUpdated")))},_applyMapName:function(t){this._elem("title-text").domElem.html(t?d.escape(t):i("map-selection","no-name-map"))},_applyMapDescription:function(t){this._elem("description").domElem.html(d.escape(t))},_applyTimeUpdated:function(t){this._elem("updated").domElem.text(u(t,!0))},_onClick:function(t){"div"===t.target.tagName.toLowerCase()&&this._fireEvent("select")},_onMouseEnter:function(){this.setMod("hover")},_onMouseLeave:function(){this.setMod("hover",!1)},_onCopyButtonClick:function(){var t=this._popup.findChildBlock(l);t.setMod("focused"),t.selectAll(),document.execCommand("copy"),this._copyBtn.setMod("mode","copied"),s.reachGoal("CLICK_LINK_MAPLIST")},_onShareButtonClick:function(){var t=this.domElem.data("index"),e=o.getMapLink(t,{source:"constructorLink"});this._popup.setMod("mode","share"),this._popup.redraw();var i=this._popup.findChildBlock(l);i.setVal(e),i.setMod("focused"),i.selectAll()},_onInputClick:function(){this._popup.findChildBlocks(c).get(1).findChildElem("item").setMod("mode","copy"),s.reachGoal("CLICK_LINK_MAPLIST")},_onDuplicateButtonClick:function(){this._popup.setMod("visible",!1),this._fireEvent("duplicate")},_onRemoveButtonClick:function(){this._popup.setMod("visible",!1),window.confirm(i("map-selection","remove-map-confirm"))&&this._fireEvent("remove")},_onDropdownModChange:function(t,i){if(this.setMod("active",i.modVal),i.modVal===!0){this._popup=this.findChildBlock(a).getPopup(),this._domEvents(this._popup.findChildBlock(l)).on("click",this._onInputClick,this);var o=this._popup.findChildBlocks(c),n=o.get(0).findChildElems("item");this._domEvents(n.get(0)).on("click",this._onShareButtonClick,this),this._domEvents(n.get(1)).on("click",this._onDuplicateButtonClick,this),this._domEvents(n.get(2)).on("click",this._onRemoveButtonClick,this);var s=o.get(1);s&&(r.canCopyFromPage?(this._copyBtn=s.findChildElems("item").get(0),this._copyBtn.domElem.attr("tabindex",0),this._domEvents(this._copyBtn).on("click",this._onCopyButtonClick,this)):e.destruct(s.domElem)),setTimeout(function(){this._emit("dropdown",this)}.bind(this),1)}else this._copyBtn&&this._copyBtn.setMod("mode","copy"),setTimeout(function(){this._popup.setMod("mode","menu")}.bind(this),100),this._emit("dropdown",null)},_fireEvent:function(t){this._emit(t,{id:this.domElem.data("index")})}}))}),modules.define("input",["i-bem-dom","control"],function(t,e,i){t(e.declBlock(this.name,i,{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._val=this._elem("control").domElem.val()}}},getVal:function(){return this._val},setVal:function(t,e){if(t=String(t),this._val!==t){this._val=t;var i=this._elem("control");i.domElem.val()!==t&&i.domElem.val(t),this._emit("change",e)}return this}},{onInit:function(){this.__base.apply(this,arguments)}}))}),modules.define("input",["i-bem-dom","tick","idle"],function(t,e,i,o,n){var s,r=[],a=function(){s=!0,i.on("tick",c).start(),o.on({idle:function(){i.un("tick",c)},wakeup:function(){i.on("tick",c)}}).start()},c=function(){for(var t,e=0;t=r[e++];)t.setVal(t._elem("control").domElem.val())};t(e.declBlock(n,{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),s||a(),this._instanceIndex=r.push(this)-1},"":function(){this.__base.apply(this,arguments),r.splice(this._instanceIndex,1);for(var t,e=this._instanceIndex;t=r[e++];)--t._instanceIndex}}},_focus:function(){var t=this._elem("control").domElem[0];if(t.createTextRange&&!t.selectionStart){var e=t.createTextRange();e.move("character",t.value.length),e.select()}else t.focus()}}))}),modules.define("input",["i-bem-dom","popup","bh"],function(t,e,i,o){var n={length:function(t){var e=Number(t);return{check:function(t){return t.length>e},validate:function(t){return t.substr(0,e)}}}},s={block:"popup",content:{block:"error-hint",content:""},directions:["right-center","top-center","left-center"],mods:{theme:"islands",autoclosable:!1,autopositioner:!0,target:"anchor",id:"error-popup"},mix:[{block:"z-index-group",mods:{level:6}}],mainOffset:10};t(e.declBlock(this.name,{onSetMod:{js:function(){this.__base.apply(this,arguments),this.domElem.attr("data-validate")&&(this._validateData=JSON.parse(this.domElem.attr("data-validate"))),this._conditionals=[],this._validateData&&this._parseConditions()}},getInvalidVal:function(){return this._invalidVal||""},setVal:function(t){if(!this._validateData)return this.__base.apply(this,arguments);if(this._invalidVal!==t){var e=this._checkValue(t);this._invalidVal=t,this._setErrorState(!e),e?this.__base.apply(this,arguments):(t=this._conditionals.reduce(function(t,e){return e.validate(t)},t),this._val=t,this._emit("change",t))}return this},validate:function(){this._conditionals.length&&(this._val=this._invalidVal,this.setVal(this._conditionals.reduce(function(t,e){return e.validate(t)},this.getInvalidVal())))},_setErrorState:function(t){this._lastTime&&Date.now()-this._lastTime<10||(this._lastTime=Date.now(),this._popup?this._popup.setMod("visible",t):t&&(this._popup=this._createPopup(),this._popup.setAnchor(this._elem("control")).setMod("visible",!0)),this.setMod("error",t))},_checkValue:function(t){return 0===this._conditionals.length||this._conditionals.some(function(e){return!e.check(t)})},_parseConditions:function(){var t=this._validateData.conditionals;t&&t.split(",").forEach(function(t){var e=t.split(":"),i=e[0];t=e[1],n[i]&&this._conditionals.push(n[i](t))},this)},_createPopup:function(){return s.content.content=this._validateData.message,s.content.mods=this._validateData.mods||{},e.append(this.domElem,o.apply(s)).bem(i)}}))}),modules.define("tick",["inherit","events"],function(t,e,i){var o=50,n=this.global,s=e(i.Emitter,{__constructor:function(){this._timer=null,this._isStarted=!1},start:function(){this._isStarted||(this._isStarted=!0,this._scheduleTick())},stop:function(){this._isStarted&&(this._isStarted=!1,n.clearTimeout(this._timer))},_scheduleTick:function(){var t=this;this._timer=n.setTimeout(function(){t._onTick()},o)},_onTick:function(){this.emit("tick"),this._isStarted&&this._scheduleTick()}});t(new s)}),modules.define("idle",["inherit","events","jquery"],function(t,e,i,o){var n=3e3,s="mousemove keydown click",r=e(i.Emitter,{__constructor:function(){this._timer=null,this._isStarted=!1,this._isIdle=!1},start:function(){this._isStarted||(this._isStarted=!0,this._startTimer(),o(document).on(s,o.proxy(this._onUserAction,this)))},stop:function(){this._isStarted&&(this._isStarted=!1,this._stopTimer(),o(document).off(s,this._onUserAction))},isIdle:function(){return this._isIdle},_onUserAction:function(){this._isIdle&&(this._isIdle=!1,this.emit("wakeup")),this._stopTimer(),this._startTimer()},_startTimer:function(){var t=this;this._timer=setTimeout(function(){t._onTimeout()},n)},_stopTimer:function(){this._timer&&clearTimeout(this._timer)},_onTimeout:function(){this._isIdle=!0,this.emit("idle")}});t(new r)}),modules.define("popup",["jquery","i-bem-dom","ua","dom","keyboard__codes"],function(t,e,i,o,n,s,r){function a(t){t.keyCode===s.ESC&&l.length&&!n.isEditable(e(t.target))&&l[0].delMod("visible")}var c=o.opera&&o.version<12.1?"keypress":"keydown",l=[];t(r.declMod({modName:"autoclosable",modVal:!0},{onSetMod:{visible:{"true":function(){l.unshift(this),this._nextTick(function(){this._domEvents(i.doc).on("pointerclick",this._onDocPointerClick)}).__base.apply(this,arguments)},"":function(){l.splice(l.indexOf(this),1),this._domEvents(i.doc).un("pointerclick",this._onDocPointerClick),this.__base.apply(this,arguments)}}},_onDocPointerClick:function(t){this.hasMod("target","anchor")&&n.contains(this._anchor,e(t.target))||(this._preventHideByClick?this._preventHideByClick=null:this.delMod("visible"))}},{lazyInit:!0,onInit:function(){i.doc.on(c,a)}}))}),modules.define("popup",["i-bem-dom","objects"],function(t,e,i,o){var n,s=.99,r=["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right-top","right-center","right-bottom","left-top","left-center","left-bottom"],a=e.win;t(o.declMod({modName:"target",modVal:"*"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._lastDrawingCss={left:n,top:n,zIndex:n,display:n}}},visible:{"true":function(){this.__base.apply(this,arguments),this._domEvents(a).on("scroll resize",this._onWinScrollAndResize),this.redraw()},"":function(){this.__base.apply(this,arguments),this._domEvents(a).un("scroll resize",this._onWinScrollAndResize)}}},setContent:function(){return this.__base.apply(this,arguments).redraw()},redraw:function(){if(!this.hasMod("visible"))return this;var t=this._calcBestDrawingParams();this.setMod("direction",t.direction);var e=this._lastDrawingCss,o=!1;return i.each(this._calcDrawingCss(t),function(t,i){e[i]!==t&&(e[i]=t,o=!0)}),o&&this.domElem.css(e),this},_calcDrawingCss:function(t){return{left:t.left,top:t.top}},calcPossibleDrawingParams:function(){var t=this._calcTargetDimensions(),e=this._calcViewportDimensions(),i=this.params,o=i.mainOffset,n=i.secondaryOffset,s=i.viewportOffset;return this.params.directions.map(function(i){var r={direction:i,width:0,height:0,left:0,top:0};return this._checkMainDirection(i,"bottom")?(r.top=t.top+t.height+o,r.height=e.bottom-r.top-s):this._checkMainDirection(i,"top")?(r.height=t.top-e.top-o-s,r.top=t.top-r.height-o):(this._checkSecondaryDirection(i,"center")?(r.height=e.bottom-e.top-2*s,r.top=t.top+t.height/2-r.height/2):this._checkSecondaryDirection(i,"bottom")?(r.height=t.top+t.height-e.top-n-s,r.top=t.top+t.height-r.height-n):this._checkSecondaryDirection(i,"top")&&(r.top=t.top+n,r.height=e.bottom-r.top-s),this._checkMainDirection(i,"left")?(r.width=t.left-e.left-o-s,r.left=t.left-r.width-o):(r.left=t.left+t.width+o,r.width=e.right-r.left-s)),this._checkSecondaryDirection(i,"right")?(r.width=t.left+t.width-e.left-n-s,r.left=t.left+t.width-r.width-n):this._checkSecondaryDirection(i,"left")?(r.left=t.left+n,r.width=e.right-r.left-s):this._checkSecondaryDirection(i,"center")&&this._checkMainDirection(i,"top","bottom")&&(r.width=e.right-e.left-2*s,r.left=t.left+t.width/2-r.width/2),r},this)},_calcBestDrawingParams:function(){for(var t,e,i,o,n,r,a=this._calcPopupDimensions(),c=this._calcTargetDimensions(),l=this._calcViewportDimensions(),d=this.params.directions,u=0;(t=d[u++])&&(e=this._calcPos(t,c,a),i=this._calcViewportFactor(e,l,a),(1===u||i>r||!r&&this.hasMod("direction",t))&&(o=t,r=i,n=e),!(r>s)););return{direction:o,left:n.left,top:n.top}},_calcPopupDimensions:function(){var t=this.domElem.outerWidth(),e=this.domElem.outerHeight();return{width:t,height:e,area:t*e}},_calcTargetDimensions:function(){},_calcViewportDimensions:function(){var t=a.scrollTop(),e=a.scrollLeft(),i=a.width(),o=a.height();return{top:t,left:e,bottom:t+o,right:e+i}},_calcPos:function(t,e,i){var o={},n=this.params.mainOffset,s=this.params.secondaryOffset;return this._checkMainDirection(t,"bottom")?o.top=e.top+e.height+n:this._checkMainDirection(t,"top")?o.top=e.top-i.height-n:this._checkMainDirection(t,"left")?o.left=e.left-i.width-n:this._checkMainDirection(t,"right")&&(o.left=e.left+e.width+n),this._checkSecondaryDirection(t,"right")?o.left=e.left+e.width-i.width-s:this._checkSecondaryDirection(t,"left")?o.left=e.left+s:this._checkSecondaryDirection(t,"bottom")?o.top=e.top+e.height-i.height-s:this._checkSecondaryDirection(t,"top")?o.top=e.top+s:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?o.left=e.left+e.width/2-i.width/2:this._checkMainDirection(t,"left","right")&&(o.top=e.top+e.height/2-i.height/2)),o},_calcViewportFactor:function(t,e,i){var o=this.params.viewportOffset,n=Math.max(t.left,e.left+o),s=Math.min(t.left+i.width,e.right-o),r=Math.max(t.top,e.top+o),a=Math.min(t.top+i.height,e.bottom-o);return s>n&&a>r?(s-n)*(a-r)/i.area:0},_checkMainDirection:function(t,e,i){return!t.indexOf(e)||i&&!t.indexOf(i)},_checkSecondaryDirection:function(t,e){return~t.indexOf("-"+e)},_onWinScrollAndResize:function(){this.redraw()},_getDefaultParams:function(){return i.extend(this.__base.apply(this,arguments),{mainOffset:0,secondaryOffset:0,viewportOffset:0,directions:r})}}))}),modules.define("z-index-group",["i-bem-dom"],function(t,e){t(e.declBlock(this.name))}),modules.define("popup",["util-mutation-observer","util-node-contains"],function(t,e,i,o){t(o.declMod({modName:"autopositioner",modVal:!0},{onSetMod:{visible:function(t){"visible"===t?this._setupObserver():this._teardownObserver()}},_setupObserver:function(){this._observer||(this._observer=new window.MutationObserver(this._handler.bind(this))),this._observer.observe(document.body,{attributes:!0,subtree:!0})},_teardownObserver:function(){this._observer.disconnect()},_handler:function(t){this._rafID||t.some(function(t){var e=t.target&&t.target.contains(this._anchor[0]);return e&&(this._rafID=requestAnimationFrame(function(){this._rafID=0,this.redraw()}.bind(this))),e},this)}}))}),modules.define("util-mutation-observer",["loader_type_js","config"],function(t,e,i){window.MutationObserver?t(window.MutationObserver):e(i.baseURL+"res/libs/mutationobserver.js",function(){t(window.MutationObserver)},function(){t(null)})}),modules.define("util-node-contains",[],function(t){Node.prototype.contains||(Node.prototype.contains=function(t){for(;t;){if(t===this)return!0;t=t.parentNode}return!1}),t(Node.prototype.contains)}),modules.define("error-hint",["i-bem-dom","popup"],function(t,e,i){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._events(this.findParentBlock(i)).on({modName:"direction",modVal:"*"},this._applyDirection,this)}}},setContent:function(t){return e.update(this.domElem,t),this},_applyDirection:function(){this.setMod("direction",this.findParentBlock(i).getMod("direction"))}}))}),modules.define("link",["i-bem-dom","control","events"],function(t,e,i,o){t(e.declBlock(this.name,i,{onSetMod:{js:{inited:function(){this._url=this.params.url||this.domElem.attr("href"),this.hasMod("disabled")&&this.domElem.removeAttr("href")}},disabled:{"true":function(){this.__base.apply(this,arguments),this.domElem.removeAttr("href").attr("aria-disabled",!0)},"":function(){this.__base.apply(this,arguments),this.domElem.attr("href",this._url).removeAttr("aria-disabled")}}},getUrl:function(){return this._url},setUrl:function(t){return this._url=t,this.hasMod("disabled")||this.domElem.attr("href",t),this},_onPointerClick:function(t){if(this.hasMod("disabled"))t.preventDefault();else{var e=new o.Event("click");this._emit(e),e.isDefaultPrevented()&&t.preventDefault()}}},{lazyInit:!0,onInit:function(){return this._domEvents("control").on("pointerclick",this.prototype._onPointerClick),this.__base.apply(this,arguments)}}))}),modules.define("link",["keyboard__codes"],function(t,e,i){t(i.declMod({modName:"pseudo",modVal:!0},{onSetMod:{focused:{"true":function(){this.__base.apply(this,arguments),this._domEvents("control").on("keydown",this._onKeyDown)},"":function(){this.__base.apply(this,arguments),this._domEvents("control").un("keydown",this._onKeyDown)}}},_onPointerClick:function(t){t.preventDefault(),this.__base.apply(this,arguments)},_onKeyDown:function(t){t.keyCode===e.ENTER&&this._onPointerClick(t)}}))}),modules.define("menu",["i-bem-dom","control","keyboard__codes","menu__item"],function(t,e,i,o,n){var s=1500;t(e.declBlock(this.name,i,{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._hoveredItem=null,this._items=null,this._lastTyping={"char":"",text:"",index:0,time:0}}},disabled:{"*":function(t,e){this.__base.apply(this,arguments),this.getItems().setMod(t,e)},"true":function(){this.__base.apply(this,arguments),this.domElem.attr("aria-disabled",!0)},"":function(){this.__base.apply(this,arguments),this.domElem.removeAttr("aria-disabled")}}},getItems:function(){return this._items||(this._items=this.findChildElems("item"))},setContent:function(t){return e.update(this.domElem,t),this._hoveredItem=null,this._items=null,this},searchItemByKeyboardEvent:function(t){var e=+new Date,i=t.charCode,n=String.fromCharCode(i).toLowerCase(),r=this._lastTyping,a=r.index,c=n===r.char&&1===r.text.length,l=this.getItems();if(i<=o.SPACE||t.ctrlKey||t.altKey||t.metaKey)return r.time=e,null;e-r.time>s||c?r.text=n:r.text+=n,r.char=n,r.time=e,c&&0===l.get(a).getText().search(r.char)&&(a=a>=l.size()-1?0:a+1);for(var d=a,u=l.size();u>d;){if(this._doesItemMatchText(l.get(d),r.text))return r.index=d,l.get(d);d++,d===l.size()&&(d=0,u=a)}return null},_onFocus:function(){this.__base.apply(this,arguments),this._domEvents(e.doc).on("keydown",this._onKeyDown).on("keypress",this._onKeyPress)},_onBlur:function(){this._domEvents(e.doc).un("keydown",this._onKeyDown).un("keypress",this._onKeyPress),this.__base.apply(this,arguments),this._hoveredItem&&this._hoveredItem.delMod("hovered")},_onItemHover:function(t){t.hasMod("hovered")?(this._hoveredItem&&this._hoveredItem.delMod("hovered"),this._scrollToItem(this._hoveredItem=t),this.domElem.attr("aria-activedescendant",t.domElem.attr("id"))):this._hoveredItem===t&&(this._hoveredItem=null,this.domElem.removeAttr("aria-activedescendant")),this._emit("item-hover",{item:t})},_scrollToItem:function(t){var e,i=this.domElem.offset().top,o=t.domElem.offset().top;((e=o-i)<0||(e=o+t.domElem.outerHeight()-i-this.domElem.outerHeight())>0)&&this.domElem.scrollTop(this.domElem.scrollTop()+e)},_onItemClick:function(t,e){this._emit("item-click",{item:t,source:e.source})},_onKeyDown:function(t){var e=t.keyCode,i=e===o.UP||e===o.DOWN;if(i&&!t.shiftKey){t.preventDefault();var n=e-39,s=this.getItems(),r=s.size(),a=s.toArray().indexOf(this._hoveredItem),c=a,l=0;do if(c+=n,c=0>c?r-1:c>=r?0:c,++l===r)return;while(s.get(c).hasMod("disabled"));this._lastTyping.index=c,s.get(c).setMod("hovered")}},_onKeyPress:function(t){var e=this.searchItemByKeyboardEvent(t);e&&e.setMod("hovered")},_doesItemMatchText:function(t,e){return!t.hasMod("disabled")&&0===t.getText().toLowerCase().search(e)}},{lazyInit:!0,onInit:function(){return this._events(n).on({modName:"hovered",modVal:"*"},function(t){this._onItemHover(t.target)}).on("click",function(t,e){this._onItemClick(t.target,e)}),this.__base.apply(this,arguments)}}))}),modules.define("menu__item",["i-bem-dom"],function(t,e){t(e.declElem("menu","item",{beforeSetMod:{hovered:{"true":function(){return!this.hasMod("disabled")}}},onSetMod:{js:{inited:function(){this._domEvents().on("pointerleave",this._onPointerLeave)}},disabled:{"true":function(){this.delMod("hovered").domElem.attr("aria-disabled",!0)},"":function(){this.domElem.removeAttr("aria-disabled")}},checked:{"*":function(t,e){this.domElem.attr("aria-checked",!!e)}}},isValEq:function(t){return String(this.params.val)===String(t)},getVal:function(){return this.params.val},getText:function(){return this.params.text||this.domElem.text()},_onPointerOver:function(){this.setMod("hovered")},_onPointerLeave:function(){this.delMod("hovered")},_onPointerClick:function(){this.hasMod("disabled")||this._emit("click",{source:"pointer"})}},{lazyInit:!0,onInit:function(){var t=this.prototype;this._domEvents().on("pointerover",t._onPointerOver).on("pointerclick",t._onPointerClick)}}))}),modules.define("result-link",["config","uri__querystring"],function(t,e,i){function o(t,e,o){var n=t+"?"+i.stringify(e);return o&&(n=n.replace(/&/g,"&amp;")),n}var n={};t({getLink:function(t,e,i,o){return n[t+"Type"](e,i,o)},getMapLink:function(t,i){i=i||{};var n=e.hosts.map+(i.path?i.path+"/":"");return o(n,{um:t,source:i.source||""},i.specChars)},getYaDiskLink:function(t){return e.hosts.diskFront+(t||"")}}),n.interactiveIframeType=function(t,i,n){return o(e.hosts.mapWidget+"v1/",{um:t},n)},n.interactiveScriptType=function(t,i,n){return o(e.hosts.widget+"1.0/js/",{um:t,width:"available"===i[0]?"100%":i[0],height:"available"===i[1]?"100%":i[1],lang:e.apiLangParam,scroll:"true"},n)},n.staticType=function(t,i,n){return o(e.hosts.widget+"1.0/static/",{um:t,width:i[0],height:i[1],lang:e.apiLangParam},n)}}),modules.define("uri",function(t){function e(t){return t.replace(/%.{2}/g,function(t){return o[t]||t})}function i(t,i){var o="";try{o=t(i)}catch(n){try{o=t(e(i))}catch(s){o=i}}return o}var o={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};t({decodeURI:function(t){return i(decodeURI,t)},decodeURIComponent:function(t){return i(decodeURIComponent,t)}})}),modules.define("uri__querystring",["uri"],function(t,e){function i(t,e,i){t.push(encodeURIComponent(e)+"="+(null==i?"":encodeURIComponent(i)))}var o=Object.prototype.hasOwnProperty;t({parse:function(t){return t?t.split("&").reduce(function(t,i){if(!i)return t;var n,s,r=i.indexOf("=");return r>=0?(n=i.substr(0,r),s=i.substr(r+1)):(n=i,s=""),n=e.decodeURIComponent(n),s=e.decodeURIComponent(s),o.call(t,n)?Array.isArray(t[n])?t[n].push(s):t[n]=[t[n],s]:t[n]=s,t},{}):{}},stringify:function(t){return Object.keys(t).reduce(function(e,o){var n=t[o];return Array.isArray(n)?n.forEach(function(t){i(e,o,t)}):i(e,o,n),e},[]).join("&")}})}),modules.define("util-format-date",[],function(t){function e(t){return("0"+t).slice(-2)}t(function(t,i){var o=new Date(t);return[[e(o.getDate()),e(o.getMonth()+1),o.getFullYear().toString().slice(i?2:0)].join("."),[e(o.getHours()),e(o.getMinutes())].join(":")].join(" ")})}),modules.define("header",["i-bem-dom","config","yametrika","button"],function(t,e,i,o,n){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.setMod("view",i.user.isUserAuthorized?"user":"login"),this._events(this.findChildBlock({block:n,modName:"id",modVal:"loginBtn"})).on("click",function(){o.reachGoal("HEADER_LOGIN"),this._emit("showLoginRequest")},this),this._mapListButton=this.findChildBlock({block:n,modName:"id",modVal:"mapListBtn"}),this.setMod("lang",i.lang),this._events(this._mapListButton).on("click",function(){this._emit("openMapListRequest")},this)}},nomaps:function(t,e){this._mapListButton.setMod("disabled",e)}}}))}),modules.define("user-button",["i-bem-dom","popup","button","user-data"],function(t,e,i,o,n){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this._popup=this.findChildBlock(i);t.setAnchor(this.findChildBlock(n).findChildElem("userpic"))}}},_onClick:function(){this._popup.toggleMod("visible")}},{onInit:function(){this._domEvents(o).on("click",this.prototype._onClick)}}))}),modules.define("user-menu",["i-bem-dom","user-data","jquery","config"],function(t,e,i,o,n){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this.findChildBlocks(i);this._domEvents(t).on("click",function(t){this._makeChangeUserRequest(o(t.currentTarget).data("id"))})}}},_makeChangeUserRequest:function(t){var e=o("<form/>").attr({action:n.hosts.passportChangeUser,method:"POST",id:"replacer"}),i={uid:t,action:"change_default",yu:n.user.yandexuid,retpath:n.hosts.constructor};for(var s in i)i.hasOwnProperty(s)&&e.append(o("<input/>").attr({type:"hidden",name:s,value:i[s]}));e.appendTo(document.body).submit()}}))}),modules.define("user-data",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this._elem("userpic").domElem;t.css("backgroundImage","url("+t.data("url")+")")}}}}))}),modules.define("page",["yametrika","i-bem-dom","bh","modal","promo"],function(t,e,i,o,n,s,r){t(i.declBlock(r,{applyState:function(t){if("promo"===t){this._promoPopup=i.append(this.domElem,o.apply({block:"modal",mix:[{block:"z-index-group",mods:{level:5}}],zIndexGroupLevel:5,mods:{visible:!0,theme:"custom",autofocus:!0},content:{block:"promo"}})).bem(n);var e=this._promoPopup.findChildBlock(s);this._events(this._promoPopup).on({modName:"visible",modVal:""},function(){this.setMod("step","editor")},this),this._events(e).on("loginRequest",function(t,e){this._login(e)},this)}else this._promoPopup&&i.destruct(this._promoPopup.domElem);this.__base.apply(this,arguments)}}))}),modules.define("promo",["i-bem-dom","config","auth-data","button","modal","popup-close-button"],function(t,e,i,o,n,s,r){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this.findChildBlocks(n),a=t.get(1),c=t.get(0);if(i.user.isUserAuthorized){this.setMod("userAuthorized",!0),e.destruct(a.domElem);var l=this.findParentBlock(s);l.setMod("closable",!0),l.setMod("visible",!1),l.setMod("visible",!0)}else this._events(a).on("click",function(){o.setValue("afterLoginState","openmap"),this._emit("loginRequest",!1)},this),e.destruct(this.findChildBlock(r).domElem);this._events(c).on("click",function(){this.getMod("userAuthorized")?this.findParentBlock(s).setMod("visible",!1):(o.setValue("afterLoginState","newmap"),this._emit("loginRequest",!0))},this)}}}}))}),modules.define("carousel-helper",["i-bem-dom","jquery-bxslider"],function(t,e){var i=".carousel-helper__";t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){var t=this._elem("slider").domElem;t.bxSlider({prevSelector:i+"arrow_direction_left",prevText:" ",nextSelector:i+"arrow_direction_right",nextText:" ",useCSS:!1,touchEnabled:!1,speed:300,pagerCustom:i+"pager"})}}}}))}),modules.define("jquery-bxslider",["loader_type_js","config"],function(t,e,i){i.user.isUserAuthorized&&i.user.hasMaps?t(!0):e(i.baseURL+"res/libs/jquery.bxslider.js",function(){t(!0)})}),modules.define("auth-data",[],function(t){function e(t){return"cnt"+t[0].toUpperCase()+t.slice(1)}t({removeValue:function(t){try{return window.localStorage.removeItem(e(t)),!0}catch(i){return!1}},setValue:function(t,i){try{return window.localStorage.setItem(e(t),i),!0
}catch(o){return!1}},getValue:function(t){try{return window.localStorage.getItem(e(t))}catch(i){return null}},removeSessionValue:function(t){try{return sessionStorage.removeItem(e(t)),!0}catch(i){return!1}},setSessionValue:function(t,i){try{return sessionStorage.setItem(e(t),i),!0}catch(o){return!1}},getSessionValue:function(t){t=e(t);try{var i=sessionStorage.getItem(t);return i}catch(o){return null}}})}),modules.define("page",["i-bem-dom","bh","export-modal","i18n-plus","modal","export-data"],function(t,e,i,o,n,s,r,a){t(e.declBlock(a,{applyState:function(t){var n="export-modal"===t;if(n){if(!this._exportPopup){this._exportPopup=e.append(this.domElem,i.apply({block:"modal",mix:[{block:"z-index-group",mods:{level:6}}],zIndexGroupLevel:6,mods:{theme:"custom",closable:!0,autofocus:!0},content:{block:"export-modal"}})).bem(s),this._events(this._exportPopup).on({modName:"visible",modVal:""},function(){this.setMod("step","editor")},this);var r=this._exportPopup.findChildBlock(o);this._events(r).on("exportData",function(t,e){this.setMod("step","editor"),this._exportToData(e.type,e.options,e.saveToDisk)},this)}this._exportPopup.setMod("visible",!0),this._helpButton.setMod("export-modal-link",!0)}else this._exportPopup&&(this._exportPopup.setMod("visible",!1),this._helpButton.setMod("export-modal-link",!1));this.__base.apply(this,arguments)},showExportPopup:function(){this.setMod("step","export-modal")},_onFileTypeSwitcherChange:function(){var t=this._fileTypeSwitcher.getVal();this.getDataProvider().set("fileType",t)},_exportToData:function(t,e,i){var o=this._mapDataProvider;this._showLoader(),e.sid=o.get("sid"),e.type=t,e.saveToDisk=i;var n=r(o,e),s=Number(new Date);return n.then(function(t){i?this.showNotify("dataSaved"):this.showDownloadPopup(t.blob,t.fileName)},function(t){this.showErrorMessage(t,!0)},function(t){console.log(t.message+" ("+t.step+"/"+t.total+") "+(Number(new Date)-s)),s=Number(new Date),this._setLoaderStatus(t.message)},this),n}}))}),modules.define("export-modal",["i-bem-dom","yametrika","config","modal","radio-group"],function(t,e,i,o,n,s){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){function t(t){this._emit("exportData",{type:this._fileTypeSwitcher.getVal(),options:{separator:this._optionsSwitcher.getVal()},saveToDisk:t})}this._domEvents("save-button").on("click",function(){t.call(this,!0)},this),this._domEvents("download-button").on("click",function(){t.call(this,!1)},this),this._domEvents("download-file-button").on("click",function(){t.call(this,!1)},this);var e=this.findChildBlocks(s);this._fileTypeSwitcher=e.get(0),this._optionsSwitcher=e.get(1),this._events(this._fileTypeSwitcher).on("change",this._onFileTypeSwitch,this),this._onFileTypeSwitch(null),this.setMod("cant-use-disk",!o.user.hasLogin)}}},_onFileTypeSwitch:function(){var t=this._fileTypeSwitcher.getVal(),e=["kml","csv","gpx","geojson","xlsx"];e.forEach(function(e){this._elems(e+"-group").setMod("hidden",t!==e)},this),i.reachGoal("SWITCH_EXPORT_FORMAT",{cnstExportDataFormatView:t})}}))}),modules.define("radio-group",["i-bem-dom","jquery","dom","radio"],function(t,e,i,o,n){var s;t(e.declBlock(this.name,{beforeSetMod:{focused:{"true":function(){return!this.hasMod("disabled")}}},onSetMod:{js:{inited:function(){this._checkedRadio=this.findChildBlock({block:n,modName:"checked",modVal:!0}),this._inSetVal=!1,this._val=this._checkedRadio?this._checkedRadio.getVal():s,this._radios=s}},disabled:function(t,e){this.getRadios().setMod(t,e)},focused:{"true":function(){if(!o.containsFocus(this.domElem))for(var t,e=this.getRadios(),i=0;t=e.get(i++);)if(t.setMod("focused").hasMod("focused"))return},"":function(){var t=this.findChildBlock({block:n,modName:"focused",modVal:!0});t&&t.delMod("focused")}}},getVal:function(){return this._val},setVal:function(t,e){var i=t===s;if(i||(t=String(t)),this._val!==t)if(i)this._val=s,this._checkedRadio.delMod("checked"),this._emit("change",e);else{var o=this._getRadioByVal(t);o&&(this._inSetVal=!0,this._val!==s&&this._getRadioByVal(this._val).delMod("checked"),this._val=o.getVal(),o.setMod("checked"),this._inSetVal=!1,this._emit("change",e))}return this},getName:function(){return this.getRadios().get(0).getName()},getRadios:function(){return this._radios||(this._radios=this.findChildBlocks(n))},_getRadioByVal:function(t){for(var e,i=this.getRadios(),o=0;e=i.get(o++);)if(e.getVal()===t)return e},_onRadioCheck:function(t){var e=(this._checkedRadio=t.target).getVal();this._inSetVal||(this._val===e?(this.getRadios().forEach(function(t){t.getVal()!==e&&t.delMod("checked")}),this._emit("change")):this.setVal(e))},_onRadioFocus:function(t){this.setMod("focused",t.target.getMod("focused"))}},{lazyInit:!0,onInit:function(){var t=this.prototype;this._events(n).on({modName:"checked",modVal:!0},t._onRadioCheck).on({modName:"focused",modVal:"*"},t._onRadioFocus)}}))}),modules.define("radio",["i-bem-dom","control"],function(t,e,i){t(e.declBlock(this.name,i,{onSetMod:{checked:{"true":function(){this._elem("control").domElem.attr("checked",!0).prop("checked",!0)},"":function(){this._elem("control").domElem.removeAttr("checked").prop("checked",!1)}}},_onChange:function(){this.hasMod("disabled")||this.setMod("checked")}},{lazyInit:!0,onInit:function(){return this._domEvents().on("change",this.prototype._onChange),this.__base.apply(this,arguments)}}))}),modules.define("export-data",["vow","yadisk-client","config","i18n-plus","rpc-client","util-string","export-to-csv","export-to-geojson","export-to-gpx","export-to-kml","export-to-xlsx","export-utils","yametrika","exporter"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p,m){function g(t,e,i){this.message=t,this.step=e,this.total=i}function f(t){var e;return e=1===t?n("popup","map_print_loader_step1"):n("popup","map_print_loader_step5"),new g(e,t,b)}function _(t,e){for(var i=0,o=0;o<t.length;o++)e.indexOf(t[o].geometry.type)>-1&&i++;return i}var b=2,v={csv:a,geojson:c,gpx:l,kml:d,xlsx:u},y={csv:"text/csv",geojson:"application/json",gpx:"application/gpx",kml:"application/vnd.google-earth.kml+xml",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},M={csv:["Point"],geojson:["Point","LineString","Polygon"],gpx:["Point","LineString"],kml:["Point","LineString","Polygon"],xlsx:["Point"]};t(function(t,i){var o=[].concat(t.get("geoObjects").getByType("polygon"),t.get("geoObjects").getByType("linestring"),t.get("geoObjects").getByType("point"));p.exportDataStart(i.saveToDisk);var n,s=m(t,{saveToDisk:i.saveToDisk,type:i.type,content:function(){var s=e.defer();return v[i.type](o,i,t).then(function(t){"xlsx"!==i.type?(t=r.removeUtfMagic(t),n=t.length):n=t.byteLength,s.resolve(new Blob([t],{type:y[i.type]}))},function(t){s.reject(t)}),s.promise()},notify:f});return s.then(function(){i.objectCount=_(o,M[i.type]),i.importFormat=t.get("importFormat"),p.exportDataSuccess(i,n)},function(t){t.objectCount=_(o,M[i.type]),t.fileSize=n,p.exportDataFail(i,t)},this),s})}),modules.define("yadisk-client",["vow","jquery","config"],function(t,e,i,o){function n(t,n,s){var a=e.defer();return i.ajax({success:function(t){a.resolve(t)},error:function(t){a.reject(t)},cache:!1,type:t,url:o.hosts.diskAPI+n+"?"+i.param(s),xhrFields:{withCredentials:!0}}),r(a),a.promise()}function s(t,o){var n=e.defer(),s=new FormData;return s.append("file",o),i.ajax({success:function(t){n.resolve(t)},error:function(t){n.reject(t)},data:s,cache:!1,contentType:!1,type:t.method,url:t.href,processData:!1}),r(n),n.promise()}function r(t){var e=window.setTimeout(function(){t.reject({})},a);t.promise().always(function(){e&&(window.clearTimeout(e),e=0)})}var a=18e4,c={getDirectory:function(t){return n("GET","disk/resources",{path:"disk:/"+t})},createDirectory:function(t){return n("PUT","disk/resources",{path:"disk:/"+t})},getOrCreateDirectory:function(t){var i=e.defer();return this.getDirectory(t).then(function(){i.resolve(!0)},function(e){404===e.status?i.resolve(this.createDirectory(t)):i.reject(e)},this),i.promise()},upload:function(t,i){var o=e.defer();return n("GET","disk/resources/upload",{path:"disk:/"+t}).then(function(t){o.resolve(s(t,i))},function(t){o.reject(t)},this),o.promise()}};t(c)}),modules.define("export-to-csv",["vow","i18n-plus"],function(t,e,i){function o(t,e){for(var i,o,s=e.separator,r=[],a=0;a<t.length;a++)"Point"===t[a].geometry.type&&(i=t[a].properties.description,i&&(i='"'+i.split('"').join('""')+'"'),o=t[a].properties.iconCaption,o&&(o='"'+o.split('"').join('""')+'"'),r.push([t[a].geometry.coordinates[1],t[a].geometry.coordinates[0],i,o,t[a].properties.iconContent].join(s)));return r.unshift(n.join(s)),"﻿"+r.join("\n")}var n=i("popup","data_import_table_headers").split(";");t(function(t,i){var n=e.defer();return n.resolve(o(t,i)),n.promise()})}),modules.define("export-to-geojson",["jquery","vow","ymaps-geoObject-colors","util-coordinates","i18n-plus","config"],function(t,e,i,o,n,s,r){function a(t,e){var i={type:"FeatureCollection",metadata:{name:e.mapName,creator:r.export.creator}};e.mapDescription&&(i.metadata.description=e.mapDescription);var o,s=0;return i.features=[],t.forEach(function(t){var r=n.validate(t.geometry);"polygon"===r.type.toLowerCase()&&(r.coordinates=h(r.coordinates)),o={},o.type="Feature",o.id=s++,o.geometry=r,o.properties={},t.properties.description&&(o.properties.description=t.properties.description),t.properties.iconCaption&&(o.properties.iconCaption=t.properties.iconCaption),t.properties.iconContent&&(o.properties.iconContent=t.properties.iconContent),t.options.preset&&c(t.options.preset,o,e.presetStorage,e.sid),i.features.push(o)}),JSON.stringify(i)}function c(t,e,i,n){if("Point"===e.geometry.type){var s=m.exec(t);s&&(e.properties["marker-color"]="#"+o.getColorByName(s[1]))}else t=i[n+"#"+t],t.fillColor&&(e.properties.fill="#"+t.fillColor.slice(0,6),e.properties["fill-opacity"]=l(t.fillColor.slice(6))),e.properties.stroke="#"+t.strokeColor.slice(0,6),e.properties["stroke-width"]=t.strokeWidth,e.properties["stroke-opacity"]=l(t.strokeColor.slice(6))}function l(t){return Number((parseInt(t,16)/255).toFixed(2))}function d(t){return t/180*Math.PI}function u(t){var e=0;if(t.length>2)for(var i,o,n=0;n<t.length-1;n++)i=t[n],o=t[n+1],e+=d(o[0]-i[0])*(2+Math.sin(d(i[1]))+Math.sin(d(o[1])));return e>=0}function h(t){return[u(t[0])?t[0].reverse():t[0]].concat(t.slice(1).map(function(t){return u(t)?t:t.reverse()}))}var p=s("map-selection","no-name-map");t(function(t,e,o){e.sid=o.get("sid"),e.mapName=o.get("mapName")||p,e.mapDescription=o.get("mapDescription"),e.presetStorage=o.getData().presetStorage;var n=i.defer();return n.resolve(a(t,e)),n.promise()});var m=new RegExp("^(?:islands)#("+o.getColorNames().join("|")+")","i")}),modules.define("export-to-gpx",["vow","export-xml-generator","i18n-plus","config"],function(t,e,i,o,n){function s(t,e){var o=i.create(),s=o.node("gpx");s.attr("version","1.1"),s.attr("creator",n.export.creator),s.attr("xmlns","http://www.topografix.com/GPX/1/1"),s.node("metadata").node("name").content(e.mapName,!0).parent.node("desc").content(e.mapDescription,!0).parent.node("time").content((new Date).toISOString());for(var c={point:[],linestring:[]},d=0;d<t.length;d++){var u=t[d].geometry.type.toLowerCase();l[u]&&c[u].push(t[d])}c.point.forEach(function(t){r(t,s)}),c.linestring.forEach(function(t){a(t,s)});var h=o.toXML();return h}function r(t,e){var i=e.node("wpt").attr("lon",t.geometry.coordinates[0]).attr("lat",t.geometry.coordinates[1]);t.properties.iconCaption&&i.node("name").content(t.properties.iconCaption,!0),t.properties.description&&i.node("desc").content(t.properties.description,!0)}function a(t,e){var i=e.node("rte");t.properties.iconCaption&&i.node("name").content(t.properties.iconCaption,!0),t.properties.description&&i.node("desc").content(t.properties.description,!0);for(var o=t.geometry.coordinates,n=0;n<o.length;n++)i.node("rtept").attr("lon",o[n][0]).attr("lat",o[n][1])}var c=o("map-selection","no-name-map");t(function(t,i,o){var n=e.defer();return i.mapName=o.get("mapName")||c,i.mapDescription=o.get("mapDescription"),i.sid=o.get("sid"),n.resolve(s(t,i)),n.promise()});var l={point:r,linestring:a}}),modules.define("export-xml-generator",[],function(t){function e(t){this.children=[],this.encoding=t||"UTF-8"}function i(t){this.content=t?String(t):""}function o(t){this.content=void 0===t?"":t}function n(t,e,i){this.name=t,this.attrs=e||{},this.children=[],this.parent=i}e.prototype.node=function(t,e){var i=new n(t,e,this);return this.children.push(i),i},e.prototype.toXML=function(t){var e='<?xml version="1.0" encoding="'+this.encoding+'"?>\n';return e+this.children.map(function(e){return e.toXML(t)}).join("")},i.prototype.toXML=function(){return"<![CDATA["+this.content+"]]>"},o.prototype.toXML=function(){return this.content},n.prototype={attr:function(t,e){if("object"==typeof t)Object.keys(t).forEach(function(e){this.attrs[e]=t[e]}.bind(this));else{if(void 0===e)return this.attrs[t];this.attrs[t]=e}return this},node:function(t,e){var i=new n(t,e,this);return this.children.push(i),i},content:function(t,e){return this.children=e?[new i(t)]:[new o(t)],this},toXML:function(t){var e="<"+this.name,i=this.attrs,o=Object.keys(i),n=this.children;return o.length&&o.forEach(function(t){e+=" "+t+'="'+String(i[t]).split('"').join('\\"')+'"'}),!n.length||1===n.length&&""===n[0].content?e+="/>":(e+=">",e+=n.map(function(e){return e.toXML(t)}).join(""),e+="</"+this.name+">"),e}},t({create:function(t){return new e(t)}})}),modules.define("export-to-kml",["vow","export-xml-generator","i18n-plus","config","ymaps-geoObject-colors"],function(t,e,i,o,n,s){function r(t,e){var o=i.create(),s=o.node("kml").attr("xmlns","http://www.opengis.net/kml/2.2").node("Document");a(s,e.presetStorage);var r=s.node("ExtendedData");return r.node("Data").attr("name","creator").node("value").content(n.export.creator,!0),s.node("name").content(h(e.mapName),!0).parent.node("description").content(h(e.mapDescription),!0),l(s.node("Folder"),t,e.sid),o.toXML()}function a(t,e){Object.keys(e).forEach(function(i){var o=e[i],n=t.node("Style").attr("id",i.replace(/^.*#/,""));n.node("LineStyle").node("color").content(c(o.strokeColor)).parent.node("width").content(o.strokeWidth?o.strokeWidth.toString():""),"fillColor"in o&&n.node("PolyStyle").node("color").content(c(o.fillColor)).parent.node("fill").content(o.fill?o.fill.toString():"1").parent.node("outline").content(o.outline?o.outline.toString():"1")})}function c(t){return(t.slice(6,8)||"ff")+t.slice(4,6)+t.slice(2,4)+t.slice(0,2)}function l(t,e,i){for(var o,n,s=0;s<e.length;s++)o=e[s],n=t.node("Placemark").node("name").content(h(o.properties.iconCaption),!0).parent.node("description").content(h(o.properties.description),!0).parent,o.options.preset&&d(o.options.preset,n,i),m[o.geometry.type](n,o)}function d(t,e,i){var o=f.exec(t);if(o){var n=o[1]&&g[o[1].toLowerCase()]||"lb",r=c(s.getColorByName(o[1]));e.node("Style").node("IconStyle").node("color").content(r).parent.node("Icon").node("href").content("http://api-maps.yandex.ru/i/0.4/micro/pm"+n+"s.png").parent.parent.node("hotSpot").attr("x","7").attr("y","28").attr("xunits","pixels").attr("yunits","insetPixels")}else{var a=t.split("#");e.node("styleUrl").content("#"+(a[0]===i?a[1]:t))}}function u(t){return t.map(function(t){return t.join(",")}).join(" ")}function h(t){return t?t.replace(/[\n\r]|\r\n|\n\r/g,"<br/>").replace(/&/g,"&amp;"):""}var p=o("map-selection","no-name-map");t(function(t,i,o){i.sid=o.get("sid"),i.mapName=o.get("mapName")||p,i.mapDescription=o.get("mapDescription"),i.presetStorage=o.getData().presetStorage;var n=e.defer();return n.resolve(r(t,i)),n.promise()});var m={Point:function(t,e){t.node("Point").node("coordinates").content(e.geometry.coordinates.join(","))},LineString:function(t,e){t.node("LineString").node("coordinates").content(u(e.geometry.coordinates))},Polygon:function(t,e){var i=t.node("Polygon");i.node("outerBoundaryIs").node("LinearRing").node("coordinates").content(u(e.geometry.coordinates[0])),e.geometry.coordinates.slice(1).forEach(function(t){i.node("innerBoundaryIs").node("LinearRing").node("coordinates").content(u(t))})}},g={blue:"bl",black:"nt",brown:"do",darkblue:"db",darkgreen:"gn",darkorange:"do",gray:"gr",green:"gn",grey:"gr",lightblue:"lb",night:"nt",orange:"or",olive:"yw",pink:"pn",red:"rd",violet:"vv",white:"wt",yellow:"yw"},f=new RegExp("^(?:islands)#("+Object.keys(g).join("|")+")","i")}),modules.define("export-to-xlsx",["vow","util-require-plus","i18n-plus"],function(t,e,i,o){function n(t,e){function i(t,e,i,s,r,a){o["A"+t]={t:"s",v:String(e)},o["B"+t]={t:"s",v:String(i)},s&&(o["C"+t]={t:"s",v:s},3>n&&(n=3)),r&&(o["D"+t]={t:"s",v:r},4>n&&(n=4)),a&&(o["E"+t]={t:"s",v:a},5>n&&(n=5))}var o={},n=2,r=0;i(++r,a[0],a[1],a[2],a[3],a[4]);for(var c=0;c<t.length;c++)"Point"===t[c].geometry.type&&i(++r,t[c].geometry.coordinates[1],t[c].geometry.coordinates[0],t[c].properties.description,t[c].properties.iconCaption,t[c].properties.iconContent);o["!ref"]=s.utils.encode_range({s:{r:0,c:0},e:{r:r-1,c:n-1}});var l={};l[e.mapName]=o;var d=s.write({SheetNames:[e.mapName],Sheets:l},{bookType:"xlsx",bookSST:!1,type:"binary"});return s.utils.s2ab(d)}var s,r=o("map-selection","no-name-map"),a=o("popup","data_import_table_headers").split('"').join("").split(";");t(function(t,o,a){o.mapName=a.get("mapName")||r;var c=e.defer();return i(["xlsx-parser"]).then(function(e){s=e[0],c.resolve(n(t,o))}),c.promise()})}),modules.define("xlsx-parser",["loader_type_js","config"],function(t,e,i){window.XLSX?t(window.XLSX):e(i.baseURL+"res/libs/xlsx.core.min.js",function(){window.XLSX.utils.s2ab=function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),o=0;o!==t.length;++o)i[o]=255&t.charCodeAt(o);return e},t(window.XLSX)})}),modules.define("util-require-plus",["vow"],function(t,e){t(function(t){var i=e.defer();return modules.require(t,function(){i.resolve(arguments)}),i.promise()})}),modules.define("export-utils",[],function(t){function e(t){return t=t.toString(),t.length<2?"0"+t:t}t({generateFileName:function(t,i,o){var n=new Date,s=o.fileName;return s.length>100&&(s=s.substr(0,100)),s=s.replace(/\//g,""),t+i.replace("{map_name}",s).replace("{ss}",e(n.getSeconds())).replace("{mm}",e(n.getMinutes())).replace("{hh}",e(n.getHours())).replace("{dd}",e(n.getDate())).replace("{mo}",e(n.getMonth()+1)).replace("{yy}",e(n.getFullYear()))+"."+o.imageFormat}})}),modules.define("exporter",["vow","i18n-plus","yadisk-client","rpc-client","export-utils"],function(t,e,i,o,n,s){function r(t){return n.checkMapOwner(t.get("sid"))}function a(t,e,i){return s.generateFileName(i?h:"",d,{fileName:e.get("mapName")||u,imageFormat:t})}var c=i("login-form","yadisk_folder_name"),l=i("sidebar","data_export_button"),d=i("login-form","yadisk_file_name_pattern"),u=i("map-selection","no-name-map"),h=c+"/"+l+"/";t(function(t,i){function n(){d.notify(i.notify(++u)),i.content().then(function(e){var n=a(i.type,t,i.saveToDisk);i.saveToDisk?r(t).then(function(){d.notify(i.notify(++u)),o.upload(n,e).then(function(){d.resolve({blob:e,fileName:n})},l)},l):d.resolve({blob:e,fileName:n})},l)}function s(){var t=e.defer();return o.getOrCreateDirectory(c).then(function(){t.resolve(o.getOrCreateDirectory(h))},function(e){t.reject(e)}),t.promise()}function l(t){t=t||{},d.reject(t)}var d=e.defer(),u=0;return i.saveToDisk?r(t).then(function(){s().then(n,l)},l):n(),d.promise()})}),modules.define("page",["i-bem-dom","bh","import-data","import-modal","i18n-plus","modal","yametrika","next-tick"],function(t,e,i,o,n,s,r,a,c,l){t(e.declBlock(l,{applyState:function(t,s){if("import-modal"===t){if(!this._importPopup){this._importPopup=e.append(this.domElem,i.apply({block:"modal",mix:[{block:"z-index-group",mods:{level:6}},{block:"page",elem:"import-modal"}],zIndexGroupLevel:6,mods:{theme:"custom",closable:!0,autofocus:!0,transparent:!0},content:{block:"import-modal",mods:{step:"load"}}})).bem(r);var c=this._importPopup.findChildBlock(n);this._importPopup.setMod("step","load"),this._events(c).on({modName:"step",modVal:"*"},function(t,e){this._importPopup.setMod("step",e.modVal),this._importPopup.setMod("closable","load"===e.modVal)},this),this._events(c).on("analyseFile",function(t,e){this._analyseImportFile(e.file)},this).on("importData",this._importData,this).on("showErrors",function(){this._importPopup.setMod("returnToMapList",!1);var t=o.getErrorsFile();this.showDownloadPopup(t.blob,t.name)},this),this._events(this._importPopup).on({modName:"visible",modVal:""},function(){var t=c.getMod("step"),e=this.getMod("step");"status"===t&&"import-modal"===e?a.import("cancel","limits"):"load"!==t||c.getMod("fileSelected")||a.import("cancel","file_upload"),"notify"!==e&&("import-modal"===e&&"status"===t&&this._teardownBeforeUnload(),c.setMod("step","load"));var i=this._importPopup.getMod("returnToMapList");"import-modal"===e&&i?(this.setMod("step","mapselection"),this._importPopup.setMod("returnToMapList",!1)):this.setMod("step","editor")},this)}this._importPopup.setMod("visible",!0),"mapselection"===s&&this._importPopup.setMod("returnToMapList","mapselection"===s),"load"===this._importPopup.getMod("step")&&a.import("start")}else this._importPopup&&this._importPopup.setMod("visible",!1);this.__base.apply(this,arguments)},showImportPopup:function(){this.setMod("step","import-modal")},_analyseImportFile:function(t){var e=o.analyse(t);a.import("analyseStart"),e.then(function(t){a.import("analyse",t)},function(t){a.import("analyseError",t)}),this.setMod("step","editor"),this._showLoader(),this._setLoaderStatus(s("popup","data_import_step1")),e.then(function(t){this._hideLoader();var e=this._importPopup.findChildBlock(n);this._setupBeforeUnload(),e.showAnalysed(t),"load"!==e.getMod("step")&&(this.setMod("step","import-modal"),a.import("importLimits",t))},function(t){this.showNotify(t.code,"import-modal")},function(t){this._setLoaderStatus(t)},this)},_importData:function(){var t=o.importObjects(this._mapDataProvider);a.import("importStart"),t.then(function(t){a.import("import",t,this._mapDataProvider)},function(t){a.import("importError",t)},this),this.setMod("step","editor"),this._showLoader(),this._setLoaderStatus(s("popup","data_import_step3")),t.then(function(){this._hideLoader(),this._teardownBeforeUnload(),this._importPopup.setMod("returnToMapList",!1)},function(t){this.showNotify(t)},function(t){this._setLoaderStatus(t)},this)},_setupBeforeUnload:function(){window.addEventListener("beforeunload",this._beforeUnloadHander,this)},_teardownBeforeUnload:function(){window.removeEventListener("beforeunload",this._beforeUnloadHander,this)},_beforeUnloadHander:function(t){t.returnValue=s("map-selection","close-editor-confirm"),t.preventDefault()},selectMap:function(){this._mapDataProvider&&!this._mapDataProvider.get("sid")&&a.import("cancel","view"),this.__base.apply(this,arguments)}}))}),modules.define("import-data",["vow","ymaps-api","util-string","simplify-line","config","i18n-plus","import-csv","import-geojson","import-gpx","import-xlsx","import-kml","history-manager"],function(t,e,i,o,n,s,r,a,c,l,d,u,h){function p(t,e){t.reject({code:e,type:g.originExt})}function m(t){var e=t.name.split(".");return e=e[e.length-1].toLowerCase(),g.originExt=e,f[e]}var g,f={csv:a,json:c,geojson:c,gpx:l,kml:u,xlsx:d,xls:d,xlsm:d,xlsb:d};t({analyse:function(t){var i=e.defer();if(g={},g.step=0,g.name=t.name,g.parser=m(t),!g.parser)return p(i,"fileTypeError"),i.promise();var n=new FileReader;return n.addEventListener("load",function(t){i.notify(r("popup","data_import_step2"));var e=t.target.result;g.parser!==d&&(e=o.removeUtfMagic(e)),g.parser.analyse(e).then(function(t){g.data=t,i.resolve(t)},function(t){p(i,t)})}),n.addEventListener("error",function(){p(i,"fileTypeError")}),g.parser===d?n.readAsDataURL(t):n.readAsText(t),i.promise()},simplify:function(){g.data.simplify.forEach(function(t){var e=t.geometry;e.coordinates=n(e.coordinates,s.limits.count.vertexes)})},importObjects:function(t){var i=e.defer(),o=t.get("geoObjects");return t.set("importFormat",g.originExt),g.parser.convert(g.data.analysed).then(function(e){i.notify(r("popup","data_import_step4")),this.simplify(),i.notify(r("popup","data_import_step5"));var n;t.get("mapName")||(n=g.data.mapName?g.data.mapName:r("popup","data_import_mapname",{name:g.name}),t.set("mapName",n));var s;!t.get("mapDescription")&&g.data.mapDescription&&t.set("mapDescription",s=g.data.mapDescription),e.length>0?(o.addGeoObjects(e),this.setBounds(t).always(function(){i.resolve(g.data)})):i.resolve(g.data),(n||s)&&h.importChangeMap({mapName:{newVal:n,oldVal:""},mapDescription:{newVal:s||"",oldVal:""}})},function(){p(i,"import")},this),i.promise()},setBounds:function(t){var e=i.util.bounds.fromPoints(g.data.points),o=i.util.bounds.getCenterAndZoom(e,t.get("currentContainerSize"));return i.getZoomRange(t.get("type"),o.center).then(function(e){var i=Math.max(Math.min(o.zoom,e[1]),e[0]);t.set("center",o.center),t.set("zoom",i)})},getErrorsFile:function(){var t=g.name.split(".");return t.pop(),t.push(g.data.type),{blob:g.parser.getErrors(g.data.errors,g.data),name:[r("popup","errors_file_name"),"_",t.join(".")].join("")}}})}),modules.define("simplify-line",["ymaps-geoCoords"],function(t,e){function i(t,i,o){function s(t,e){for(var i=1;i<t.length-1&&!(t[i][2]<p&&(p=t[i][2],u=i,h=e,0===p));i++);}if(i>o)return t;for(var a,c=[],l=0;l<t.length;l++)if(0!==t[l].length){a=[e.geoToPixels(t[l][0],r),e.geoToPixels(t[l][1],r)],c.push(a);for(var d=1;d<t[l].length-1;d++)a[d+1]=e.geoToPixels(t[l][d+1],r),a[d][2]=n(a[d-1],a[d],a[d+1]),a[d][3]=d}for(var u,h,p,m=t.map(function(t){return t.map(function(){return!0})});o>i;)p=1/0,c.forEach(s),a=c[h],m[h][a[u][3]]=!1,a.splice(u,1),1!==u&&(a[u-1][2]=n(c[h][u-2],c[h][u-1],c[h][u])),u!==a.length-1&&(a[u][2]=n(a[u-1],a[u],a[u+1])),o--;return t.map(function(t,e){return t.filter(function(t,i){return m[e][i]})}).filter(function(t){return t.length>2})}function o(t,e,i,o){return Math.sqrt(Math.pow(t-i,2)+Math.pow(e-o,2))}function n(t,e,i){var n=o(t[0],t[1],e[0],e[1]),s=o(e[0],e[1],i[0],i[1]),r=o(i[0],i[1],t[0],t[1]),a=(n+s+r)/2;return Math.sqrt(a*(a-n)*(a-s)*(a-r))}function s(t){return t.reduce(function(t,e){return t+e.length-1},0)}t(function(t,e){return Array.isArray(t[0][0])?i(t,e,s(t)):i([t],e,t.length)[0]});var r=0}),modules.define("import-csv",["vow","import-helper","config"],function(t,e,i,o){function n(t,e){for(var i=[],o=0,n=!0;o<t.length;)t[o]===e&&n&&i.push(o),'"'===t[o]&&('"'===t[o+1]?o++:n=!n),o++;return i}function s(t,e){var i=0;return n(t,e).map(function(e){var o=t.substring(i,e);return i=e+1,o}).concat([t.substring(i)])}function r(t){return t&&(t=t.trim()),t?'"'===t[0]&&'"'===t[t.length-1]?t.substr(1,t.length-2).split('""').join('"'):t:""}function a(t){var e=c(t,"	"),i=c(t,","),o=c(t,";"),n=Math.max(e,i,o);return n===o?";":n===i?",":"	"}function c(t,e){for(var i=0,o=0,n=!0;o<t.length;)t[o]===e&&n&&i++,'"'===t[o]&&('"'===t[o+1]?o++:n=!n),o++;return i}t({analyse:function(t){var n={type:"csv",analysed:[],limitObjectsReached:!1,limitVerticesReached:!1,errors:[],points:[],simplify:[],meta:{point:0,linestring:0,polygon:0,total:0}};t=t.split("\n\r").join("\n");var r,c,l=a(t),d=s(t,"\n"),u=d.length;for(n.meta.total=u;u--;)if(""!==d[u]){if(n.analysed.length>=o.limits.count.geoObjects){n.limitObjectsReached=!0;break}r=s(d[u],l),r.length<2?n.errors.push(d[u]):i.isHeaderRow(r)?--n.meta.total:(c=i.checkPointCoords(r[1].split(",").join("."),r[0].split(",").join(".")),c?(r[0]=c[0],r[1]=c[1],n.analysed.push(r),n.points.push(c)):n.errors.push(d[u]))}else--n.meta.total;return 0===n.points.length&&n.errors.length>0?e.reject("fileTypeError"):(n.errors.length+n.analysed.length>o.limits.count.geoObjects&&(n.limitObjectsReached=!0),n.success=n.analysed.length,n.meta.point=n.analysed.length,e.resolve(n))},convert:function(t){return e.resolve(t.map(function(t){return i.createGeoObject({type:"Point",coordinates:[t[0],t[1]],balloonContent:r(t[2]),placemarkCaption:r(t[3]),placemarkNumber:r(t[4])})}).reverse())},getErrors:function(t){return new Blob([t.join("\n")],{type:"text/csv"})},fileExtension:"csv"})}),modules.define("import-helper",["ymaps-preset-utils","ymaps-geoObject-colors","map-data-default","ymaps-api","config"],function(t,e,i,o,n,s){function r(t){t=c(t).slice(0,6);var e=i.getIndexByColor(i.getNearestColor(t));return i.getNameByIndex(e)}function a(t,e){t=c(t);var o=t.slice(6);return o||(o=e),i.getNearestColor(t.slice(0,6))+o}function c(t){return"#"===t[0]&&(t=t.substr(1)),t.length<=4&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]+(t[3]?t[3]+t[3]:"")),t}function l(t){return/^#?(?:[0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/.test(t)}o=o.getDefaultMapOptions({templateLayoutFactory:{createClass:function(){}}});var d=o.geoObjectStrokeColor,u=o.geoObjectFillColor,h=o.geoObjectStrokeWidth,p=d.slice(6),m=u.slice(6),g="blue",f=["Широта; Долгота","Latitude; Longitude"],_=["See documentation on template usage:","Прочитайте, как заполнить шаблон:"];t({isValidCoordinate:function(t){return!isNaN(t)&&null!==t},isHeaderRow:function(t){t=t.slice(0,2).map(function(t){return t&&String(t).split('"').join("")});var e=-1!==f.indexOf(t.join("; ")),i=-1!==_.indexOf(t[0]);return e||i},checkPointCoords:function(t,e){return this.isValidCoordinate(t)&&this.isValidCoordinate(e)?(t=Number(t),(-180>t||t>180)&&(t=n.util.math.cycleRestrict(t,-180,180)),[t,Math.max(Math.min(e,90),-90)]):null},createGeoObject:function(t){var i={geometry:{type:t.type,coordinates:t.coordinates},properties:{},options:{}};if(t.balloonContent&&(i.properties.description=t.balloonContent.substr(0,s.limits.size.iconDescription)),"Point"===t.type){var o;t.hasOwnProperty("placemarkNumber")&&(o=parseInt(t.placemarkNumber,10),(o>999||0>o)&&(o=void 0)),isNaN(o)||(i.properties.iconContent=String(o)),t.placemarkCaption&&(i.properties.iconCaption=t.placemarkCaption.substr(0,s.limits.size.iconCaption));var n=l(t.iconColor)?r(t.iconColor):g;i.options.preset="islands#"+n+"Icon"}else{var c={};if(c.strokeColor=l(t.strokeColor)?a(t.strokeColor,p):d,void 0===t.strokeWidth)c.strokeWidth=h;else{var f=Math.min(Math.max(t.strokeWidth,0),99);c.strokeWidth=isNaN(f)?0:f}"Polygon"===t.type&&(c.fillColor=l(t.fillColor)?a(t.fillColor,m):u),i.options.preset=e.generatePresetByData(c)}return i}})}),modules.define("import-geojson",["vow","import-helper","config","ymaps-geoObject-colors","map-data-default"],function(t,e,i,o,n,s){function r(t){return t?t.toString():t}function a(t){t=Math.min(Math.max(t,0),1);var e=Math.round(255*t).toString(16);return 1===e.length?"0"+e:e}function c(t){return t.length>=2&&t.every(function(e,o){return e=i.checkPointCoords(e[0],e[1]),e?(t[o]=e,!0):!1})}function l(t){for(var e=[],i=0;i<t.length;i++){if(!c(t[i])||t[i].length<3)return!1;e=e.concat(t[i])}return e}s=s.getDefaultMapOptions({templateLayoutFactory:{createClass:function(){}}});var d=s.geoObjectFillColor.slice(0,6),u=s.geoObjectStrokeColor.slice(0,6),h=["Point","LineString","Polygon"];t({analyse:function(t){var n=e.defer(),s={type:"geojson",analysed:[],limitObjectsReached:!1,limitVerticesReached:!1,errors:[],points:[],simplify:[],meta:{point:0,linestring:0,polygon:0,total:0}};try{var p,m=JSON.parse(t);if(m.features){m.metadata&&(m.metadata.creator===o.export.creator&&(s.fromConstructor=!0),m.metadata.name&&(s.mapName=m.metadata.name),m.metadata.description&&(s.mapDescription=m.metadata.description)),s.meta.total=m.features.length;for(var g=0;g<s.meta.total;g++)if(p=m.features[g],p.geometry)if(-1===h.indexOf(p.geometry.type))s.errors.push(p);else{if(s.analysed.length>=o.limits.count.geoObjects){s.limitObjectsReached=!0;break}var f=p.properties||{},_={type:p.geometry.type,coordinates:p.geometry.coordinates,balloonContent:r(f.description),placemarkCaption:r(f.iconCaption),placemarkNumber:r(f.iconContent)};f.name&&f.name!==f.description&&(_.balloonContent=void 0===f.description?f.name:f.name+"\n\r"+_.balloonContent),p.options&&(_.iconColor=p.options.iconColor||p.options.color);var b=p.geometry.type;"Point"===b?(f.hasOwnProperty("marker-color")&&(_.iconColor=f["marker-color"]),s.meta.point++):(s.meta[b.toLowerCase()]++,f.hasOwnProperty("fill")&&(_.fillColor=f.fill),f.hasOwnProperty("fill-opacity")&&(_.fillColor||(_.fillColor=d),_.fillColor+=a(f["fill-opacity"])),f.hasOwnProperty("stroke")&&(_.strokeColor=f.stroke),f.hasOwnProperty("stroke-opacity")&&(_.strokeColor||(_.strokeColor=u),_.strokeColor+=a(f["stroke-opacity"])),f.hasOwnProperty("stroke-width")&&(_.strokeWidth=f["stroke-width"]));
var v=i.createGeoObject(_);if("LineString"===_.type){if(!c(_.coordinates)){s.errors.push(p);continue}s.points=s.points.concat(_.coordinates),_.coordinates.length>o.limits.count.vertexes&&(s.simplify.push(v),s.limitVerticesReached=!0)}else if("Polygon"===_.type){var y=l(_.coordinates);if(!y){s.errors.push(p);continue}s.points=s.points.concat(y);var M=y.length-_.coordinates.length;M>o.limits.count.vertexes&&(s.simplify.push(v),s.limitVerticesReached=!0)}else{var j=i.checkPointCoords(_.coordinates[0],_.coordinates[1]);if(!j){s.errors.push(p);continue}s.points.push(j),v.geometry.coordinates=j}s.analysed.push(v)}else s.errors.push(p);s.errors.length+s.analysed.length>o.limits.count.geoObjects&&(s.limitObjectsReached=!0),n.resolve(s)}else n.reject("fileTypeError")}catch(I){n.reject("fileTypeError")}return s.success=s.analysed.length,n.promise()},convert:function(t){return e.resolve(t)}})}),modules.define("import-gpx",["vow","import-helper","config","ymaps-geoObject-colors"],function(t,e,i,o,n){function s(t,e){for(var i,o=t.getElementsByTagName(e),n=0;n<o.length;n++)if(o[n].parentNode===t){i=o[n];break}return i?i.innerHTML?i.innerHTML.indexOf("<![CDATA[")>-1?i.textContent.trim():i.innerHTML.trim():i.textContent?i.textContent.trim():"":void 0}var r=n.getColorByName("darkblue")+"e6";t({analyse:function(t){var n=e.defer(),a={type:"gpx",analysed:[],limitObjectsReached:!1,limitVerticesReached:!1,errors:[],points:[],simplify:[],meta:{point:0,linestring:0,polygon:0,total:0}};if(t=(new DOMParser).parseFromString(t.split("&nbsp").join(" "),"application/xml"),t&&t.documentElement&&"parsererror"!==!t.documentElement.nodeName&&t.querySelector("gpx")){var c=t.querySelector("gpx > name, gpx > metadata > name");c&&(a.mapName=c.textContent.trim()),c=t.querySelector("gpx > desc, gpx > metadata > desc"),c&&(a.mapDescription=c.textContent.trim());var l=t.querySelector("gpx").getAttribute("creator");l===o.export.creator&&(a.fromConstructor=!0);var d,u,h,p=t.getElementsByTagName("wpt");for(a.meta.total=p.length,h=0;h<p.length;h++){if(a.analysed.length>=o.limits.count.geoObjects)return a.limitObjectsReached=!0,a.success=a.analysed.length,a.meta.point=a.analysed.length,n.resolve(a),n.promise();d=p[h],u=i.checkPointCoords(d.getAttribute("lon"),d.getAttribute("lat")),u?(a.points.push(u),a.analysed.push(i.createGeoObject({type:"Point",coordinates:u,placemarkCaption:s(d,"name"),balloonContent:s(d,"desc")})),a.meta.point++):a.errors.push(d)}var m=t.querySelectorAll("trk, rte"),g=function(t,e){return u=i.checkPointCoords(e.getAttribute("lon"),e.getAttribute("lat")),u&&(t.push(u),a.points.push(u)),t};for(a.meta.total+=m.length,h=0;h<m.length;h++){if(a.analysed.length>=o.limits.count.geoObjects){a.limitObjectsReached=!0;break}if(d=m[h],p=d.getElementsByTagName(d.nodeName+"pt"),p.length<1)a.errors.push(d);else if(p=[].reduce.call(p,g,[]),p.length<1)a.errors.push(d);else{var f=s(d,"name"),_=s(d,"desc")||f;f&&f!==_&&(_=f+"\n\r"+_);var b={type:"LineString",coordinates:p,balloonContent:_};"trk"===d.nodeName&&(b.strokeColor=r);var v=i.createGeoObject(b);p.length>o.limits.count.vertexes&&(a.simplify.push(v),a.limitVerticesReached=!0),a.analysed.push(v),a.meta.linestring++}}a.errors.length+a.analysed.length>o.limits.count.geoObjects&&(a.limitObjectsReached=!0),a.success=a.analysed.length,n.resolve(a)}else n.reject("fileTypeError");return n.promise()},convert:function(t){return e.resolve(t)}})}),modules.define("import-xlsx",["vow","import-helper","util-require-plus","config"],function(t,e,i,o,n){function s(t,e,o){if(!t["!ref"])return null;var s=[],a=Number(t["!ref"].replace(/^[A-Z]+\d+\:[A-Z]+/gi,""));e.meta.total+=a;for(var c=0,l=1;a>=l;l++)if(r(t,l))--e.meta.total;else if(t["A"+l]&&i.isHeaderRow([t["A"+l].v,(t["B"+l]||{}).v]))--e.meta.total;else{if(e.success>=n.limits.count.geoObjects){e.limitObjectsReached=!0;break}if(t["A"+l]&&t["B"+l]){var d=i.checkPointCoords(t["B"+l].v,t["A"+l].v);d?(c++,e.success++,e.points.push(d),s.push(l)):e.errors.push([l,o])}else e.errors.push([l,o])}return c>n.limits.count.geoObjects&&(e.limitObjectsReached=!0),e.meta.point+=c,s}function r(t,e){return["A","B","C","D","E"].every(function(i){return void 0===t[i+e]})}var a;t({analyse:function(t){var i={type:"xlsx",success:0,analysed:[],total:0,limitObjectsReached:!1,limitVerticesReached:!1,errors:[],points:[],simplify:[],meta:{point:0,linestring:0,polygon:0,total:0}},n=e.defer();return o(["xlsx-parser"]).then(function(e){a=e[0];var o=a.read(t.split("base64,")[1],{type:"base64"});Object.keys(o.Sheets).forEach(function(t){var e=o.Sheets[t],n=s(e,i,t);n&&i.analysed.push({sheet:e,analysis:n})}),i.workbook=o,0===i.points.length&&i.errors.length>0?n.reject("fileTypeError"):n.resolve(i)}),n.promise()},convert:function(t){return e.resolve(t.reduce(function(t,e){return t.concat(e.analysis.map(function(t){var o=e.sheet["C"+t]&&e.sheet["C"+t].v,n=e.sheet["D"+t]&&e.sheet["D"+t].v,s=e.sheet["E"+t]&&e.sheet["E"+t].v;return o&&(o=String(o)),n&&(n=String(n)),s&&(s=String(s)),i.createGeoObject({type:"Point",coordinates:i.checkPointCoords(e.sheet["B"+t].v,e.sheet["A"+t].v),balloonContent:o,placemarkCaption:n,placemarkNumber:s})}))},[]))},getErrors:function(t,e){var i={SheetNames:[],Sheets:{}},o={};return t.forEach(function(t,n){var s=t[0],r=t[1];if(!o[r]){i.Sheets[r]={},i.SheetNames.push(r);var a=e.workbook.Sheets[r]["!ref"].replace(/^[A-Z]+\d+\:/gi,"").replace(/\d+$/gi,"");(a[0]<"A"||a[0]>"Z")&&(a="Z"),o[r]={maxCol:a,actualMaxCol:"A",rows:0}}var c=String.fromCharCode("A".charCodeAt(0)-1);for(n++;c<o[r].maxCol;){c=String.fromCharCode(c.charCodeAt(0)+1);var l=e.workbook.Sheets[r][c+s];l&&(c>o[r].actualMaxCol&&(o[r].actualMaxCol=c),i.Sheets[r][c+n]=l)}o[r].rows++}),i.SheetNames.forEach(function(t){i.Sheets[t]["!ref"]=a.utils.encode_range({s:{c:0,r:0},e:{c:o[t].actualMaxCol.charCodeAt(0)-"A".charCodeAt(0),r:o[t].rows-1}})}),new Blob([a.utils.s2ab(a.write(i,{bookType:"xlsx",bookSST:!1,type:"binary"}))],{type:"application/vnd.ms-excel"})},fileExtension:"xlsx"})}),modules.define("import-kml",["vow","import-helper","config","ymaps-geoObject-colors"],function(t,e,i,o,n){function s(t,e){return t+e.length-1}function r(t){return t.getElementsByTagName("Point")[0]||t.getElementsByTagName("LineString")[0]||t.getElementsByTagName("Polygon")[0]}function a(t){var e=[];t=t.trim().replace(/\s+/g," ").split(" ");var o=t.every(function(t){return""===t?!0:(o=t.split(","),o=i.checkPointCoords(o[0],o[1]),o?(e.push(o),!0):!1)});return o?e:null}function c(t,e,i,o){var n=t.querySelector("Style, StyleMap");if(n)return void l(n,e,i,o);if(n=t.querySelector("styleUrl")){var s=i[n.textContent.substr(1)];s&&["iconColor","fillColor","strokeColor","strokeWidth"].forEach(function(t){void 0!==s[t]&&(e[t]=s[t])})}}function l(t,e,i,o){var s;if("stylemap"===t.tagName.toLowerCase()){s=t.getAttribute("id");var r,a=t.getElementsByTagName("Pair"),c=!1;if(Array.prototype.forEach.call(a,function(t){var e=t.getElementsByTagName("key")[0].textContent;"normal"===e?(r=t.getElementsByTagName("styleUrl")[0].textContent,c=!0):e||c||(r=t.getElementsByTagName("styleUrl")[0].textContent)}),!r)return;if(r=r.substr(1),t=o.querySelector("Style[id="+r+"]"),!t)return}var l,u=t.querySelector("IconStyle");if(u){if(l=u.querySelector("href"),l&&m.test(l.textContent)){var h=p[l.textContent.match(m)[1]];e.iconColor=n.getColorByName(h)}l=u.querySelector("color"),l&&(e.iconColor=d(l.textContent))}u=t.querySelector("LineStyle"),u&&(l=u.querySelector("color"),l&&(e.strokeColor=d(l.textContent)),l=u.querySelector("width"),l&&(e.strokeWidth=Number(l.textContent))),u=t.querySelector("PolyStyle"),u&&(l=u.querySelector("color"),l&&(e.fillColor=d(l.textContent)));var g=t.getAttribute("id");g&&(i[g]=e),s&&(i[s]=e)}function d(t){return t.slice(6,8)+t.slice(4,6)+t.slice(2,4)+t.slice(0,2)}function u(t,e){if(t=t.querySelector(e),!t)return"";var i=t.innerHTML;return!i||i.indexOf("<![CDATA[")>-1?i=t.textContent.trim():(i=i.trim(),i=i.replace(/&amp;/gi,"&"),i=i.split(' xmlns="http://www.opengis.net/kml/2.2"').join(""),i=i.split("<br/>").join("\n")),i}var h={Point:function(t,e){var o=t.getElementsByTagName("coordinates")[0];if(!o)return null;var n=o.textContent.split(",");return n=i.checkPointCoords(n[0],n[1]),n&&e.points.push(n),n},LineString:function(t,e){var i=t.getElementsByTagName("coordinates")[0];if(!i)return null;var o=a(i.textContent);return!o||o.length<2?null:(e.points=e.points.concat(o),o)},Polygon:function(t,e){var i=t.querySelector("outerBoundaryIs coordinates");if(!i)return null;var o=[],n=a(i.textContent);if(!n||n.length<3)return null;e.points=e.points.concat(n),o.push(n);var s=Array.prototype.every.call(t.querySelectorAll("innerBoundaryIs coordinates"),function(t){return n=a(t.textContent),!n||n.length<3?!1:(e.points=e.points.concat(n),o.push(n),!0)});return s?o:null}};t({analyse:function(t){var n=e.defer(),a={type:"kml",analysed:[],limitObjectsReached:!1,limitVerticesReached:!1,errors:[],points:[],simplify:[],stylePresets:{},meta:{point:0,linestring:0,polygon:0,total:0}};try{if(t=(new DOMParser).parseFromString(t.split("&nbsp").join(" "),"application/xml"),t.getElementsByTagName("parsererror").length)n.reject("fileTypeError");else{[].forEach.call(t.querySelectorAll("Style[id], StyleMap[id]"),function(e){l(e,{},a.stylePresets,t)});var d=u(t,'ExtendedData > Data[name="creator"] > value');d&&(a.fromConstructor=!0),a.mapName=u(t,"Document > name"),a.mapName||(a.mapName=u(t,"Folder > name")),a.mapDescription=u(t,"Document > description"),a.mapDescription||(a.mapDescription=u(t,"Folder > description"));var p=t.querySelectorAll("Placemark");a.meta.total=p.length;for(var m=0;m<p.length;m++){if(a.analysed.length>=o.limits.count.geoObjects){a.limitObjectsReached=!0;break}var g=r(p[m]);if(g){var f=h[g.nodeName](g,a);if(!f){a.errors.push(p[m]);continue}var _={type:g.nodeName,coordinates:f};a.meta[g.nodeName.toLowerCase()]++,_.balloonContent=u(p[m],"description");var b=u(p[m],"name");b&&("Point"===_.type?_.placemarkCaption=b:b!==_.balloonContent&&(_.balloonContent=_.balloonContent?b+"\n\r"+_.balloonContent:b)),c(p[m],_,a.stylePresets,t);var v,y=i.createGeoObject(_);"LineString"===_.type?v=f.length:"Polygon"===_.type&&(v=f.reduce(s,0)),"Point"!==_.type&&v>o.limits.count.vertexes&&(a.limitVerticesReached=!0,a.simplify.push(y)),a.analysed.push(y)}else a.errors.push(p[m])}a.errors.length+a.analysed.length>o.limits.count.geoObjects&&(a.limitObjectsReached=!0),a.success=a.analysed.length,n.resolve(a)}}catch(M){n.reject("fileTypeError")}return n.promise()},convert:function(t){return e.resolve(t)}});var p={bl:"blue",nt:"black","do":"brown",db:"darkblue",gr:"gray",gn:"darkGreen",lb:"lightblue",or:"orange",pn:"pink",rd:"red",vv:"violet",wt:"white",yw:"yellow"},m=new RegExp(["^http://api-maps.yandex.ru/i/0.4/micro/pm(",Object.keys(p).join("|"),")s.png$"].join(""),"i")}),modules.define("history-manager",["ymaps-api","config"],function(t,e,i){function o(t,e,i,o){var n=e.get("drawingController"),s=e.get("geoObjects");s.addGeoObjects(t.map(function(t,e){return t=t.data,t.properties.source="history",t.geometry=o[e],t.options.preset=i[e],t}),!0),t.forEach(function(t){t=t.data,s.reorderGeoObject(t.properties.geoObjectId,t.options.zIndex,!0)}),e.set("activeGeoObjectsIds",[]),e.set("geoObjectsWithBalloonIds",[]),e.set("activeGeoObjectsIds",[t[0].data.properties.geoObjectId]),e.set("geoObjectsWithBalloonIds",[t[0].data.properties.geoObjectId]),e.set("drawingController",n)}function n(t,e){e.get("geoObjects").removeGeoObjects(t.map(function(t){return t.id})),e.set("activeGeoObjectsIds",[])}function s(t){var e=t.geometry.coordinates;return e="polygon"===t.geometry.type.toLowerCase()?e.map(function(t){return t.map(function(t){return t.slice()})}):e.slice(),{coordinates:e,type:t.geometry.type}}function r(t){var i=t.options.preset;return i?0===i.indexOf("id")||i.indexOf("stroke")>-1?e.option.presetStorage.get(i):{preset:t.options.preset}:t.options}var a={events:new e.event.Manager,setDataProvider:function(t){this._dataProvider=t,this._undoStack=[],this._redoStack=[],this._freeze=!1,this._undoRedoFreeze=!1,t.createListener().add("geoObjectsWithBalloonIds",function(t){var e=this._getLastItem();!t.length&&e&&"geoObjectData"===e.type&&"style"===e.data.prop&&(e.complete=!0)},this).add("draggingGeoObject",function(e){if(e){var i=t.get("geoObjects").get(e);this.pushItem({type:"geoObjectData",id:e,complete:!1,data:{prop:"geometry",oldVal:{geometry:s(i)},newVal:{geometry:i.geometry}}})}else{var o=this._getLastItem();o.complete=!0,o.data.newVal.geometry=s(o.data.newVal)}},this),t.get("geoObjects").events.group().add("geoObjectsAdd",function(t){var e=t.get("geoObjectsData");this.pushItem({type:"geoObject",action:"add",data:e,presets:e.map(function(t){return t.data.options.preset}),coords:e.map(function(t){return s(t.data)})})},this).add("geoObjectsRemove",function(t){var e=t.get("geoObjectsData");this.pushItem({type:"geoObject",action:"remove",data:e,presets:e.map(function(t){return t.data.options.preset}),coords:e.map(function(t){return s(t.data)})})},this).add("geoObjectsUpdate",function(e){var i=e.get("updates"),o=e.get("oldGeoObjectsData");e.get("geoObjectsData").forEach(function(e,n){var s=i[n].data;if(!t.get("draggingGeoObject")){var a=o[n].data,c=this._getLastItem();if(!s.properties){var l;s.geometry?l="geometry":s.options&&(l="style"),(!c||"geoObjectData"!==c.type||c.complete||c.data.prop!==l)&&(c={type:"geoObjectData",id:e.id,complete:!1},s.geometry?(c.data={prop:l,oldVal:{geometry:a.geometry}},c.complete=!0):s.options&&(c.data={prop:l,oldVal:{options:r(a)}}),this.pushItem(c)),s.geometry?c.data.newVal={geometry:s.geometry}:s.options&&(c.data.newVal={options:r(s)})}}},this)},this)},_dataProvider:null,_undoStack:null,_redoStack:null,_freeze:!0,_undoRedoFreeze:!0,undo:function(){var t=this._undoStack.pop(),e=this._actionTypes[t.type];this._freeze=!0,e.undo.call(this,t,this._dataProvider),this._freeze=!1,this._redoStack.push(t),this.events.fire("undo"),t.onUndo&&t.onUndo(this._dataProvider)},redo:function(){var t=this._redoStack.pop(),e=this._actionTypes[t.type];this._freeze=!0,e.redo.call(this,t,this._dataProvider),this._freeze=!1,this._undoStack.push(t),this.events.fire("redo"),t.onRedo&&t.onRedo(this._dataProvider)},pushItem:function(t){return this._freeze?void 0:(this._undoStack.push(t),this._redoStack=[],this.events.fire("push"),this._undoStack.length>i.limits.count.history&&this._undoStack.shift(),t)},can:function(t){return this._undoRedoFreeze?!1:"undo"===t?this._undoStack.length>0:"redo"===t?this._redoStack.length>0:void 0},_getLastItem:function(){return this._undoStack[this._undoStack.length-1]},_actionTypes:{dataProviderProperty:{undo:function(t,e){e.set(t.prop,t.oldVal)},redo:function(t,e){e.set(t.prop,t.newVal)}},geoObject:{undo:function(t,e){"add"===t.action?n(t.data,e):o(t.data,e,t.presets,t.coords)},redo:function(t,e){"add"===t.action?o(t.data,e,t.presets,t.coords):n(t.data,e)}},geoObjectData:{undo:function(t,e){var i=e.get("geoObjects"),o=e.get("drawingController");i.updateGeoObjects([{id:t.id,data:t.data.oldVal}]);var n=e.get("activeGeoObjectsIds");n.length&&n[0]===t.id||(e.set("activeGeoObjectsIds",[]),e.set("activeGeoObjectsIds",[t.id]),e.set("drawingController",o))},redo:function(t,e){var i=e.get("geoObjects"),o=e.get("drawingController");i.updateGeoObjects([{id:t.id,data:t.data.newVal}]);var n=e.get("activeGeoObjectsIds");n.length&&n[0]===t.id||(e.set("activeGeoObjectsIds",[]),e.set("activeGeoObjectsIds",[t.id]),e.set("drawingController",o))}},array:{undo:function(t,e){t.data.forEach(function(t){this._actionTypes[t.type].undo(t,e)},this)},redo:function(t,e){t.data.forEach(function(t){this._actionTypes[t.type].redo(t,e)},this)}}},addPropertyState:function(t,e,i){return this.pushItem({type:"dataProviderProperty",prop:t,newVal:e,oldVal:i})},addGeoObjectPropertyState:function(t,e,i,o){var n={prop:"properties",newVal:{properties:{}},oldVal:{properties:{}}};return n.newVal.properties[t]=i,n.oldVal.properties[t]=o,this.pushItem({type:"geoObjectData",id:e,data:n,complete:!0})},glueTwoLast:function(){var t=this._undoStack;if(!(t.length<2)){var e=t[t.length-1],i=t[t.length-2];t.length-=2,t.push({type:"array",data:[e,i]})}},importChangeMap:function(t){var e=this._getLastItem();if(!e){var i=Object.keys(t)[0];e=this.addPropertyState(i,t[i].newVal,t[i].oldVal),delete t[i]}e.onUndo=function(e){Object.keys(t).forEach(function(i){e.set(i,t[i].oldVal)})},e.onRedo=function(e){Object.keys(t).forEach(function(i){e.set(i,t[i].newVal)})}}};a.events.group().add("push",function(){var t=a._undoStack,e=t[t.length-2];e&&"geoObjectData"===e.type&&(e.complete=!0)}),t(a)}),modules.define("import-modal",["i-bem-dom","i18n-plus","jquery","modal","link","yametrika","config"],function(t,e,i,o,n,s,r,a){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._domEvents("upload-button").on("change",function(t){t.target.files.length&&(this._analyseFile(t.target.files[0]),t.target.value="")},this),this._domEvents("approve-button").on("click",function(){this._emit("importData"),this.setMod("step","load")},this),this._domEvents("abort-button").on("click",function(){this.findParentBlock(n).setMod("visible",!1)},this),this._events(this.findParentBlock(n)).on({modName:"visible",modVal:"*"},function(t,e){var i=e.modVal?"on":"un",o=this._domEvents(document.body);o[i]("dragenter",this._onDragEnter),o[i]("dragover",this._onDragOver),o[i]("drop",this._onDrop)},this),this._events(this.findChildBlocks(s)).on("click",function(t){r.params({cnstImportSampleSave:t.target.domElem.data("filetype")})},this),o('a[href="%1"]',this._elem("warning-errors").domElem).attr("href","#").click(function(t){this._emit("showErrors"),t.preventDefault()}.bind(this))}},step:function(t,e){this._domEvents(window)["dragging"===e?"on":"un"]("mousemove",this._onDraggingMouseMove,this),"load"===e&&this.setMod("fileSelected",!1)}},_onDragEnter:function(t){"load"===this.getMod("step")&&(t.stopPropagation(),t.preventDefault(),this.setMod("step","dragging"))},_onDragOver:function(t){"dragging"===this.getMod("step")&&(t.stopPropagation(),t.preventDefault())},_onDrop:function(t){t.originalEvent.dataTransfer.files.length&&(r.reachGoal("DRAG_IMPORT"),t.stopPropagation(),t.preventDefault(),this._analyseFile(t.originalEvent.dataTransfer.files[0]))},_analyseFile:function(t){this.setMod("fileSelected",!0),this._emit("analyseFile",{file:t})},_onDraggingMouseMove:function(t){t.buttons||this.setMod("step","load")},showAnalysed:function(t){if(!t.errors.length&&!t.limitVerticesReached&&!t.limitObjectsReached)return this._emit("importData"),void this.setMod("step","load");if(this.setMod("step","status"),this._elem("result").domElem.text(i("popup","data_import_objects",{$thousands:["num"],$conjugate:t.success,num:t.success})),t.errors.length)if(-1===["csv","xlsx"].indexOf(t.type))this._elem("warning-errors").domElem.hide(),this._elem("warning-missed-data").domElem.html(i("popup","data_import_warning_obs",{$innerConjugate:t.errors.length,num:t.errors.length})).show();else{this._elem("warning-errors").domElem.show(),this._elem("warning-missed-data").domElem.hide();var e=a.hosts.importHelp+"#markers_5__"+t.type.toUpperCase()+"_import";o('a[href*="markers_5"]',this._elem("warning-errors").domElem).attr("href",e)}else this._elem("warning-errors").domElem.hide(),this._elem("warning-missed-data").domElem.hide();this._elem("warning-header").domElem[t.errors.length||t.limitObjectsReached?"show":"hide"](),this._elem("warning-point-limit").domElem[t.limitObjectsReached?"show":"hide"](),this._elem("warning-vert-limit").domElem[t.limitVerticesReached?"show":"hide"](),this._elem("warning-link").domElem[t.limitObjectsReached||t.limitVerticesReached?"show":"hide"]()}}))}),modules.define("strings__escape",function(t){var e={'"':"&quot;","'":"&apos;","&":"&amp;","<":"&lt;",">":"&gt;"},i=function(t){return e[t]||t},o=function(t){return t=new RegExp(t,"g"),function(e){return(""+e).replace(t,i)}};t({xml:o("[&<>]"),html:o("[&<>]"),attr:o("[\"'&<>]")})}),modules.define("page",["i-bem-dom","bh","jquery","yametrika","export-modal","i18n-plus","modal","notify","util-file-downloader"],function(t,e,i,o,n,s,r,a,c,l,d){var u,h={401:"login",403:"login",0:"networkError",507:"freeYourDisk"};t(e.declBlock(d,{applyState:function(t,o){var n="notify"===t;if(u=o,n){if(!this._notifyPopup){this._notifyPopup=e.append(this.domElem,i.apply({block:"modal",mix:[{block:"z-index-group",mods:{level:7}}],zIndexGroupLevel:7,mods:{theme:"custom",closable:!0,autofocus:!0},content:{block:"notify"}})).bem(a);var s=this._notifyPopup.findChildBlock(c);this._events(this._notifyPopup).on({modName:"visible",modVal:""},function(){this.setMod("step",s.getMod("nextStep")||u)},this)}"mapselection"===o&&(u="editor"),this._notifyPopup.setMod("visible",!0)}else this._notifyPopup&&this._notifyPopup.setMod("visible",!1);this.__base.apply(this,arguments)},showNotify:function(t,e){this._hideLoader(),this.setMod("step","notify");var i=this._notifyPopup.findChildBlock(c);i.setMod("message",t),i.setMod("nextStep",e||!1)},showDownloadPopup:function(t,e){function i(){n.destroy(),n=null,this._events(this._notifyPopup).un({modName:"visible",modVal:""},i,this)}this.showNotify("downloadFile");var n=l.create(o("a",this._notifyPopup.domElem),t,e);this._events(this._notifyPopup).on({modName:"visible",modVal:""},i,this),n.fire()},showErrorMessage:function(t,e){this._hideLoader(),this.showNotify(h[t.status]?h[t.status]:"error"),e||n.reachGoalOnce("SHOW_ERROR_MESSAGE",{cnstErrorCode:t.status?t.status:0})}}))}),modules.define("notify",["i-bem-dom","i18n-plus","result-link","jquery","config","modal"],function(t,e,i,o,n,s,r){var a={mapSaved:{header:i("popup","yadisk_export"),buttonText:i("popup","open_yadisk_folder"),buttonClick:function(){var t=o.getYaDiskLink(i("login-form","yadisk_folder_name"));window.open(t)},nextStep:"editor"},dataSaved:{header:i("popup","data_export_success"),buttonText:i("popup","open_yadisk_folder"),buttonClick:function(){var t=o.getYaDiskLink(i("login-form","yadisk_folder_name")+"/"+i("sidebar","data_export_button"));window.open(t)},nextStep:"editor"},login:{header:i("popup","login_error_header"),description:i("popup","login_error_message"),buttonText:i("login-form","login"),buttonClick:function(){window.open(s.hosts.passportLogin)}},error:{header:i("popup","error_header"),description:i("popup","error_message")},networkError:{header:i("popup","network_error_header"),description:i("popup","network_error_message")},freeYourDisk:{header:i("popup","freedisk_header"),description:i("popup","freedisk_description"),buttonText:i("popup","open_yadisk"),buttonClick:function(){window.open(o.getYaDiskLink())}},fileTypeError:{header:i("popup","error_filetype_header"),description:i("popup","error_filetype_desc")},downloadFile:{header:i("popup","file_download_header"),description:i("popup","file_download_desc")}};t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._image=this._elem("image").domElem,this._header=this._elem("header").domElem,this._desc=this._elem("description").domElem,this._button=this._elem("button").domElem,this._domEvents("button").on("click",function(t){this._mode.buttonClick&&this._mode.buttonClick.call(this,t),this.findParentBlock(r).setMod("visible",!1)},this)}},message:function(t,e){e=a[e],this._mode=e,this._header.html(e.header),this._desc.html(e.description||""),this._mode.nextStep&&this.setMod("nextStep",this._mode.nextStep),e.buttonText?this._button.show().html(e.buttonText):this._button.hide()}}}))}),modules.define("util-file-downloader",["loader_type_js","config"],function(t,e,i){var o={create:function(t,e,i){var o;return window.saveAs?t.on("click",function(t){window.saveAs(e,i),t.preventDefault()}):(o=URL.createObjectURL(e),t.attr({href:o,download:i,target:"_blank"})),{fire:function(){t[0].click()},destroy:function(){o&&URL.revokeObjectURL(o),t&&(t.off("click"),t=null)}}}},n=i.uatraits.BrowserName?i.uatraits.BrowserName.toLowerCase():"";"safari"===n||"undefined"==typeof document.createElement("a").download?e(i.baseURL+"res/libs/FileSaver.min.js",function(){t(o)}):t(o)}),modules.define("page",["i-bem-dom","bh","modal"],function(t,e,i,o,n){t(e.declBlock(n,{onSetMod:{loaderStatus:function(t,e){this._loadingSpinner&&this._loadingSpinner.findChildElem("loader-status").domElem.text(e),this.__base.apply(this,arguments)},loading:function(t,n){n?this._loadingSpinner?(this.setMod("loaderStatus",""),this._loadingSpinner.setMod("visible",!0)):this._loadingSpinner=e.append(this.domElem,i.apply({block:"modal",mix:[{block:"page",elem:"loader"},{block:"z-index-group",mods:{level:9}}],zIndexGroupLevel:9,mods:{visible:!0,theme:"custom",transparent:!0},content:{elem:"spin-holder",content:[{block:"spin",mods:{theme:"islands",size:"xl",visible:!0}},{elem:"loader-status",content:"&nbsp;"}]}})).bem(o):this._loadingSpinner&&this._loadingSpinner.setMod("visible",!1)}}}))}),modules.define("geoObject-list",["i-bem-dom","bh","jquery","ymaps-preset-utils","i18n-plus","ymaps-api","yametrika","geoObject-list-item"],function(t,e,i,o,n,s,r,a,c){function l(t,e){var i;return i=t.distance?u(t.distance):h(t.area),{block:"geoObject-list",elem:"item",elemMods:{id:e.properties.geoObjectId},content:[{block:"geoObject-list",elem:"item-dragger",attrs:{title:s("sidebar","replace_"+e.geometry.type.toLowerCase())}},{block:"geoObject-list-item",mods:{type:t.type},caption:(e.properties.caption||"").split("<").join("&lt;"),color1:t.color1,color2:t.color2,iconClassName:t.iconClassName||"",measure:i}],attrs:{"data-id":e.properties.geoObjectId,"data-type":e.geometry.type.toLowerCase()}}}function d(t){var e=t.geometry.type.toLowerCase(),i=t.options.preset,o={type:e,iconContent:"",iconClassName:""};if("point"===e){o.color1=n.getPresetColorToCSSRGBA(i,"iconColor");var s=n.getIconClassNameByPreset(i);if(s)o.iconClassName=s,o.type+="-pictogram";else if(i.toLowerCase().indexOf("dot")>-1)o.type+="-dot";else{var a=t.properties.iconContent;"undefined"!=typeof a?(o.type+=String(a).length>=3?"-compact-number":"-number",o.iconContent=String(a)):o.type+="-number"}}else"linestring"===e?(o.color1=r.option.presetStorage.get(i).strokeWidth?n.getPresetColorToCSSRGBA(i,"strokeColor"):"rgba(0,0,0,0)",o.distance=t.properties.distance):"polygon"===e&&(o.color1=n.getPresetColorToCSSRGBA(i,"fillColor"),o.color2=r.option.presetStorage.get(i).strokeWidth?n.getPresetColorToCSSRGBA(i,"strokeColor"):"rgba(0,0,0,0)",o.area=t.properties.area);return o}function u(t){if("number"!=typeof t||0===t)return null;var e=s("sidebar","format_km").split(" | ");return 1>t?(e=e[2],t*=100):t>1e3?(e=e[0],t/=1e3):e=e[1],t=10>t?t.toFixed(1):Math.round(t),e.split("%1").join(t)}function h(t){if("number"!=typeof t||0===t)return null;var e=s("sidebar","format_sqr_km").split(" | ");return t/=1e6,t<Math.pow(10,-6)?(e=e[2],t*=1e10):1>t?(e=e[1],t*=1e6):e=e[0],t=10>t?t.toFixed(1):Math.round(t),e.split("^2").join('<span class="geoObject-list-item__measure-power">2</span>').split("%1").join(t)}t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._geoObjectIds={},this._holders={point:this._elem("point-holder").domElem,linestring:this._elem("linestring-holder").domElem,polygon:this._elem("polygon-holder").domElem},this.domElem.delegate(".geoObject-list__item","click",this._onItemClick.bind(this)),this.domElem.delegate(".geoObject-list__item","mouseenter",this._onItemSelect.bind(this)),this.domElem.delegate(".geoObject-list__item","mouseleave",this._onItemLeave.bind(this)),this._elems("holder").forEach(this._setupZIndexDragger,this),this._lastFocusedItem=null,this._lastSelectedItem=null}}},setDataProvider:function(t){return this._dataProvider=t,this._dataListener=this._dataProvider.createListener(),this._dataListener.add("activeGeoObjectsIds",this._onActiveGeoObjectsIdsChange,this).add("focusedGeoObjectsIds",this._onFocusedGeoObjectsIdsChange,this),this._rebuildList(this._dataProvider.get("geoObjects")),this},clearDataProvider:function(){return this._dataProvider=null,this._dataListener&&(this._dataListener.destroy(),this._dataListener=null),this._geoObjectsProviderListener&&(this._geoObjectsProviderListener.removeAll(),this._geoObjectsProviderListener=null),this._holders.point.empty(),this._holders.linestring.empty(),this._holders.polygon.empty(),this},_rebuildList:function(t){function e(t){this._createListItem(t,!1)}this._geoObjectsProviderListener&&(this._geoObjectsProviderListener.removeAll(),this._geoObjectsProviderListener=null),this._geoObjectsProviderListener=t.events.group().add("geoObjectsAdd",function(t){t.get("geoObjectsData").forEach(function(t){this._createListItem(t.data,!0)},this),this._checkSeparatorsVisibility()},this).add("geoObjectsUpdate",function(t){t.get("geoObjectsData").forEach(function(t){this._updateListItem(t.data)},this),this._checkSeparatorsVisibility()},this).add("geoObjectReorder",function(t){this._reorderListItem(t.originalEvent)},this).add("geoObjectsRemove",function(t){t.get("geoObjectsData").forEach(function(t){this._removeListItem(t.id)},this),this._checkSeparatorsVisibility()},this);for(var i in this._holders)this._holders.hasOwnProperty(i)&&(this._holders[i].hide(),t.getByType(i).concat().reverse().forEach(e,this),this._holders[i].show());this._checkSeparatorsVisibility()},_createListItem:function(t,o){var n=t.geometry.type.toLowerCase();if(this._holders.hasOwnProperty(n)){var s=t.properties.geoObjectId,r=o?"prepend":"append",a=d(t),u=e[r](this._holders[n],i.apply(l(a,t)));this._geoObjectIds[s]=u.bem(c),this._updateListItem(t)}},_reorderListItem:function(t){var e=t.geoObjectId;if(this._geoObjectIds.hasOwnProperty(e)){var i=this._geoObjectIds[e].domElem,o=i.data("type"),n=this._holders[o];if(n.is(i.parent())){a.changeGeoObjectZIndex(this._dataProvider,o);var s=i.parent().children(),r=t.newIndex<t.oldIndex?"after":"before";s.eq(s.length-1-t.newIndex)[r](i);var c=this.domElem.scrollParent(),l=c.offset().top,d=i.offset().top,u=i.height(),h=l-d,p=d+u-l-c.height();if(h>0||p>0){var m;Math.abs(t.oldIndex-t.newIndex)>1?(m=t.oldIndex<t.newIndex?-u:n.height()-c.height()+u,c.scrollTop(n.offset().top+c.scrollTop()-c.offset().top+m)):(m=t.newIndex>t.oldIndex?h>0&&u>h?0:h>0?-h+.7*u:p+1.3*u:p>0?p-.7*u:-h-1.3*u,c.finish(),c.animate({scrollTop:c.scrollTop()+u*(t.oldIndex-t.newIndex)+m}))}}}},_updateListItem:function(t){var e=t.properties.geoObjectId;if(this._geoObjectIds.hasOwnProperty(e)){var i=this._geoObjectIds[e].findChildBlock(c),o=d(t);i.setCaption(t.properties.caption||""),i.setIconContent(o.iconContent||"",o.iconClassName||""),i.setColor(o.color1,o.color2),i.setMeasure(o.area?h(o.area):u(o.distance)),i.setMod("type",o.type)}},_removeListItem:function(t){if(this._geoObjectIds.hasOwnProperty(t)){var i=this._geoObjectIds[t];e.destruct(i.domElem),delete this._geoObjectIds[t]}},_checkSeparatorsVisibility:function(){var t=this._dataProvider.get("geoObjects"),e=0===t.getByType("point").length,i=0===t.getByType("linestring").length,o=0===t.getByType("polygon").length;this._elem({elem:"separator",modName:"type",modVal:"linestring"}).setMod("hidden",i||e),this._elem({elem:"separator",modName:"type",modVal:"polygon"}).setMod("hidden",o||e&&i)},_onItemClick:function(t){this._dataProvider.set("geoObjectsWithBalloonIds",[o(t.currentTarget).data("id")])},_onItemSelect:function(t){this._isDragActive||this._dataProvider.set("focusedGeoObjectsIds",[o(t.currentTarget).data("id")])},_onItemLeave:function(){this._dataProvider.set("focusedGeoObjectsIds",[])},_onActiveGeoObjectsIdsChange:function(t){var e;if(t.length){var i=this._dataProvider.get("geoObjects").get(t[0]),o=i.geometry.type.toLowerCase(),n=i.properties.geoObjectId;e=this.findChildElem(o+"-holder").findChildElems("item").get(this._geoObjectIds[n].domElem.index())}null!==this._lastSelectedItem&&this._lastSelectedItem.setMod("active","false"),e&&e.setMod("active","true"),this._lastSelectedItem=e||null},_onFocusedGeoObjectsIdsChange:function(t){var e;if(t.length){var i=this._dataProvider.get("geoObjects").get(t[0]),o=i.geometry.type.toLowerCase(),n=i.properties.geoObjectId;e=this.findChildElem(o+"-holder").findChildElems("item").get(this._geoObjectIds[n].domElem.index())
}null!==this._lastFocusedItem&&this._lastFocusedItem.setMod("focused","false"),e&&e.setMod("focused","true"),this._lastFocusedItem=e||null},_setupZIndexDragger:function(t){var e=this;t.domElem.sortable({handle:".geoObject-list__item-dragger",placeholder:"geoObject-list__placeholder",zIndex:9999,start:function(t,i){e._isDragActive=!0;var n=e._dataProvider,s={activeGeoObjectsIds:[],focusedGeoObjectsId:[],geoObjectsWithBalloonIds:[]},r=n.get("activeGeoObjectsIds");r.length&&(s.drawingController=null),n.set(s);var a=this,c=o(this).find(".geoObject-list__item");o(this).outerHeight(c.length*o(c[0]).outerHeight()),i.item.appendTo(document.body),o(this).sortable("refreshPositions"),e.findChildElems("holder").forEach(function(t){a!==t.domElem[0]&&t.domElem.addClass("geoObject-list__holder-disabled")}),e.findChildElems("item").forEach(function(t){t.domElem.addClass("geoObject-list__item-animation")})},stop:function(t,i){e.findChildElems("holder").forEach(function(t){t.domElem.removeClass("geoObject-list__holder-disabled").css("height","auto")}),e._isDragActive=!1,e.findChildElems("item").forEach(function(t){t.domElem.removeClass("geoObject-list__item-animation")}),a.changeGeoObjectZIndex(e._dataProvider,o(i.item).data("type"))},change:function(t,i){var n=o(this).find(".geoObject-list__placeholder"),s=e._dataProvider.get("geoObjects"),r=n.parent().children().length-1;s.reorderGeoObject(o(i.item).data("id"),r-n.index())}}).disableSelection()}}))}),modules.define("geoObject-list-item",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{setIconContent:function(t,e){var i=this._elem("icon").domElem;return i.html(t),this._iconClassName&&i.removeClass(this._iconClassName),i.addClass(e),this._iconClassName=e,this},setColor:function(t,e){return this._elem("icon").domElem.css("border-color",t).css("outline-color",e),this},setCaption:function(t){return this._elem("title").domElem.text(t),this},setMeasure:function(t){var e=this._elem("measure");return t&&e.domElem.html(t),e.setMod("hidden",!Boolean(t)),this}}))}),modules.define("textarea",["i-bem-dom","input"],function(t,e,i){t(e.declBlock(this.name,i))}),modules.define("button",function(t,e){t(e.declMod({modName:"togglable",modVal:"*"},{onSetMod:{checked:function(t,e){this.__base.apply(this,arguments),this.domElem.attr("aria-pressed",!!e)}}}))}),modules.define("radio",["button","functions"],function(t,e,i,o){function n(t,e,i){i!==!1&&this.__base.apply(this,arguments),this._button.setMod(t,e)}function s(t,e){this.setMod(e.modName,e.modVal)}t(o.declMod({modName:"type",modVal:"button"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._button=this.findChildBlock(e),this._events(e).on({modName:"checked",modVal:"*"},s,this).on({modName:"focused",modVal:"*"},s,this)}},checked:n,disabled:n,focused:function(t,e){n.call(this,t,e,!1)}}},{lazyInit:!0,onInit:function(){return this._events(e).on({modName:"js",modVal:"inited"},i.noop),this.__base.apply(this,arguments)}}))}),modules.define("checkbox",["i-bem-dom","control"],function(t,e,i){t(e.declBlock(this.name,i,{onSetMod:{checked:{"true":function(){this._elem("control").domElem.attr("checked",!0).prop("checked",!0)},"":function(){this._elem("control").domElem.removeAttr("checked").prop("checked",!1)}}},_onChange:function(){this.setMod("checked",this._elem("control").domElem.prop("checked"))}},{lazyInit:!0,onInit:function(){return this._domEvents("control").on("change",this.prototype._onChange),this.__base.apply(this,arguments)}}))}),modules.define("select",["i-bem-dom","popup","menu","menu__item","button","jquery","dom","keyboard__codes","strings__escape"],function(t,e,i,o,n,s,r,a,c,l){t(e.declBlock(this.name,{beforeSetMod:{opened:{"true":function(){return!this.hasMod("disabled")}},focused:{"":function(){return!this._isPointerPressInProgress}}},onSetMod:{js:{inited:function(){this._button=this.findChildBlock(s),this._events(s).on("click",this._onButtonClick,this),this._popup=this.findChildBlock(i).setAnchor(this._button),this._events(i).on({modName:"visible",modVal:""},this._onPopupHide,this),this._menu=this._popup.findChildBlock(o),this._events(this._menu).on("change",this._onMenuChange,this).on("item-click",this._onMenuItemClick,this).on("item-hover",this._onMenuItemHover,this),this._isPointerPressInProgress=!1,this._buttonWidth=null,this.hasMod("focused")&&this._focus()}},focused:{"true":function(){this._focus()},"":function(){this._blur()}},opened:{"*":function(t,e){this._menu.setMod("focused",e)},"true":function(){null===this._buttonWidth&&this._updateMenuWidth(),this._updateMenuHeight(),this._popup.setMod("visible"),this._domEvents(e.doc).on("pointerpress",this._onDocPointerPress),this.setMod("focused")._hoverCheckedOrFirstItem()},"":function(){this._domEvents(e.doc).un("pointerpress",this._onDocPointerPress),this._popup.delMod("visible")}},disabled:{"*":function(t,e){this._button.setMod(t,e),this._menu.setMod(t,e)},"true":function(){this._elems("control").forEach(function(t){t.domElem.attr("disabled",!0)}),this._popup.delMod("visible")},"":function(){this._elems("control").forEach(function(t){t.domElem.removeAttr("disabled")})}}},getVal:function(){return this._menu.getVal()},setVal:function(t){return this._menu.setVal(t),this},getName:function(){return this.params.name},_getDefaultParams:function(){return{optionsMaxHeight:Number.POSITIVE_INFINITY}},_focus:function(){this._domEvents("button").on("keydown",this._onKeyDown).on("keypress",this._onKeyPress),this._button.setMod("focused")},_blur:function(){this._domEvents("button").un("keydown",this._onKeyDown).un("keypress",this._onKeyPress),this.delMod("opened"),this._button.delMod("focused")},_updateMenuWidth:function(){this._menu.domElem.css("min-width",this._buttonWidth=this._button.domElem.outerWidth()),this._popup.redraw()},_updateMenuHeight:function(){var t=this._popup.calcPossibleDrawingParams(),e=this._menu.domElem,i=e.outerWidth(),o=0;t.forEach(function(t){t.width>=i&&t.height>o&&(o=t.height)}),o&&e.css("max-height",Math.min(this.params.optionsMaxHeight,o))},_getCheckedItems:function(){return this._menu.getItems().filter(function(t){return t.hasMod("checked")})},_hoverCheckedOrFirstItem:function(){(this._getCheckedItems().get(0)||this._menu.getItems().get(0)).setMod("hovered")},_onKeyDown:function(t){this.hasMod("opened")?t.keyCode===c.ESC&&(t.stopPropagation(),this.delMod("opened")):t.keyCode!==c.UP&&t.keyCode!==c.DOWN||t.shiftKey||(t.preventDefault(),this.setMod("opened"))},_onKeyPress:function(t){if(!this.hasMod("opened")){var e=this._menu.searchItemByKeyboardEvent(t);e&&this._setSingleVal(e.getVal())}},_setSingleVal:function(t){this.setVal(t)},_onMenuChange:function(){this._updateControl(),this._updateButton(),this.hasMod("opened")?this._updateMenuWidth():this._buttonWidth=null,this._emit("change")},_onMenuItemClick:function(){},_onMenuItemHover:function(t,e){var i=e.item;i.hasMod("hovered")?this._button.domElem.attr("aria-activedescendant",i.domElem.attr("id")):this._button.domElem.removeAttr("aria-activedescendant")},_updateControl:function(){},_updateButton:function(){},_onButtonClick:function(){this.toggleMod("opened")},_onButtonFocusChange:function(t,e){this.setMod("focused",e.modVal)},_onPopupHide:function(){this.delMod("opened")},_onDocPointerPress:function(t){this._isEventInPopup(t)&&("mouse"===t.pointerType&&t.preventDefault(),this._isPointerPressInProgress=!0,this._domEvents(e.doc).on("pointerrelease",{focusedHardMod:this._button.getMod("focused-hard")},this._onDocPointerRelease))},_onDocPointerRelease:function(t){this._isPointerPressInProgress=!1,this._domEvents().un("pointerrelease",this._onDocPointerRelease),this._button.toggleMod("focused",!0,"",this._isEventInPopup(t)).setMod("focused-hard",t.data.focusedHardMod)},_isEventInPopup:function(t){return a.contains(this._popup.domElem,r(t.target))}},{lazyInit:!0,onInit:function(){this._events(s).on({modName:"focused",modVal:"*"},this.prototype._onButtonFocusChange)},_createControlHTML:function(t,e){return'<input type="hidden" name="'+t+'" class="'+this._buildClassName("control")+'" value="'+l.attr(e)+'"/>'}}))}),modules.define("menu",["i-bem-dom","keyboard__codes"],function(t,e,i,o){t(o.declMod({modName:"mode",modVal:"*"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._val=null,this._isValValid=!1}}},_onKeyDown:function(t){(t.keyCode===i.ENTER||t.keyCode===i.SPACE)&&(this._domEvents(e.doc).un("keydown",this._onKeyDown).on("keyup",this._onKeyUp),t.keyCode===i.SPACE&&t.preventDefault(),this._onItemClick(this._hoveredItem,{source:"keyboard"})),this.__base.apply(this,arguments)},_onKeyUp:function(){this._domEvents(e.doc).un("keyup",this._onKeyUp),this.hasMod("focused")&&this._domEvents(e.doc).on("keydown",this._onKeyDown)},getVal:function(){return this._isValValid||(this._val=this._getVal(),this._isValValid=!0),this._val},_getVal:function(){throw Error("_getVal is not implemented")},setVal:function(t){return this._setVal(t)&&(this._val=t,this._isValValid=!0,this._emit("change")),this},_setVal:function(){throw Error("_setVal is not implemented")},_updateItemsCheckedMod:function(t){var e=this.getItems();t.forEach(function(t,i){e.get(i).setMod("checked",t)})},setContent:function(){var t=this.__base.apply(this,arguments);return this._isValValid=!1,this._emit("change"),t}}))}),modules.define("util-deferred-action",[],function(t){var e={};t({createAction:function(t,i,o){e.hasOwnProperty(t)||(e[t]={});var n=e[t];n.callback=i,n.timerId&&window.clearTimeout(n.timerId),n.timerId=window.setTimeout(function(){n.callback.call(),delete e[t]},o)},cancelAction:function(t){if(e.hasOwnProperty(t)){var i=e[t];i.timerId>0&&(window.clearTimeout(i.timerId),delete e[t])}}})}),modules.define("util-size-converter",[],function(t){var e=96,i=2.5399599194324;t({toPixels:function(t,o){var n=o*e;return"cm"===t?o=n/i:"in"===t&&(o=n),o},fromPixels:function(t,o){var n=o/e;return"in"===t?o=n:"cm"===t&&(o=n*i),o}})}),modules.define("ymaps-counter",["ymaps-api","config"],function(t,e,i){var o,n=e.modules.require("yandex.counter").then(function(t){return o=t[0]});t({countByKey:function(t,e){o?o.countByKey(t,e):n.then(function(i){i.countByKey(t,e)})},getPlatform:function(){return i.uatraits.isMobile?i.uatraits.OSFamily:"Desktop"}})}),modules.define("help-button",["i-bem-dom","i18n-plus","yametrika","dropdown","config"],function(t,e,i,o,n,s){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._popup=this.findChildBlock(n).getPopup(),this._dropdown=this.findChildElem("dropdown").domElem,this._dropdown.attr("tabindex",0),[{elem:this.domElem,callback:function(t){t.stopPropagation(),this._popup.toggleMod("visible")}},{elem:this._popup,callback:function(t){t.stopPropagation()}},{elem:this.findChildElem("help"),callback:function(){this._popup.setMod("visible",!1);var t=s.hosts[this.getMod("export-modal-link")?"exportHelp":"help"];window.open(t,"_blank"),o.reachGoal("CLICK_HELP")}},{elem:this.findChildElem("support"),callback:function(){this._popup.setMod("visible",!1),this._emit("support-open")}},{elem:this.findChildElem("hotkeys"),callback:function(){this._popup.setMod("visible",!1),this._emit("hotkeys-open")}},{elem:this.findChildElem("nk"),callback:function(){this._popup.setMod("visible",!1),this._emit("nmaps-open")}}].forEach(function(t){this._domEvents(t.elem).on("click",t.callback,this)},this),this._domEvents(window).on("pointerclick",function(t){t.target!==this._dropdown[0]&&this._popup.setMod("visible",!1)},this),this._domEvents(document.body).on("mouseleave",function(){this._popup.setMod("visible",!1)}),"ru"!==s.tld&&this._popup.setMod("no-nk")}}}}))}),modules.define("map-editor",["i-bem-dom","ymaps-api","ymaps-utils","ymaps-map-factory","config","map-data-default"],function(t,e,i,o,n,s,r){t(e.declBlock(this.name,{onSetMod:{step:function(t,e,i){this.getDataProvider()&&(this.applyStep(e,i),this._map.container.fitToViewport(),this._map.balloon&&this._map.balloon.isOpen()&&this._map.balloon.close())}},setDataProvider:function(t){return this.clearDataProvider(),this._dataProvider=t,this._dataListener=this._dataProvider.createListener(),this._dataListener.add("center",function(t){this._map.setCenter(t)},this).add("zoom",function(t){this._map.setZoom(t)},this).add("type",function(t){this._map.setType(t)},this),this.createEditorMap(),"edit"!==this.getMod("step")?this.setMod("step","edit"):this.applyStep("edit",this.getMod("step")),this},getDataProvider:function(){return this._dataProvider},clearDataProvider:function(){return this.destroyEditorMap(),this._dataListener&&(this._dataListener.destroy(),this._dataListener=null),this._dataProvider=null,this},createEditorMap:function(){var t=this.getDataProvider();this._map=n({container:this._elem("map-holder").domElem[0],mapState:{center:t.get("center"),zoom:t.get("zoom"),type:t.get("type"),controls:[]},traffic:{active:!1},mapOptions:i.util.extend({geoObjectBalloonAutoPanMargin:[150,55,55,84],dragInertia:!1,geoObjectInteractiveZIndex:!1},r.defaultMapOptions)}),this._setupMapListeners()},destroyEditorMap:function(){this._map&&(this._teardownMapListeners(),this._map.destroy())},_setupMapListeners:function(){this._map.events.add(["boundschange","typechange"],this._onMapBoundsChange,this),this._onMapBoundsChange()},_teardownMapListeners:function(){this._map.events.remove(["boundschange","typechange"],this._onMapBoundsChange,this)},applyStep:function(){},_onMapBoundsChange:function(){this.getDataProvider().set("zoom",this._map.getZoom()).set("center",this._map.getCenter()).set("type",this._map.getType()).set("bounds",this._map.getBounds()).set("currentContainerSize",this._map.container.getSize())}}))}),modules.define("map-editor",["i-bem-dom","history-manager","ymaps-api","util-inline-image","config","i18n-plus","yametrika"],function(t,e,i,o,n,s,r,a,c){function l(t){return"redo"!==t||d||(t="redo_win"),r("sidebar","history_"+t+"_hint").split("Ctrl").join(u)}t(e.declBlock(c,{_addHistoryControls:function(){if(this._undoButton||this._initHistoryControls(),this._undoButton.getParent()!==this._map.controls){this._map.controls.add(this._undoButton),this._map.controls.add(this._redoButton);var t=document.createElement("ymaps");t.classList.add("map-history-buttons-shadow"),this._historyButtonsShadow=t,this._undoButton.getLayout().then(function(e){var i=e.getElement();i.classList.add("map-history-buttons-undo");var o=i.parentNode;o.classList.add("map-history-buttons-undo-holder"),o.parentNode.insertBefore(t,o)}),this._redoButton.getLayout().then(function(t){t.getElement().classList.add("map-history-buttons-redo")})}setTimeout(this._checkHistoryButtons.bind(this),1),this._undoButton.options.set("visible",!0),this._redoButton.options.set("visible",!0),this._historyButtonsShadow.style.display="block"},_initHistoryControls:function(){this._undoButton=new o.control.Button({data:{image:n.getImage("history_back"),title:l("undo")},options:{position:{top:10,left:10},size:"small",selectOnClick:!1}}),this._redoButton=new o.control.Button({data:{image:n.getImage("history_forw"),title:l("redo")},options:{position:{top:10,left:39},size:"small",selectOnClick:!1}}),this._undoButton.events.add("click",this._onUndoButtonClick,this),this._redoButton.events.add("click",this._onRedoButtonClick,this),i.events.group().add(["undo","redo","push"],this._checkHistoryButtons,this)},_teardownHistoryButtons:function(){this._undoButton.options.set("visible",!1),this._redoButton.options.set("visible",!1),this._historyButtonsShadow.style.display="none"},_checkHistoryButtons:function(){i.can("undo")?this._undoButton.enable():this._undoButton.disable(),i.can("redo")?this._redoButton.enable():this._redoButton.disable()},_onUndoButtonClick:function(){i.can("undo")&&(i.undo(),a.reachGoal("MAP_CONTROL",{cnstControlUsed:"undo"}))},_onRedoButtonClick:function(){i.can("redo")&&(i.redo(),a.reachGoal("MAP_CONTROL",{cnstControlUsed:"redo"}))}}));var d="MacOS"===s.uatraits.OSFamily,u=d?"Cmd":"Ctrl"}),modules.define("util-inline-image",[],function(t){var e={traffic:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNXB4IiB2aWV3Qm94PSIwIDAgMTYgMTUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPmdyZXlfdHJhZmZpYzwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz48L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPiAgICAgICAgPGcgaWQ9IjEiIHNrZXRjaDp0eXBlPSJNU0xheWVyR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMDQuMDAwMDAwLCAtNi4wMDAwMDApIj4gICAgICAgICAgICA8ZyBpZD0idHJhZmZpYy1uZXctY29weS02IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5OS4wMDAwMDAsIDAuMDAwMDAwKSIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCI+ICAgICAgICAgICAgICAgIDxnIGlkPSJncmV5X3RyYWZmaWMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuMDAwMDAwLCA2LjAwMDAwMCkiPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTAuMDM2OTIzMDc2OSw2LjI4MzQ0MzA2IEMwLjIyNTY4MTU5OSw3LjMzMzAyNTM1IDEuMTQ2MTM2MTUsNy45MjYxNTM4NSAyLjk3Niw3LjkyNjE1Mzg1IEMzLjk2NzM4NDYyLDcuMzQyMTUzODUgMy45ODUyMzA3NywxLjg2OTUzODQ2IDYuNzc0MTUzODUsMC43MDY0NjE1MzggQzcuMTY2MTUzODUsMC41NDI3NjkyMzEgNy41NiwwLjQwNDkyMzA3NyA3Ljk0OTUzODQ2LDAuMjk0MTUzODQ2IEM4LjEzNzg0NjE1LDAuMjQxMjMwNzY5IDguNDM1MDc2OTIsMC4xMjYxNTM4NDYgOC40MzUwNzY5MiwwLjEyNjE1Mzg0NiBDOC40MzUwNzY5MiwwLjEyNjE1Mzg0NiA3Ljg1MTY5MjMxLDAuMDgwNjE1Mzg0NiA3LjE1NjMwNzY5LDAuMDgwNjE1Mzg0NiBDNy4wOTkwNzY5MiwwLjA4MDYxNTM4NDYgNy4wNDA2MTUzOCwwLjA4MDYxNTM4NDYgNi45ODIxNTM4NSwwLjA4MTg0NjE1MzggQzYuMzU4NzY5MjMsMC4wODg2MTUzODQ2IDYuMTgwMzA3NjksMC4xNiA1LjUzMzUzODQ2LDAuMjI3NjkyMzA4IEMzLjI5ODQ2MTU0LDAuNDY0IDEuMDQ0OTIzMDgsMi4xNDU4NDYxNSAwLjI4Njc2OTIzMSw0LjM2NDkyMzA4IEMwLjE2NTQ2OTU2MSw0LjcxOTk2MDkxIDAuMDgxMzYxNjg4OCw1LjA1MjU1MTM0IDAuMDM2OTIzMDc2OSw1LjM2MDc4OTAyIEwwLjAzNjkyMzA3NjksNi4yODM0NDMwNiBMMC4wMzY5MjMwNzY5LDYuMjgzNDQzMDYgWiIgaWQ9IkNsaXAtMiIgZmlsbD0iIzk5OTg5OCI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkuNDA0NjI3MjksMTQuMTE2OTIzMSBDMTIuOTM3NzM3MywxMy43NTQ1MjM2IDE1LjY5NDE1MzgsMTAuNzY5MDQxIDE1LjY5NDE1MzgsNy4xMzk2OTIzMSBDMTUuNjk0MTUzOCwzLjI2NTg0NjE1IDEyLjU1Mzg0NjIsMC4xMjYxNTM4NDYgOC42ODA2MTUzOCwwLjEyNjE1Mzg0NiBDNC44MDY3NjkyMywwLjEyNjE1Mzg0NiAxLjY2NjQ2MTU0LDMuMjY1ODQ2MTUgMS42NjY0NjE1NCw3LjEzOTY5MjMxIEMxLjY2NjQ2MTU0LDEwLjc2OTA0MSA0LjQyMjg3ODA5LDEzLjc1NDUyMzYgNy45NTY0OTQxNiwxNC4xMTY5MjMxIEw5LjQwNDYyNzI5LDE0LjExNjkyMzEgTDkuNDA0NjI3MjksMTQuMTE2OTIzMSBaIiBpZD0iTWFzayIgZmlsbD0iI0JGQkZCRiI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuODA3Mzg0NjIsMC4wNjE1Mzg0NjE1IEM4LjEzOTA3NjkyLDAuMDYxNTM4NDYxNSA4LjQyNjQ2MTU0LDAuMDcyIDguNzAyMTUzODUsMC4wNzY5MjMwNzY5IEMxMi41MzY2MTU0LDAuMTQ3MDc2OTIzIDE1LjY5MDQ2MTUsMy4yMzI2MTUzOCAxNS42OTA0NjE1LDcuMDM2OTIzMDggQzE1LjY5MDQ2MTUsNy4yNDggMTUuNjgwNjE1NCw3LjQ1NjYxNTM4IDE1LjY2MTUzODUsNy42NjMzODQ2MiBDMTQuNjM5Mzg0Niw3LjU4MDMwNzY5IDEzLjIyOTUzODUsNi4yMzY5MjMwOCAxMi45MDI3NjkyLDUuMTQ1ODQ2MTUgQzExLjg0MDYxNTQsMS44MzM4NDYxNSA5LjIwNjc2OTIzLDAuMjU0NzY5MjMxIDYuMzQ4OTIzMDgsMC4xMzcyMzA3NjkgQzYuOTM3MjMwNzcsMC4wNzY5MjMwNzY5IDcuNDA0OTIzMDgsMC4wNjE1Mzg0NjE1IDcuODA3Mzg0NjIsMC4wNjE1Mzg0NjE1IEw3LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBaIiBpZD0iQ2xpcC04IiBmaWxsPSIjMjQyNzI2Ij48L3BhdGg+ICAgICAgICAgICAgICAgIDwvZz4gICAgICAgICAgICA8L2c+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=",traffic_green:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNXB4IiB2aWV3Qm94PSIwIDAgMTYgMTUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPmdyZWVuX3RyYWZmaWM8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBza2V0Y2g6dHlwZT0iTVNQYWdlIj4gICAgICAgIDxnIGlkPSIxIiBza2V0Y2g6dHlwZT0iTVNMYXllckdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMzguMDAwMDAwLCAtNi4wMDAwMDApIj4gICAgICAgICAgICA8ZyBpZD0idHJhZmZpYy1uZXctY29weS0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMy4wMDAwMDAsIDAuMDAwMDAwKSIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCI+ICAgICAgICAgICAgICAgIDxnIGlkPSJncmVlbl90cmFmZmljIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1LjAwMDAwMCwgNi4wMDAwMDApIj4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjAzNjkyMzA3NjksNi4yODM0NDMwNiBDMC4yMjU2ODE1OTksNy4zMzMwMjUzNSAxLjE0NjEzNjE1LDcuOTI2MTUzODUgMi45NzYsNy45MjYxNTM4NSBDMy45NjczODQ2Miw3LjM0MjE1Mzg1IDMuOTg1MjMwNzcsMS44Njk1Mzg0NiA2Ljc3NDE1Mzg1LDAuNzA2NDYxNTM4IEM3LjE2NjE1Mzg1LDAuNTQyNzY5MjMxIDcuNTYsMC40MDQ5MjMwNzcgNy45NDk1Mzg0NiwwLjI5NDE1Mzg0NiBDOC4xMzc4NDYxNSwwLjI0MTIzMDc2OSA4LjQzNTA3NjkyLDAuMTI2MTUzODQ2IDguNDM1MDc2OTIsMC4xMjYxNTM4NDYgQzguNDM1MDc2OTIsMC4xMjYxNTM4NDYgNy44NTE2OTIzMSwwLjA4MDYxNTM4NDYgNy4xNTYzMDc2OSwwLjA4MDYxNTM4NDYgQzcuMDk5MDc2OTIsMC4wODA2MTUzODQ2IDcuMDQwNjE1MzgsMC4wODA2MTUzODQ2IDYuOTgyMTUzODUsMC4wODE4NDYxNTM4IEM2LjM1ODc2OTIzLDAuMDg4NjE1Mzg0NiA2LjE4MDMwNzY5LDAuMTYgNS41MzM1Mzg0NiwwLjIyNzY5MjMwOCBDMy4yOTg0NjE1NCwwLjQ2NCAxLjA0NDkyMzA4LDIuMTQ1ODQ2MTUgMC4yODY3NjkyMzEsNC4zNjQ5MjMwOCBDMC4xNjU0Njk1NjEsNC43MTk5NjA5MSAwLjA4MTM2MTY4ODgsNS4wNTI1NTEzNCAwLjAzNjkyMzA3NjksNS4zNjA3ODkwMiBMMC4wMzY5MjMwNzY5LDYuMjgzNDQzMDYgTDAuMDM2OTIzMDc2OSw2LjI4MzQ0MzA2IFoiIGlkPSJDbGlwLTIiIGZpbGw9IiM2MDdFNDkiPjwvcGF0aD4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05LjQwNDYyNzI5LDE0LjExNjkyMzEgQzEyLjkzNzczNzMsMTMuNzU0NTIzNiAxNS42OTQxNTM4LDEwLjc2OTA0MSAxNS42OTQxNTM4LDcuMTM5NjkyMzEgQzE1LjY5NDE1MzgsMy4yNjU4NDYxNSAxMi41NTM4NDYyLDAuMTI2MTUzODQ2IDguNjgwNjE1MzgsMC4xMjYxNTM4NDYgQzQuODA2NzY5MjMsMC4xMjYxNTM4NDYgMS42NjY0NjE1NCwzLjI2NTg0NjE1IDEuNjY2NDYxNTQsNy4xMzk2OTIzMSBDMS42NjY0NjE1NCwxMC43NjkwNDEgNC40MjI4NzgwOSwxMy43NTQ1MjM2IDcuOTU2NDk0MTYsMTQuMTE2OTIzMSBMOS40MDQ2MjcyOSwxNC4xMTY5MjMxIEw5LjQwNDYyNzI5LDE0LjExNjkyMzEgWiIgaWQ9Ik1hc2siIGZpbGw9IiM2OUMwMzAiPjwvcGF0aD4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBDOC4xMzkwNzY5MiwwLjA2MTUzODQ2MTUgOC40MjY0NjE1NCwwLjA3MiA4LjcwMjE1Mzg1LDAuMDc2OTIzMDc2OSBDMTIuNTM2NjE1NCwwLjE0NzA3NjkyMyAxNS42OTA0NjE1LDMuMjMyNjE1MzggMTUuNjkwNDYxNSw3LjAzNjkyMzA4IEMxNS42OTA0NjE1LDcuMjQ4IDE1LjY4MDYxNTQsNy40NTY2MTUzOCAxNS42NjE1Mzg1LDcuNjYzMzg0NjIgQzE0LjYzOTM4NDYsNy41ODAzMDc2OSAxMy4yMjk1Mzg1LDYuMjM2OTIzMDggMTIuOTAyNzY5Miw1LjE0NTg0NjE1IEMxMS44NDA2MTU0LDEuODMzODQ2MTUgOS4yMDY3NjkyMywwLjI1NDc2OTIzMSA2LjM0ODkyMzA4LDAuMTM3MjMwNzY5IEM2LjkzNzIzMDc3LDAuMDc2OTIzMDc2OSA3LjQwNDkyMzA4LDAuMDYxNTM4NDYxNSA3LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBMNy44MDczODQ2MiwwLjA2MTUzODQ2MTUgWiIgaWQ9IkNsaXAtOCIgZmlsbD0iIzI0MjcyNiI+PC9wYXRoPiAgICAgICAgICAgICAgICA8L2c+ICAgICAgICAgICAgPC9nPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+",traffic_yellow:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNXB4IiB2aWV3Qm94PSIwIDAgMTYgMTUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPnllbGxvd190cmFmZmljPC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPjwvZGVmcz4gICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc2tldGNoOnR5cGU9Ik1TUGFnZSI+ICAgICAgICA8ZyBpZD0iMSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTUuMDAwMDAwLCAtNi4wMDAwMDApIj4gICAgICAgICAgICA8ZyBpZD0idHJhZmZpYy1uZXctY29weS01IiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4gICAgICAgICAgICAgICAgPGcgaWQ9InllbGxvd190cmFmZmljIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1LjAwMDAwMCwgNi4wMDAwMDApIj4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjAzNjkyMzA3NjksNi4yODM0NDMwNiBDMC4yMjU2ODE1OTksNy4zMzMwMjUzNSAxLjE0NjEzNjE1LDcuOTI2MTUzODUgMi45NzYsNy45MjYxNTM4NSBDMy45NjczODQ2Miw3LjM0MjE1Mzg1IDMuOTg1MjMwNzcsMS44Njk1Mzg0NiA2Ljc3NDE1Mzg1LDAuNzA2NDYxNTM4IEM3LjE2NjE1Mzg1LDAuNTQyNzY5MjMxIDcuNTYsMC40MDQ5MjMwNzcgNy45NDk1Mzg0NiwwLjI5NDE1Mzg0NiBDOC4xMzc4NDYxNSwwLjI0MTIzMDc2OSA4LjQzNTA3NjkyLDAuMTI2MTUzODQ2IDguNDM1MDc2OTIsMC4xMjYxNTM4NDYgQzguNDM1MDc2OTIsMC4xMjYxNTM4NDYgNy44NTE2OTIzMSwwLjA4MDYxNTM4NDYgNy4xNTYzMDc2OSwwLjA4MDYxNTM4NDYgQzcuMDk5MDc2OTIsMC4wODA2MTUzODQ2IDcuMDQwNjE1MzgsMC4wODA2MTUzODQ2IDYuOTgyMTUzODUsMC4wODE4NDYxNTM4IEM2LjM1ODc2OTIzLDAuMDg4NjE1Mzg0NiA2LjE4MDMwNzY5LDAuMTYgNS41MzM1Mzg0NiwwLjIyNzY5MjMwOCBDMy4yOTg0NjE1NCwwLjQ2NCAxLjA0NDkyMzA4LDIuMTQ1ODQ2MTUgMC4yODY3NjkyMzEsNC4zNjQ5MjMwOCBDMC4xNjU0Njk1NjEsNC43MTk5NjA5MSAwLjA4MTM2MTY4ODgsNS4wNTI1NTEzNCAwLjAzNjkyMzA3NjksNS4zNjA3ODkwMiBMMC4wMzY5MjMwNzY5LDYuMjgzNDQzMDYgTDAuMDM2OTIzMDc2OSw2LjI4MzQ0MzA2IFoiIGlkPSJDbGlwLTIiIGZpbGw9IiNCRDlDNEYiPjwvcGF0aD4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05LjQwNDYyNzI5LDE0LjExNjkyMzEgQzEyLjkzNzczNzMsMTMuNzU0NTIzNiAxNS42OTQxNTM4LDEwLjc2OTA0MSAxNS42OTQxNTM4LDcuMTM5NjkyMzEgQzE1LjY5NDE1MzgsMy4yNjU4NDYxNSAxMi41NTM4NDYyLDAuMTI2MTUzODQ2IDguNjgwNjE1MzgsMC4xMjYxNTM4NDYgQzQuODA2NzY5MjMsMC4xMjYxNTM4NDYgMS42NjY0NjE1NCwzLjI2NTg0NjE1IDEuNjY2NDYxNTQsNy4xMzk2OTIzMSBDMS42NjY0NjE1NCwxMC43NjkwNDEgNC40MjI4NzgwOSwxMy43NTQ1MjM2IDcuOTU2NDk0MTYsMTQuMTE2OTIzMSBMOS40MDQ2MjcyOSwxNC4xMTY5MjMxIEw5LjQwNDYyNzI5LDE0LjExNjkyMzEgWiIgaWQ9Ik1hc2siIGZpbGw9IiNGRkMwNDIiPjwvcGF0aD4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBDOC4xMzkwNzY5MiwwLjA2MTUzODQ2MTUgOC40MjY0NjE1NCwwLjA3MiA4LjcwMjE1Mzg1LDAuMDc2OTIzMDc2OSBDMTIuNTM2NjE1NCwwLjE0NzA3NjkyMyAxNS42OTA0NjE1LDMuMjMyNjE1MzggMTUuNjkwNDYxNSw3LjAzNjkyMzA4IEMxNS42OTA0NjE1LDcuMjQ4IDE1LjY4MDYxNTQsNy40NTY2MTUzOCAxNS42NjE1Mzg1LDcuNjYzMzg0NjIgQzE0LjYzOTM4NDYsNy41ODAzMDc2OSAxMy4yMjk1Mzg1LDYuMjM2OTIzMDggMTIuOTAyNzY5Miw1LjE0NTg0NjE1IEMxMS44NDA2MTU0LDEuODMzODQ2MTUgOS4yMDY3NjkyMywwLjI1NDc2OTIzMSA2LjM0ODkyMzA4LDAuMTM3MjMwNzY5IEM2LjkzNzIzMDc3LDAuMDc2OTIzMDc2OSA3LjQwNDkyMzA4LDAuMDYxNTM4NDYxNSA3LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBMNy44MDczODQ2MiwwLjA2MTUzODQ2MTUgWiIgaWQ9IkNsaXAtOCIgZmlsbD0iIzI0MjcyNiI+PC9wYXRoPiAgICAgICAgICAgICAgICA8L2c+ICAgICAgICAgICAgPC9nPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+",traffic_red:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNXB4IiB2aWV3Qm94PSIwIDAgMTYgMTUiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPnJlZF90cmFmZmljPC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPjwvZGVmcz4gICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc2tldGNoOnR5cGU9Ik1TUGFnZSI+ICAgICAgICA8ZyBpZD0iMSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTcxLjAwMDAwMCwgLTYuMDAwMDAwKSI+ICAgICAgICAgICAgPGcgaWQ9InRyYWZmaWMtbmV3LWNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjYuMDAwMDAwLCAwLjAwMDAwMCkiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPiAgICAgICAgICAgICAgICA8ZyBpZD0icmVkX3RyYWZmaWMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuMDAwMDAwLCA2LjAwMDAwMCkiPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTAuMDM2OTIzMDc2OSw2LjI4MzQ0MzA2IEMwLjIyNTY4MTU5OSw3LjMzMzAyNTM1IDEuMTQ2MTM2MTUsNy45MjYxNTM4NSAyLjk3Niw3LjkyNjE1Mzg1IEMzLjk2NzM4NDYyLDcuMzQyMTUzODUgMy45ODUyMzA3NywxLjg2OTUzODQ2IDYuNzc0MTUzODUsMC43MDY0NjE1MzggQzcuMTY2MTUzODUsMC41NDI3NjkyMzEgNy41NiwwLjQwNDkyMzA3NyA3Ljk0OTUzODQ2LDAuMjk0MTUzODQ2IEM4LjEzNzg0NjE1LDAuMjQxMjMwNzY5IDguNDM1MDc2OTIsMC4xMjYxNTM4NDYgOC40MzUwNzY5MiwwLjEyNjE1Mzg0NiBDOC40MzUwNzY5MiwwLjEyNjE1Mzg0NiA3Ljg1MTY5MjMxLDAuMDgwNjE1Mzg0NiA3LjE1NjMwNzY5LDAuMDgwNjE1Mzg0NiBDNy4wOTkwNzY5MiwwLjA4MDYxNTM4NDYgNy4wNDA2MTUzOCwwLjA4MDYxNTM4NDYgNi45ODIxNTM4NSwwLjA4MTg0NjE1MzggQzYuMzU4NzY5MjMsMC4wODg2MTUzODQ2IDYuMTgwMzA3NjksMC4xNiA1LjUzMzUzODQ2LDAuMjI3NjkyMzA4IEMzLjI5ODQ2MTU0LDAuNDY0IDEuMDQ0OTIzMDgsMi4xNDU4NDYxNSAwLjI4Njc2OTIzMSw0LjM2NDkyMzA4IEMwLjE2NTQ2OTU2MSw0LjcxOTk2MDkxIDAuMDgxMzYxNjg4OCw1LjA1MjU1MTM0IDAuMDM2OTIzMDc2OSw1LjM2MDc4OTAyIEwwLjAzNjkyMzA3NjksNi4yODM0NDMwNiBMMC4wMzY5MjMwNzY5LDYuMjgzNDQzMDYgWiIgaWQ9IkNsaXAtMiIgZmlsbD0iI0E1NDM0MCI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkuNDA0NjI3MjksMTQuMTE2OTIzMSBDMTIuOTM3NzM3MywxMy43NTQ1MjM2IDE1LjY5NDE1MzgsMTAuNzY5MDQxIDE1LjY5NDE1MzgsNy4xMzk2OTIzMSBDMTUuNjk0MTUzOCwzLjI2NTg0NjE1IDEyLjU1Mzg0NjIsMC4xMjYxNTM4NDYgOC42ODA2MTUzOCwwLjEyNjE1Mzg0NiBDNC44MDY3NjkyMywwLjEyNjE1Mzg0NiAxLjY2NjQ2MTU0LDMuMjY1ODQ2MTUgMS42NjY0NjE1NCw3LjEzOTY5MjMxIEMxLjY2NjQ2MTU0LDEwLjc2OTA0MSA0LjQyMjg3ODA5LDEzLjc1NDUyMzYgNy45NTY0OTQxNiwxNC4xMTY5MjMxIEw5LjQwNDYyNzI5LDE0LjExNjkyMzEgTDkuNDA0NjI3MjksMTQuMTE2OTIzMSBaIiBpZD0iTWFzayIgZmlsbD0iI0ZGNTg1OCI+PC9wYXRoPiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuODA3Mzg0NjIsMC4wNjE1Mzg0NjE1IEM4LjEzOTA3NjkyLDAuMDYxNTM4NDYxNSA4LjQyNjQ2MTU0LDAuMDcyIDguNzAyMTUzODUsMC4wNzY5MjMwNzY5IEMxMi41MzY2MTU0LDAuMTQ3MDc2OTIzIDE1LjY5MDQ2MTUsMy4yMzI2MTUzOCAxNS42OTA0NjE1LDcuMDM2OTIzMDggQzE1LjY5MDQ2MTUsNy4yNDggMTUuNjgwNjE1NCw3LjQ1NjYxNTM4IDE1LjY2MTUzODUsNy42NjMzODQ2MiBDMTQuNjM5Mzg0Niw3LjU4MDMwNzY5IDEzLjIyOTUzODUsNi4yMzY5MjMwOCAxMi45MDI3NjkyLDUuMTQ1ODQ2MTUgQzExLjg0MDYxNTQsMS44MzM4NDYxNSA5LjIwNjc2OTIzLDAuMjU0NzY5MjMxIDYuMzQ4OTIzMDgsMC4xMzcyMzA3NjkgQzYuOTM3MjMwNzcsMC4wNzY5MjMwNzY5IDcuNDA0OTIzMDgsMC4wNjE1Mzg0NjE1IDcuODA3Mzg0NjIsMC4wNjE1Mzg0NjE1IEw3LjgwNzM4NDYyLDAuMDYxNTM4NDYxNSBaIiBpZD0iQ2xpcC04IiBmaWxsPSIjMjQyNzI2Ij48L3BhdGg+ICAgICAgICAgICAgICAgIDwvZz4gICAgICAgICAgICA8L2c+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=",line:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPmxpbmU8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBza2V0Y2g6dHlwZT0iTVNQYWdlIj4gICAgICAgIDxnIGlkPSJMaW5lLTEyLSstT3ZhbC0yMy0rLU92YWwtMjQiIHNrZXRjaDp0eXBlPSJNU0xheWVyR3JvdXAiPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy41MTA4MzA5LDIuNDg5MTY5NDIgTDEuOTY0MzMxMjEsMTQuMDM1NjY5MyIgaWQ9IkxpbmUtMTIiIHN0cm9rZT0iIzY2NiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0ic3F1YXJlIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj48L3BhdGg+ICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC0yMyIgZmlsbD0iIzY2NiIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCIgY3g9IjIiIGN5PSIxNCIgcj0iMiI+PC9jaXJjbGU+ICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC0yNCIgZmlsbD0iIzY2NiIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCIgY3g9IjE0IiBjeT0iMiIgcj0iMiI+PC9jaXJjbGU+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=",point:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPnBvaW50PC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxkZWZzPjwvZGVmcz4gICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc2tldGNoOnR5cGU9Ik1TUGFnZSI+ICAgICAgICA8ZyBpZD0ienB0LTMiIHNrZXRjaDp0eXBlPSJNU0xheWVyR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuMDAwMDAwLCAxLjAwMDAwMCkiPiAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjA1MDY1MzU3LDkuOTI2MzkwNjkgTDQuNDAxNDU4MDcsMTMuNDI0NzQxNCBDNC4wOTQ3NzIwMSwxNS4wNzczOTUxIDQuNjQ4NDI3NTQsMTUuMzEyNTQzMyA1LjYyMjA1MDkxLDEzLjkyOTMzNTUgQzUuNjIyMDUwOTEsMTMuOTI5MzM1NSA4LjUyNzczNjYsMTAuMTIwODc2NyA5LjU5MzU0MzE4LDcuMjI2MTYxMTMgQzkuNjgxNjg2OTksNi45ODY3NjM3NyA5LjgwMDkwMTk2LDYuNTc4ODU1MzkgOS44NzQ2NDA4Nyw2LjA3MjY1MjQ3IEM5Ljk1NjY3MzcxLDUuNzE1OTc3NDEgMTAsNS4zNDQ2NzEzMiAxMCw0Ljk2MzMyMDA2IEMxMCwyLjIyMjE1Mzk1IDcuNzYxNDIzODksMCA1LDAgQzIuMjM4NTc2MTEsMCAwLDIuMjIyMTUzOTUgMCw0Ljk2MzMyMDA2IEMwLDcuNzA0NDg2MTcgMi4yMzg1NzYxMSw5LjkyNjY0MDEyIDUsOS45MjY2NDAxMiBDNS4wMTY5MDQyNSw5LjkyNjY0MDEyIDUuMDMzNzg4OSw5LjkyNjU1Njg1IDUuMDUwNjUzNTcsOS45MjYzOTA2OSBaIiBpZD0iUGF0aC0xOTIiIGZpbGw9IiM2NjYiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4gICAgICAgICAgICA8ZWxsaXBzZSBpZD0iT3ZhbC02NCIgZmlsbD0iI0ZGRkZGRiIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCIgY3g9IjUiIGN5PSI0LjkyMzA3NjkyIiByeD0iMS44NzUiIHJ5PSIxLjg0NjE1Mzg1Ij48L2VsbGlwc2U+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=",polygon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiICAgd2lkdGg9IjE2IiAgIGhlaWdodD0iMTYiICAgdmlld0JveD0iMCAwIDE2IDE2IiAgIGlkPSJzdmcyIiAgIHZlcnNpb249IjEuMSIgICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjkxIHIxMzcyNSIgICBzb2RpcG9kaTpkb2NuYW1lPSJwb2x5Z29ucyAoMSkuc3ZnIj4gIDxtZXRhZGF0YSAgICAgaWQ9Im1ldGFkYXRhMjQiPiAgICA8cmRmOlJERj4gICAgICA8Y2M6V29yayAgICAgICAgIHJkZjphYm91dD0iIj4gICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PiAgICAgICAgPGRjOnR5cGUgICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+ICAgICAgPC9jYzpXb3JrPiAgICA8L3JkZjpSREY+ICA8L21ldGFkYXRhPiAgPGRlZnMgICAgIGlkPSJkZWZzMjIiIC8+ICA8c29kaXBvZGk6bmFtZWR2aWV3ICAgICBwYWdlY29sb3I9IiNmZmZmZmYiICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIgICAgIGJvcmRlcm9wYWNpdHk9IjEiICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAiICAgICBndWlkZXRvbGVyYW5jZT0iMTAiICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIgICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMDE3IiAgICAgaWQ9Im5hbWVkdmlldzIwIiAgICAgc2hvd2dyaWQ9ImZhbHNlIiAgICAgaW5rc2NhcGU6em9vbT0iMTQuNzUiICAgICBpbmtzY2FwZTpjeD0iOCIgICAgIGlua3NjYXBlOmN5PSI4IiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjE5MTIiICAgICBpbmtzY2FwZTp3aW5kb3cteT0iLTgiICAgICBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iZzYiIC8+ICA8dGl0bGUgICAgIGlkPSJ0aXRsZTQiPnBvbHlnb25zPC90aXRsZT4gIDxnICAgICBpZD0iZzYiICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiICAgICBmaWxsPSIjNjY2Ij4gICAgPHBhdGggICAgICAgZD0iTTE0IDEzSDJ2MmgxMnYtMnpNMTMuNzY2IDEuMDI4TDEuMzkgNC4wMTJsLjQ2OCAxLjk0NCAxMi4zNzYtMi45ODQtLjQ2OC0xLjk0NHoiICAgICAgIGlkPSJwYXRoOCIgLz4gICAgPHBhdGggICAgICAgZD0ibSAxMi43Njc1NTQsMi4xMzU1OTMyIDAsMTEuODQwNDA2OCAxLjk2MTI2LDAgMCwtMTEuODQwNDA2OCAtMS45NjEyNiwwIHogTSAxLDUuOTE0MzIwMiAxLDEzLjk3NiBsIDEuOTYxMjU5MSwwIDAsLTguMDYxNjc5OCAtMS45NjEyNTkxLDAgeiIgICAgICAgaWQ9InBhdGgxMCIgICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4gICAgPGNpcmNsZSAgICAgICBjeD0iMTQiICAgICAgIGN5PSIxNCIgICAgICAgcj0iMiIgICAgICAgaWQ9ImNpcmNsZTEyIiAvPiAgICA8Y2lyY2xlICAgICAgIGN4PSIxNCIgICAgICAgY3k9IjIiICAgICAgIHI9IjIiICAgICAgIGlkPSJjaXJjbGUxNCIgLz4gICAgPGNpcmNsZSAgICAgICBjeD0iMiIgICAgICAgY3k9IjE0IiAgICAgICByPSIyIiAgICAgICBpZD0iY2lyY2xlMTYiIC8+ICAgIDxjaXJjbGUgICAgICAgY3g9IjIiICAgICAgIGN5PSI1IiAgICAgICByPSIyIiAgICAgICBpZD0iY2lyY2xlMTgiIC8+ICA8L2c+PC9zdmc+",history_back:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOSIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDE5IDEyIj48cGF0aCBmaWxsPSIjNjY2IiBkPSJNMTguOTg3IDhDMTguNzQ4IDMuNTMzIDE1LjI2NCAwIDExIDAgNy4wNjIgMCAzLjc4OSAzLjAyIDMuMTI0IDdIMGw0LjUgNUw5IDdINS42NjhDNi4yNiA0LjQxMSA4LjM2OCAyLjUgMTEgMi41YzIuOTU4IDAgNS4yNTMgMi40MjQgNS40ODEgNS41aDIuNTA2eiIvPjwvc3ZnPg==",history_forw:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOSIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDE5IDEyIj48cGF0aCBmaWxsPSIjNjY2IiBkPSJNIDAsOCBDIDAuMjM5LDMuNTMzIDMuNzIzLDAgNy45ODcsMCBjIDMuOTM4LDAgNy4yMTEsMy4wMiA3Ljg3Niw3IGwgMy4xMjQsMCAtNC41LDUgLTQuNSwtNSAzLjMzMiwwIEMgMTIuNzI3LDQuNDExIDEwLjYxOSwyLjUgNy45ODcsMi41IDUuMDI5LDIuNSAyLjczNCw0LjkyNCAyLjUwNiw4IEwgMCw4IFoiLz48L3N2Zz4=",print:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyNiAyNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnPjxwYXRoIGQ9Ik0yMCAyMGgxLjAxYzEuMSAwIDEuOTktLjg5NCAxLjk5LTIuMDAzVjkuMDAzQzIzIDcuODk3IDIyLjEwMiA3IDIxLjAxIDdIMjB2LS45OTVDMjAgNC44OTggMTkuMTAzIDQgMTcuOTk0IDRIOC4wMDZDNi44OTggNCA2IDQuODk0IDYgNi4wMDVWN0g0Ljk5QzMuODkgNyAzIDcuODk0IDMgOS4wMDN2OC45OTRDMyAxOS4xMDMgMy44OTggMjAgNC45OSAyMEg2djNoMTR2LTN6bTAtMmgxVjlINXY5aDF2LTNoMTR2M3pNOCA2aDEwdjFIOFY2em0wIDExaDEwdjRIOHYtNHptMC02Yy0uNTUyIDAtMSAuNDQ0LTEgMSAwIC41NTIuNDQ0IDEgMSAxIC41NTIgMCAxLS40NDQgMS0xIDAtLjU1Mi0uNDQ0LTEtMS0xeiIgZmlsbD0iIzRENEQ0RCIvPjwvZz48L2c+PC9zdmc+",none:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+ICAgICAgICA8dGl0bGU+Q29uc3RydWN0b3Igbm9uZSBjb250ZW50X2ljbjwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz48L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPiAgICAgICAgPGcgaWQ9IkNvbnN0cnVjdG9yLW5vbmUtY29udGVudF9pY24iIGZpbGw9IiMzMzMzMzMiPiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtMjMzIiB4PSI0IiB5PSIxMSIgd2lkdGg9IjEyIiBoZWlnaHQ9IjIiPjwvcmVjdD4gICAgICAgIDwvZz4gICAgPC9nPjwvc3ZnPg==",t:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48dGl0bGU+Y29uc3RydWN0b3IgdGV4dCBJY248L3RpdGxlPjxwYXRoIGQ9Ik02IDZoMnYzSDZWNnptMTAgMGgydjNoLTJWNnpNOCA2aDh2Mkg4VjZ6bTMgMmgydjhoLTJWOHptLTIgOGg2djJIOXYtMnoiIGZpbGw9IiMzMzMiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg==",num:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHZlcnNpb249IjEuMSIgaWQ9InN2ZzIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIiBzb2RpcG9kaTpkb2NuYW1lPSJudW0uc3ZnIiBpbmtzY2FwZTp2ZXJzaW9uPSIwLjkxIHIxMzcyNSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHZpZXdCb3g9Ii0yNzEgMzYzIDY4IDY4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IC0yNzEgMzYzIDY4IDY4OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHNvZGlwb2RpOm5hbWVkdmlldyAgc2hvd2dyaWQ9InRydWUiIGlua3NjYXBlOmN5PSIxOC43ODE1NjYiIGlua3NjYXBlOmN4PSItNS4zMTU1NTU2IiBpbmtzY2FwZTp6b29tPSIzLjk1OTc5OCIgYm9yZGVyb3BhY2l0eT0iMS4wIiBib3JkZXJjb2xvcj0iIzY2NjY2NiIgcGFnZWNvbG9yPSIjZmZmZmZmIiBpZD0iYmFzZSIgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIgaW5rc2NhcGU6d2luZG93LXk9Ii04IiBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJ0ZXh0NDE0MiIgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IiBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIiBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSIxMDE3IiBpbmtzY2FwZTp3aW5kb3cteD0iMTkxMiIgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxOTIwIj48aW5rc2NhcGU6Z3JpZCAgdHlwZT0ieHlncmlkIiBpZD0iZ3JpZDQxNDAiPjwvaW5rc2NhcGU6Z3JpZD48L3NvZGlwb2RpOm5hbWVkdmlldz48ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLC05NjcuMzIyODMpIiBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciI+PGcgaWQ9InRleHQ0MTQyIiB0cmFuc2Zvcm09InNjYWxlKDAuOTg0Njk1MSwxLjAxNTU0MjgpIj48cGF0aCBpZD0icGF0aDQxNDciIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIGQ9Ik0tMjM4LjksMTM1Ni4zaC00LjZsLTEyLjMtMjN2MjNoLTMuNHYtMjUuN2g1LjhsMTEuMSwyMXYtMjFoMy40Qy0yMzguOSwxMzMwLjctMjM4LjksMTM1Ni4zLTIzOC45LDEzNTYuM3ogTS0yMjEsMTMzNy44YzAsMi42LTAuNiw0LjUtMS44LDUuN2MtMS4yLDEuMy0yLjksMS45LTUuMSwxLjljLTIuMywwLTQtMC42LTUuMi0xLjlzLTEuNy0zLjItMS43LTUuN2MwLTIuNiwwLjYtNC41LDEuOC01LjdzMi45LTEuOSw1LjEtMS45YzIuMywwLDQsMC42LDUuMSwxLjlTLTIyMSwxMzM1LjMtMjIxLDEzMzcuOHogTS0yMjQuMywxMzM3LjhjMC0yLTAuMy0zLjQtMC44LTQuMXMtMS41LTEuMi0yLjctMS4yYy0xLjMsMC0yLjIsMC40LTIuOCwxLjJjLTAuNSwwLjgtMC44LDIuMi0wLjgsNC4yYzAsMiwwLjMsMy40LDAuOCw0LjJjMC41LDAuOCwxLjUsMS4yLDIuOCwxLjJjMS4zLDAsMi4yLTAuNCwyLjctMS4yQy0yMjQuNiwxMzQxLjItMjI0LjMsMTMzOS44LTIyNC4zLDEzMzcuOEwtMjI0LjMsMTMzNy44eiBNLTIzMi4xLDEzNTBoOC4ydjIuN2gtOC4yQy0yMzIuMSwxMzUyLjgtMjMyLjEsMTM1MC0yMzIuMSwxMzUweiIvPjwvZz48L2c+PC9zdmc+"};
t({getImage:function(t){return e[t]||null}})}),modules.define("point-controller",["ymaps-api","ymaps-preset-utils","i18n-plus","base-editor-controller","point-balloon-layout","util-inline-image","ymaps-zIndex"],function(t,e,i,o,n,s,r,a){var c=e.util.defineClass(function(t,e){c.superclass.constructor.call(this,t,e),this.events.add("geoObjectAdd",this._newGeoObjectHandler,this),this._collectionListener.add("dragstart",this._onGeoObjectDragStart,this).add("dragend",this._onGeoObjectDragEnd,this)},n,{getName:function(){return"point"},destroy:function(){this.events.remove("geoObjectAdd",this._newGeoObjectHandler,this),c.superclass.destroy.call(this)},getButtonData:function(){return{data:{content:o("sidebar","point"),image:r.getImage("point"),title:o("sidebar","point_title")},options:{maxWidth:150,floatIndex:1e3}}},getBalloonContentLayout:function(){return s},getCollectionOptions:function(){return{hideIconOnBalloonOpen:!1,balloonOffset:[0,-25],balloonMaxWidth:9999,balloonMaxHeight:9999}},createGeoObject:function(t,i){return new e.Placemark(t,i||{},{preset:this.getLastPreset()})},getLastPreset:function(){return c.superclass.getLastPreset.call(this)||"islands#blueIcon"},disableAddingNewObjects:function(){c.superclass.disableAddingNewObjects.call(this),this._button.deselect()},afterMapClick:function(t){t.balloon.open()},processStyle:function(t){var e=t.options.get("preset");t.options.set("balloonOffset",this._getBalloonOffsetOption(e))},addToMap:function(){c.superclass.addToMap.call(this),this._collection.options.set("draggable",!0)},removeFromMap:function(){this._collection.options.set("draggable",!1),c.superclass.removeFromMap.call(this)},_onBalloonClose:function(t){c.superclass._onBalloonClose.call(this,t),this.has(this._commonDataProvider.get("editableGeoObject"))&&this._setEditableGeoObject(null)},_getBalloonOffsetOption:function(t){if(!t)return[0,-17];var e=t.toLowerCase(),o=i.findPictogram(t);return o?e.indexOf("circle")>-1?[0,-21]:[5,-58]:-1===e.indexOf("circle")?[2,-41]:[0,-17]},_newGeoObjectHandler:function(t){var e=t.get("geoObject");e.options.set("balloonOffset",this._getBalloonOffsetOption(i.fixPresetName(e.options.get("preset"))))},_onGeoObjectDragStart:function(t){var e=t.get("target");a.setZIndex(e,"drag"),this.events.fire("geoObjectDragStart",{geoObjectId:e.properties.get("geoObjectId")})},_onGeoObjectDragEnd:function(t){var e=t.get("target");a.unsetZIndex(e,"drag"),this.events.fire("geoObjectDragEnd",{geoObjectId:e.properties.get("geoObjectId")})}});t(c)}),modules.define("base-editor-controller",["ymaps-api","ymaps-preset-utils","ymaps-utils","ymaps-zIndex","map-data-default","yametrika"],function(t,e,i,o,n,s,r){var a=0,c=function(t,i){this._map=t,this._collection=new e.GeoObjectCollection({},this.getCollectionOptions()),this._map.geoObjects.add(this._collection),this._editorListeners={},this._commonDataProvider=i,this._commonDataListener=this._commonDataProvider.createListener(),this._button=new e.control.Button(this.getButtonData()),this._button.events.add("select",this.startDrawing,this).add("click",function(){this._button.state.get("selected")||r.reachGoal("MAP_CONTROL",{cnstControlUsed:this.getName()})},this).add("deselect",function(){this.stopDrawing()},this).add("disable",function(){this._teardownMapClick()},this),this.events=new e.event.Manager({context:this}),this._drawing=!1,this._addedToMap=!1,this._collectionListener=this._collection.events.group().add("add",this.onGeoObjectAdd,this).add("remove",this.onGeoObjectRemove,this).add("dragstart",function(t){var e=t.get("target");e.balloon.isOpen()&&e.balloon.close()},this).add("editorstatechange",function(t){var e=t.get("target");e.editor.state.get("editing")?e.options.set("draggable",!0):e.options.unset("draggable")}).add("geometrychange",function(t){var e=t.get("target"),i=t.get("originalEvent");e!==this._collection&&this.checkGeometryChange(i.get("oldCoordinates"),i.get("newCoordinates"))&&this.onGeoObjectGeometryChange(e)},this)};c.prototype._onBalloonOpen=function(t){var o=t.get("target");if(this._lastBalloonOwner!==o){this._commonDataProvider.get("editableGeoObject")!==o&&this._setEditableGeoObject(o),this._lastBalloonOwner=o,this._balloonOwnerPropertiesListener=new e.Monitor(o.properties),this._balloonOwnerPropertiesListener.add(["iconContent","iconCaption","name","description"],function(){this._fireGeoObjectUpdate(o,"properties")},this),this._balloonOwnerOptionsListener=new e.Monitor(o.options),this._balloonOwnerOptionsListener.add("preset",function(t,e){t=i.fixPresetName(t),e=i.fixPresetName(e),t!==e&&(this._fireGeoObjectUpdate(o,"options"),this._lastPreset=t)},this);var n=this.getPresetOptionsList();n&&this._balloonOwnerOptionsListener.add(n,function(){this.processStyle(o)},this),o.editor.startEditing(),this.events.fire("setActiveGeoObject",{target:o}),this.events.fire("geoObjectBalloonOpen",{target:o})}},c.prototype._onBalloonClose=function(t){this._balloonOwnerOptionsListener&&this._balloonOwnerOptionsListener.removeAll(),this._balloonOwnerPropertiesListener&&this._balloonOwnerPropertiesListener.removeAll(),this._lastBalloonOwner=null,this.events.fire("geoObjectBalloonClose",{target:t.get("target")})},c.prototype.onGeoObjectAdd=function(t){var i=t.get("child"),o=++a;i.state.set("editorControllerID",o);var n=new e.Monitor(i.editor.state);this._editorListeners[o]=n,n.add("editing",function(t,e){this.onGeoObjectEditingChange(i,t,e)},this).add("drawing",function(t,e){if(!this._addedToMap||!this.canAddNewObject())return void(t||this.stopDrawing());if(!i.getMap())return void this._setupMapClick();if(t||this._drawingGeoObject===i){t?(this.startDrawing(),this._teardownMapClick(),this._drawingGeoObject=i):this._drawingGeoObject=null,!t&&this._drawing&&this._setupMapClick();var o=this._commonDataProvider.get("editableGeoObject");this._skipBalloon||o&&o!==i||this.onGeoObjectDrawingChange(i,t,e),this.events.fire("setDrawingMode",{state:t})}},this),this.events.fire("geoObjectAdd",{geoObject:i})},c.prototype._fireGeoObjectUpdate=function(t,e){this.events.fire("geoObjectUpdate",{geoObject:t,field:e})},c.prototype.onGeoObjectRemove=function(t){var e=t.get("child"),i=e.state.get("editorControllerID");this._editorListeners[i].removeAll(),delete this._editorListeners[i],this.events.fire("geoObjectRemove",{geoObject:e})},c.prototype.onPresetChanged=function(){},c.prototype.onGeoObjectEditingChange=function(){},c.prototype.onGeoObjectDrawingChange=function(t,e){e||t.balloon.open(o.getGeoObjectCenter(t))},c.prototype.onGeoObjectGeometryChange=function(t){this._fireGeoObjectUpdate(t,"geometry")},c.prototype.getPresetOptionsList=function(){},c.prototype.onStartDrawing=function(){this._map.options.set(e.util.extend({},s.disabledGeoObjectCollection,{geoObjectCursor:"arrow"})),this._setupMapClick()},c.prototype.onStopDrawing=function(){this._map.options.unset(Object.keys(s.disabledGeoObjectCollection)),this._drawingGeoObject&&(this._drawingGeoObject.editor.stopEditing(),this._drawingGeoObject=null),this._teardownMapClick()},c.prototype.setEditableGeoObject=function(t){if((!t||this.has(t))&&t!==this._commonDataProvider.get("editableGeoObject")){var e=this._commonDataProvider.get("activeController");e&&e.stopDrawing(!0),this._setEditableGeoObject(t),t&&t.editor.startEditing()}},c.prototype.getLastPreset=function(){return this._lastPreset},c.prototype.getButtonData=function(){return{}},c.prototype.getCollectionOptions=function(){return{}},c.prototype.getBalloonContentLayout=function(){return{}},c.prototype.processStyle=function(){return!1},c.prototype.startDrawing=function(){if(!this._addedToMap||!this.canAddNewObject())return!1;if(!this._drawing){var t=this._commonDataProvider.get("activeController");this._commonDataProvider.set("activeController",this,!0),t&&t.stopDrawing(),this._drawing=!0,this.events.fire("startDrawing",{controllerName:this.getName()}),this.onStartDrawing(),this._button.select(),this._map.layers.options.set("trafficJamInteractivityModel","default#silent"),this._cursorAccessor=this._map.cursors.push("arrow")}return this._drawing},c.prototype.disableAddingNewObjects=function(){this._button.disable()},c.prototype.enableAddingNewObjects=function(){this._button.enable()},c.prototype.canAddNewObject=function(){return this._button.isEnabled()},c.prototype.stopDrawing=function(t){this._drawing&&(this._skipBalloon=t,this._drawing=!1,this.events.fire("stopDrawing"),this.onStopDrawing(),this._button.deselect(),this._map.layers.options.unset("trafficJamInteractivityModel"),this._cursorAccessor.remove(),this._commonDataProvider.get("activeController")===this&&this._commonDataProvider.unset("activeController"),this._skipBalloon=!1)},c.prototype.addToMap=function(){this._addedToMap||(this._addedToMap=!0,this._map.controls.add(this._button),this._collection.options.set("balloonContentLayout",this.getBalloonContentLayout()),this._map.events.add("actiontick",this._onMapActionTick,this).add("click",this._onMapClick,this),this._collectionBalloonListener=this._collection.events.group().add(["mouseenter","dragend"],function(t){var e=t.get("target");e.editor.state.get("drawing")||(n.setZIndex(e,"focus"),this.events.fire("setFocusedGeoObject",{target:t.get("target")}))},this).add(["mouseleave","dragstart"],function(t){n.unsetZIndex(t.get("target"),"focus"),this.events.fire("unsetFocusedGeoObject")},this).add("balloonopen",this._onBalloonOpen,this).add("balloonclose",this._onBalloonClose,this))},c.prototype.removeFromMap=function(){this._addedToMap&&(this._addedToMap=!1,this.has(this._commonDataProvider.get("editableGeoObject"))&&this._setEditableGeoObject(),this._balloonOwnerOptionsListener&&this._balloonOwnerOptionsListener.removeAll(),this._lastBalloonOwner&&(this._lastBalloonOwner.balloon.close(),this._lastBalloonOwner=null),this._map.events.remove("actiontick",this._onMapActionTick,this).remove("click",this._onMapClick,this),this.stopDrawing(),this._map.controls.remove(this._button),this._collection.options.unset("balloonContentLayout"),this._collectionBalloonListener.removeAll())},c.prototype.getGeoObjects=function(){for(var t=[],e=this._collection.getIterator(),i=e.getNext();i!==e.STOP_ITERATION;)t.push(i),i=e.getNext();return t},c.prototype.checkGeometryChange=function(t,e){return t.toString().replace(/,/g,"")!==e.toString().replace(/,/g,"")},c.prototype.addGeoObject=function(t,e){!this.canAddNewObject()&&!e||this.has(t)||this._collection.add(t)},c.prototype.removeGeoObject=function(t){this.has(t)&&this._collection.remove(t)},c.prototype.updateGeoObject=function(t,e){if(e.geometry){var i=this.checkGeometryChange(t.geometry.getCoordinates(),e.geometry.coordinates);i&&t.geometry.setCoordinates(e.geometry.coordinates)}if(e.options){t.options.set(e.options);var o=t.options.get("preset");this.processStyle(t),o!==t.options.get("preset")&&this._fireGeoObjectUpdate(t,"options")}e.properties&&t.properties.set(e.properties)},c.prototype.has=function(t){return this._collection.indexOf(t)>-1},c.prototype.removeAllGeoObjects=function(){this._collection.removeAll()},c.prototype.destroy=function(){this.removeFromMap(),this._commonDataListener.destroy(),this._collectionListener.removeAll(),this.removeAllGeoObjects(),this._map&&(this._map.geoObjects.remove(this._collection),this._map=null)},c.prototype.getName=function(){return""},c.prototype._onMapActionTick=function(t){this._map.balloon.isOpen()&&t.get("tick").zoom!==this._map.getZoom()&&this._map.balloon.close()},c.prototype._onMapClick=function(){var t=this._commonDataProvider.get("editableGeoObject");t&&(t.editor.state.get("drawing")?t.balloon.isOpen()&&t.balloon.close():this._setEditableGeoObject())},c.prototype._setEditableGeoObject=function(t){var e=this._commonDataProvider.get("editableGeoObject");t!==e&&(t?(this._commonDataProvider.set("editableGeoObject",t,!0),n.setZIndex(t,"active")):(this._commonDataProvider.unset("editableGeoObject"),this.events.fire("unsetActiveGeoObject")),e&&(n.unsetZIndex(e,"active"),e.editor.stopEditing(),e.balloon.isOpen()&&e.balloon.close()))},c.prototype._setupMapClick=function(){this._mapListener=this._map.events.group().add("click",function(t){if(this._map.balloon&&this._map.balloon.isOpen())return void this._map.balloon.close();var e=this.createGeoObject(t.get("coords"));this.processStyle(e),this.addGeoObject(e),this.afterMapClick(e),this._setEditableGeoObject(e),this.events.fire("setActiveGeoObject",{target:e})},this)},c.prototype._teardownMapClick=function(){this._mapListener&&this._mapListener.removeAll()},c.prototype.createGeoObject=function(){},c.prototype.afterMapClick=function(){},t(c)}),modules.define("point-balloon-layout",["i-bem-dom","bh","jquery","ymaps-api","i18n-plus","ymaps-preset-utils","ymaps-utils","ymaps-geoObject-colors","util-inline-image","config","history-manager","balloon-setup","textarea","select","input","radio-group","button"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p,m,g,f,_){var b=r.getPictograms(),v=[{val:"cnst_dot",text:'<svg class="menu-preview balloon-setup__svg_preview" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 70.9 70.9"><ellipse class="color_dot" cx="35.15" cy="34.549" rx="16.2" ry="16.9" fill="#1e97ff"/></svg>'}];b.forEach(function(t){v.push({text:"",val:t,icon:'<div class="menu-preview '+r.getIconClassName(t)+'"></div>'})});var y,M="MacOS"===d.uatraits.OSFamily?"Cmd + (← Backspace)":"(Delete)",j={block:"balloon-setup",content:[{block:"input",mods:{theme:"islands",size:"m","fire-blur-change":!0},mix:{block:"balloon-setup",elem:"caption"},validate:{message:s("popup","limit_warning_caption"),conditionals:"length:"+d.limits.size.iconCaption},placeholder:s("balloon","icon_caption_example")},{elem:"description",tag:"label",content:[{block:"textarea",mods:{theme:"islands",size:"m",width:"available","fire-blur-change":!0},validate:{message:s("popup","limit_warning_desc"),conditionals:"length:"+d.limits.size.iconDescription},attrs:{rows:4},placeholder:s("balloon","balloon_content_example")}]},{elem:"placemark-default-options",mix:{block:"balloon-setup",elem:"grid"},content:[{elem:"row",content:[{elem:"color-option",tag:"label",content:[{elem:"label-text",tag:"span",content:s("balloon","color")},{block:"select",mods:{mode:"radio",theme:"colors",size:"m"},name:"color",val:0,mix:{block:"balloon-setup",elem:"color-selector"},options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map(function(t){return{val:t,text:t}})}]},{elem:"type-option",mix:[{block:"balloon-setup",elem:"right-cell"},{block:"balloon-setup",elem:"content-cell"}],content:[{elem:"label-text",content:s("balloon","type")},{block:"radio-group",mods:{mode:"radio",theme:"type-icons",size:"m",type:"button"},name:"type",options:[{val:"Icon",text:"Icon"},{val:"CircleIcon",text:"CircleIcon"}]},{block:"radio-group",mods:{mode:"radio",theme:"islands",size:"m",type:"button"},name:"contentType",options:[{val:"",text:"—"},{val:"number",text:"№"},{val:"icon",text:s("balloon","icon")}],mix:{block:"balloon-setup",elem:"content-type-selector"}},{block:"select",mods:{mode:"radio",theme:"icons",size:"m"},mix:{block:"balloon-setup",elem:"icon-selector"},val:0,options:v},{elem:"number-input-holder",content:{block:"input",mods:{theme:"islands",size:"m",type:"number","fire-blur-change":!0},mix:{block:"balloon-setup",elem:"number"},maxLength:d.limits.size.iconContent,placeholder:"0-999"}}]}]},{elem:"spacer"}]},{elem:"button-holder",content:[{block:"button",mods:{theme:"islands",size:"s",view:"action",id:"save-button"},text:s("balloon","save"),mix:{block:"balloon-setup",elem:"save-button"}},{block:"button",mods:{theme:"islands",size:"s",view:"pseudo",id:"remove-button"},title:s("balloon","remove")+" "+M,text:s("balloon","remove"),mix:{block:"balloon-setup",elem:"remove-button"}}]}]},I=/^islands#[a-z]+(Circle)?Icon$/,C="",k=n.templateLayoutFactory.createClass("",{build:function(){k.superclass.build.call(this),y||(y=!0,this.getData().geoObject.getMap().events.once("destroy",function(){y=!1,C=""},this)),this.getElement().parentNode.parentNode.className+=" ymaps_balloon-object_placemark",this._bemContent=e.append(this.getElement(),i.apply(j)).bem(h),this._balloonContentTextarea=this._bemContent.findChildBlock(p);var t=this._bemContent.findChildBlocks(m);this._colorSelector=t.get(0),this._iconSelector=t.get(1),this._numberHolder=this._bemContent.findChildElem("number-input-holder");var o=this._bemContent.findChildBlocks(g);this._captionInput=o.get(0),this._numberInput=o.get(1);var s=this._bemContent.findChildBlocks(f);this._typeRadioGroup=s.get(0),this._typeContentRadioGroup=s.get(1),this._saveButton=this._bemContent.findChildBlocks({block:_,modName:"id",modVal:"save-button"}),this._removeButton=this._bemContent.findChildBlocks({block:_,modName:"id",modVal:"remove-button"});var a=this.getData().geoObject,c=r.fixPresetName(a.options.get("preset"),"islands#blueIcon");this._updatePreset(c,a.properties.get("iconContent","")),this._updateProperties(a.properties),this._presetMonitor=new n.Monitor(a.options),this._propertiesMonitor=new n.Monitor(a.properties),this._presetMonitor.add("preset",this._onGeoObjectPresetChange,this),this._propertiesMonitor.add(["description","iconContent","iconCaption"],this._onGeoObjectPropertyChange,this),this._bemContent._events(this._balloonContentTextarea).on("change",this._onBalloonContentChange,this).on("blurChange",this._onBalloonContentBlurChange,this),this._bemContent._events(this._colorSelector).on("change",this._onColorSelectorChange,this),this._bemContent._events(this._iconSelector).on("change",this._onIconSelectorChange,this),this._bemContent._events(this._numberInput).on("change",this._onNumberInputChange,this).on("blurChange",this._onNumberInputBlurChange,this),this._bemContent._events(this._captionInput).on("change",this._onCaptionInputChange,this).on("blurChange",this._onCaptionInputBlurChange,this),this._bemContent._events(this._typeRadioGroup).on("change",this._applyPreset,this),this._bemContent._events(this._typeContentRadioGroup).on("change",this._onContentRadioGroupChange,this),this._bemContent._events(this._removeButton).on("click",this._onRemoveButtonClick,this),this._bemContent._events(this._saveButton).on("click",this._closeBalloon,this),this._applyColor(),this._applyForms(),"number"===C&&I.test(a.options.get("preset"))&&this._typeContentRadioGroup.setVal("number")},clear:function(){e.destruct(this._bemContent.domElem),k.superclass.clear.call(this),this._presetMonitor.removeAll(),this._propertiesMonitor.removeAll()},isEmpty:function(){return!1},_updatePreset:function(t,e){t=r.fixPresetName(t,"islands#blueIcon");var i=c.getColorNameByPreset(t),o=c.getIndexByName(i);o>-1&&this._colorSelector.setVal(o);var n,s=r.findPictogram(t),a="number"===this._typeContentRadioGroup.getVal();s?(this._iconSelector.setVal(s),n="icon"):t.toLowerCase().indexOf("dot")>-1?(this._iconSelector.setVal("cnst_dot"),n="icon"):n=e||a?"number":"",this._typeContentRadioGroup.setVal(n),this._typeRadioGroup.setVal(r.getIconType(t))},_updateProperties:function(t){this._balloonContentTextarea.setVal(t.get("description","")),this._numberInput.setVal(t.get("iconContent","")),this._captionInput.setVal(t.get("iconCaption",""))},_onBalloonContentChange:function(){this.getData().geoObject.properties.set("description",this._balloonContentTextarea.getVal())},_onBalloonContentBlurChange:function(t,e){u.addGeoObjectPropertyState("description",this.getData().geoObject.properties.get("geoObjectId"),e.newVal,e.oldVal)},_onNumberInputChange:function(){var t=this._numberInput.getVal();t=t.length>0?Number(t):"",(0>t||isNaN(t))&&(t=""),t=String(t);var e=this.getData().geoObject;e.properties.set("iconContent",t)},_onNumberInputBlurChange:function(t,e){u.addGeoObjectPropertyState("iconContent",this.getData().geoObject.properties.get("geoObjectId"),e.newVal,e.oldVal)},_onCaptionInputChange:function(){this.getData().geoObject.properties.set("iconCaption",this._captionInput.getVal())},_onCaptionInputBlurChange:function(t,e){u.addGeoObjectPropertyState("iconCaption",this.getData().geoObject.properties.get("geoObjectId"),e.newVal,e.oldVal)},_onIconSelectorChange:function(){this._applyPreset()},_onColorSelectorChange:function(){this._applyColor(),this._applyPreset()},_onContentRadioGroupChange:function(){this._applyPreset(),this._applyForms();var t=C;if(C=this._typeContentRadioGroup.getVal(),"number"!==C){var e=this._numberInput.getVal();this._lastNumberValue=e,this._numberInput.setVal(""),""!==e&&(u.addGeoObjectPropertyState("iconContent",this.getData().geoObject.properties.get("geoObjectId"),"",e),"icon"===C&&u.glueTwoLast())}else this._lastNumberValue&&(this.getData().geoObject.properties.set("iconContent",this._lastNumberValue),u.addGeoObjectPropertyState("iconContent",this.getData().geoObject.properties.get("geoObjectId"),this._lastNumberValue,""),"icon"===t&&u.glueTwoLast())},_applyColor:function(){var t=this._iconSelector,e="#"+c.getColorById(this._colorSelector.getVal());t.domElem.find(".color_dot").attr("fill",e),t.getPopup()&&t.getPopup().domElem.find(".color_dot").attr("fill",e)},_applyPreset:function(){var t,e=this.getData().geoObject.options,i=this._iconSelector.getVal(),o=this._typeRadioGroup.getVal(),n=this._typeContentRadioGroup.getVal(),s=c.getNameByIndex(this._colorSelector.getVal());t="icon"===n?"cnst_dot"===i?"islands#"+s+o.replace("Icon","DotIcon"):["islands#",s,i[0].toUpperCase(),i.substr(1),o].join(""):"islands#"+s+o,e.set("preset",t)},_applyForms:function(){var t=this._typeContentRadioGroup.getVal();this._bemContent.setMod("placemark-content",t)},_onGeoObjectPresetChange:function(t){t=r.fixPresetName(t,"islands#blueIcon"),this._updatePreset(t,this.getData().geoObject.properties.get("iconContent",""))},_onGeoObjectPropertyChange:function(t){var e=this._balloonContentTextarea.getVal()!==(t.description||""),i=this._numberInput.getVal()!==(t.iconContent||""),o=this._captionInput.getVal()!==(t.iconCaption||"");(e||i||o)&&this._updateProperties(this.getData().geoObject.properties),this._updatePreset(this.getData().geoObject.options.get("preset"),t.iconContent||"")},_onRemoveButtonClick:function(){var t=this.getData().geoObject;t.getParent().remove(t)},_closeBalloon:function(){this._numberInput.validate(),this._captionInput.validate(),this._balloonContentTextarea.validate(),this.getData().geoObject.balloon.close()}});t(k)}),modules.define("balloon-setup",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{}))}),modules.define("menu",["jquery","config"],function(t,e,i,o){function n(){var t=e("<div>").css({visibility:"hidden",width:100,overflow:"scroll"}).appendTo("body"),i=e("<div>").css({width:"100%"}).appendTo(t).outerWidth();return t.remove(),100-i}t(o.declMod({modName:"theme",modVal:"icons"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.domElem.width(this.domElem.children(":first").width()+n())}}},_onItemHover:function(t){t.hasMod("hovered")?(this._hoveredItem&&this._hoveredItem.delMod("hovered"),this._hoveredItem=t,this.domElem.attr("aria-activedescendant",t.domElem.attr("id"))):this._hoveredItem===t&&(this._hoveredItem=null,this.domElem.removeAttr("aria-activedescendant")),this._emit("item-hover",{item:t})}}))}),modules.define("line-controller",["ymaps-api","base-editor-controller","i18n-plus","line-balloon-layout","ymaps-preset-utils","util-inline-image","config","simplify-line","simplify-popup-layout","ymaps-utils"],function(t,e,i,o,n,s,r,a,c,l,d){var u=a.limits.count.vertexes,h=e.util.defineClass(function(t,e){h.superclass.constructor.call(this,t,e),this._collectionListener.add("dragstart",this._onGeoObjectDragStart,this).add("dragend",this._onGeoObjectDragEnd,this)},i,{getName:function(){return"linestring"},getButtonData:function(){return{data:{content:o("sidebar","line"),image:r.getImage("line"),title:o("sidebar","line_title")},options:{maxWidth:150,floatIndex:700}}},getBalloonContentLayout:function(){return n},getCollectionOptions:function(){return{balloonMaxWidth:9999,balloonMaxHeight:9999,editorMaxPoints:u,editorMenuManager:function(t,e){var i=e.getAllVerticesNumber();return u>i?t:(t.splice(1,0,{id:"simplifyLine",title:o("popup","simplify_line"),onClick:function(){this.simplifyGeoObject(e.getParent(),Math.floor(.99*u))}.bind(this)}),t)}.bind(this)}},getPresetOptionsList:function(){return["strokeColor","strokeWidth"]},processStyle:function(t){var e=this._map.options,i={strokeColor:t.options.get("strokeColor",e.get("geoObjectStrokeColor")),strokeWidth:Number(t.options.get("strokeWidth",e.get("geoObjectStrokeWidth")))};return t.options.set("preset",s.generatePresetByData(i)),!0},createGeoObject:function(t,i){var o=this.getLastPreset(),n={};return o&&(n.preset=o),new e.Polyline([t],i||{},n)},afterMapClick:function(t){t.editor.startDrawing()},onGeoObjectAdd:function(t){t.get("child").events.add("simplifyButtonClick",this._simplifyButtonClickHandler,this).add("mustSimplify",this._simplifyButtonClickHandler,this),h.superclass.onGeoObjectAdd.call(this,t)},onGeoObjectRemove:function(t){h.superclass.onGeoObjectRemove.call(this,t),t.get("child").events.remove("simplifyButtonClick",this._simplifyButtonClickHandler,this)},_simplifyButtonClickHandler:function(t){this.simplifyGeoObject(t.get("target"),Math.floor(.99*u))},onGeoObjectEditingChange:function(t,e){this._getViewCallback&&(this._getViewCallback.cancel(),this._getViewCallback=null),this._vertexListener&&(this._vertexListener.removeAll(),this._vertexListener=null),e&&(this._getViewCallback=d.createCanceableCallback(function(e){this._vertexListener=e.getVertexPlacemarks().events.group(),this._vertexListener.add("mouseup",function(i){this.onVertexMouseUp(t,i.get("target"),e)},this)},this),t.editor.getView().then(this._getViewCallback,this))},simplifyGeoObject:function(t,e){var i=this._commonDataProvider.get("editableGeoObject");this.events.fire("simplifyStart",{text:o("popup","data_import_step4"),geoObjectId:i.properties.get("geoObjectId")});var n=t.geometry.getCoordinates();n=c(n,e),t.geometry.setCoordinates(n),this.events.fire("simplifyEnd",{type:"line",geoObjectPoints:this._getGeoObjectPoints(i),geoObjectId:i.properties.get("geoObjectId"),count:n.length,total:u})},_getGeoObjectPoints:function(t){return t.geometry.getCoordinates()},onGeoObjectGeometryChange:function(t){this._checkEmptiness(t)||h.superclass.onGeoObjectGeometryChange.call(this,t)},onVertexMouseUp:function(t,e,i){if(t.state.get("popupShown"))return void t.options.unset("editorMenuLayout");var o=e.getParent().getLength(),n=i.getVertexViews(),s=[n[0].getPlacemark(),n[o-1].getPlacemark()].indexOf(e)>-1;s&&this._checkLimit(t)?(t.options.set("editorMenuLayout",l(this._commonDataProvider)),t.state.set("popupShown",!0)):t.options.unset("editorMenuLayout")},_checkEmptiness:function(t){return 0===t.geometry.getCoordinates().length?(this.removeGeoObject(t),!0):!1},_checkLimit:function(t){return t.geometry.getCoordinates().length>=u},_onGeoObjectDragStart:function(t){var e=t.get("target");this.events.fire("geoObjectDragStart",{geoObjectId:e.properties.get("geoObjectId")})},_onGeoObjectDragEnd:function(t){var e=t.get("target");this.events.fire("geoObjectDragEnd",{geoObjectId:e.properties.get("geoObjectId")})}});t(h)}),modules.define("line-balloon-layout",["i-bem-dom","bh","jquery","ymaps-api","i18n-plus","ymaps-geoObject-colors","config","history-manager","balloon-setup","textarea","input","select","button"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p){var m=function(t,e,i,o,n,s,r){return{elem:t,tag:"label",mix:{block:"balloon-setup",elem:o},content:[{elem:"label-text",content:e},{block:"input",mods:{theme:"islands",size:"m",type:"number",range:!0},mix:{block:"balloon-setup",elem:n},maxLength:i,min:s,max:r}]}},g="MacOS"===a.uatraits.OSFamily?"Cmd + (← Backspace)":"(Delete)",f={block:"balloon-setup",content:[{elem:"limits",content:[{elem:"limits-text",content:""},{block:"link",url:"#",content:s("popup","simplify_poly"),mix:[{block:"balloon-setup",elem:"limits-simplify-link"}]},{block:"link",url:a.hosts.createHelp,title:s("popup","simplify_help_hint"),target:"_blank",mix:[{block:"balloon-setup",elem:"limits-help-link"}]}]},{elem:"description",tag:"label",content:[{elem:"description-label-text",content:s("balloon","balloon_content")},{block:"textarea",mods:{theme:"islands",size:"m",width:"available","fire-blur-change":!0},validate:{message:s("popup","limit_warning_desc"),conditionals:"length:"+a.limits.size.iconDescription},attrs:{rows:4},placeholder:s("balloon","balloon_content_example")}]},{elem:"line-options",mix:{block:"balloon-setup",elem:"grid"},content:[{elem:"row",content:[{elem:"color-option",tag:"label",content:[{elem:"label-text",tag:"span",content:s("balloon","color")},{block:"select",mods:{mode:"radio",theme:"colors",size:"m"},name:"color",val:0,options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map(function(t){return{val:t,text:t}})}]},m("transparency-field",s("balloon","geoobject_opacity"),3,"center-cell","stroke-opacity",0,100),m("width-field",s("balloon","stroke_width"),2,"right-cell","stroke-width",0,99)]},{elem:"spacer"}]},{elem:"button-holder",content:[{block:"button",mods:{theme:"islands",size:"s",view:"action",id:"save-button"},text:s("balloon","save"),mix:{block:"balloon-setup",elem:"save-button"}},{block:"button",mods:{theme:"islands",size:"s",view:"pseudo",id:"remove-button"},title:s("balloon","remove")+" "+g,text:s("balloon","remove"),mix:{block:"balloon-setup",elem:"remove-button"}}]}]},_=n.templateLayoutFactory.createClass("",{build:function(){_.superclass.build.call(this),this._bemContent=e.append(this.getElement(),i.apply(f)).bem(l),this._balloonContentTextarea=this._bemContent.findChildBlock(d),this._bemContent.setMod("lang",a.lang);var t=this._bemContent.findChildBlocks(u);this._strokeOpacityInput=t.get(0),this._strokeWidthInput=t.get(1),this._strokeColorSelector=this._bemContent.findChildBlock(h),this._saveButton=this._bemContent.findChildBlocks({block:p,modName:"id",modVal:"save-button"}),this._removeButton=this._bemContent.findChildBlocks({block:p,modName:"id",modVal:"remove-button"});var o=this.getData().geoObject;this._updateStyle(o.options),this._updateProperties(o.properties),this._styleMonitor=new n.Monitor(o.options),this._propertiesMonitor=new n.Monitor(o.properties),this._styleMonitor.add(["strokeColor","strokeWidth"],this._onGeoObjectStyleChange,this),this._propertiesMonitor.add("description",this._onGeoObjectPropertyChange,this),this._checkLimits(),o.events.add("geometrychange",this._checkLimits,this),this._simplifyLink=this._bemContent.findChildElem("limits-simplify-link"),this._bemContent._events(this._balloonContentTextarea).on("change",this._onBalloonContentChange,this).on("blurChange",this._onBalloonContentBlurChange,this),this._bemContent._events(this._strokeOpacityInput).on("change",this._onStrokeOpacityChange,this),this._bemContent._events(this._strokeWidthInput).on("change",this._onStrokeWidthChange,this),this._bemContent._events(this._strokeColorSelector).on("change",this._onStrokeColorChange,this),this._bemContent._events(this._removeButton).on("click",this._onRemoveButtonClick,this),this._bemContent._events(this._saveButton).on("click",this._closeBalloon,this),this._bemContent._domEvents(this._simplifyLink).on("click",this._simplifyGeoObject.bind(this))},clear:function(){e.destruct(this._bemContent.domElem),_.superclass.clear.call(this)},isEmpty:function(){return!1},_updateStyle:function(t){var e=r.colorToColorAndOpacity(t.get("strokeColor")),i=r.getIndexByColor(e[0]);i>-1&&this._strokeColorSelector.setVal(i),this._strokeOpacityInput.getMod("focused")||this._strokeOpacityInput.setVal(Math.round(100-100*e[1])),this._strokeWidthInput.getMod("focused")||this._strokeWidthInput.setVal(t.get("strokeWidth"))},_updateProperties:function(t){this._balloonContentTextarea.setVal(t.get("description",""))},_checkLimits:function(){var t=this.getData().geoObject,e=t.geometry.getCoordinates().length;e>=a.limits.count.vertexes?(this._bemContent.setMod("limits",!0),this._bemContent.findChildElem("limits-text").domElem.text(s("popup","import_vlimit_header",{$thousands:["total","num"],$conjugate:e,num:e,total:a.limits.count.vertexes})+". ")):this._bemContent.setMod("limits",!1),this.events.fire("change")
},_onBalloonContentChange:function(){this.getData().geoObject.properties.set("description",this._balloonContentTextarea.getVal())},_onBalloonContentBlurChange:function(t,e){c.addGeoObjectPropertyState("description",this.getData().geoObject.properties.get("geoObjectId"),e.newVal,e.oldVal)},_onStrokeOpacityChange:function(){var t=this.getData().geoObject.options;t.set("strokeColor",r.createRGBA(t.get("strokeColor"),(100-this._strokeOpacityInput.getVal())/100))},_onStrokeColorChange:function(){var t=this._strokeColorSelector.getVal();this.getData().geoObject.options.set("strokeColor",r.createRGBA(r.getColorById(t),(100-this._strokeOpacityInput.getVal())/100))},_onStrokeWidthChange:function(){this.getData().geoObject.options.set("strokeWidth",this._strokeWidthInput.getVal()||0)},_onGeoObjectStyleChange:function(){this._updateStyle(this.getData().geoObject.options)},_onGeoObjectPropertyChange:function(t){var e=this._balloonContentTextarea.getVal()!==(t.description||"");e&&this._updateProperties(this.getData().geoObject.properties)},_onRemoveButtonClick:function(){var t=this.getData().geoObject;t.getParent().remove(t)},_simplifyGeoObject:function(t){this.getData().geoObject.events.fire("mustSimplify"),t.preventDefault()},_closeBalloon:function(){this._balloonContentTextarea.validate(),this.getData().geoObject.balloon.close()}});t(_)}),modules.define("simplify-popup-layout",["i-bem-dom","bh","jquery","ymaps-api","i18n-plus","config","simplify-popup","button","popup-close-button"],function(t,e,i,o,n,s,r,a,c,l){var d=n.templateLayoutFactory.createClass("",{build:function(){d.superclass.build.call(this),this._bemContent=e.append(this.getElement(),i.apply({block:"simplify-popup"})).bem(a),this._closeButton=this._bemContent.findChildBlock(l),this._button=this._bemContent.findChildBlock(c),this._bemContent._domEvents(this._closeButton).on("click",this._onPopupButtonCloseClick.bind(this)),this._bemContent._domEvents(this._button).on("click",this._onButtonClick.bind(this));var t=this.getData().geoObject,n=t.getMap().container,u=t.getMap().converter.globalToPage(t.geometry.getPixelGeometry().getCoordinates()),h=this._bemContent.domElem[0].firstChild.getBoundingClientRect(),p=n.getOffset(),m=n.getSize(),g="";u[1]+h.height>p[1]+m[1]&&(g+="top"),u[0]+h.width>p[0]+m[0]&&(g+="left"),this._bemContent.setMod("side",g);var f,_=this._getGeoObject().geometry.getCoordinates();f=void 0===_[0][0][0]?_.length:_.reduce(function(t,e){return t+e.length-1},0),o(".simplify-popup__header",this._bemContent.domElem).text(s("popup","import_vlimit_header",{$thousands:["total","num"],$conjugate:f,num:f,total:r.limits.count.vertexes})),this._getGeoObject().balloon.close()},clear:function(){e.destruct(this._bemContent.domElem),d.superclass.clear.call(this)},_closePopup:function(){n.geometryEditor.Menu.mapAssociate.get(this.getData().geoObject.getMap()).hide(),this._getGeoObject().editor.options.set("menuLayout","islands#editorMenu")},_getGeoObject:function(){return this._dataProvider.get("editableGeoObject")},_onPopupButtonCloseClick:function(){this._closePopup()},_onButtonClick:function(){this._closePopup(),this._getGeoObject().events.fire("simplifyButtonClick")}});t(function(t){return d.prototype._dataProvider=t,d})}),modules.define("simplify-popup",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){}}}}))}),modules.define("polygon-controller",["ymaps-api","base-editor-controller","i18n-plus","polygon-balloon-layout","ymaps-preset-utils","util-inline-image","config","simplify-line","simplify-popup-layout","ymaps-utils"],function(t,e,i,o,n,s,r,a,c,l,d){var u=a.limits.count.vertexes,h=e.util.defineClass(function(t,e){h.superclass.constructor.call(this,t,e),this._collectionListener.add("dragstart",this._onGeoObjectDragStart,this).add("dragend",this._onGeoObjectDragEnd,this)},i,{getName:function(){return"polygon"},getButtonData:function(){return{data:{content:o("sidebar","polygon"),image:r.getImage("polygon"),title:o("sidebar","polygon_title")},options:{maxWidth:150,floatIndex:400}}},getBalloonContentLayout:function(){return n},getCollectionOptions:function(){return{balloonMaxWidth:9999,balloonMaxHeight:9999,editorMaxPoints:u,editorMenuManager:function(t){var e=this._getTotalVertex(this._lastEditingGeoObject);return u>e?t:(t.splice(1,0,{id:"simplifyLine",title:o("popup","simplify_poly"),onClick:function(){this.simplifyPolygon(this._lastEditingGeoObject,Math.floor(.99*u))}.bind(this)}),t)}.bind(this)}},getPresetOptionsList:function(){return["strokeColor","strokeWidth","fillColor"]},processStyle:function(t){var e=this._map.options,i={strokeColor:t.options.get("strokeColor",e.get("geoObjectStrokeColor")),strokeWidth:Number(t.options.get("strokeWidth",e.get("geoObjectStrokeWidth"))),fillColor:t.options.get("fillColor",e.get("geoObjectFillColor"))};t.options.set("preset",s.generatePresetByData(i))},createGeoObject:function(t,i){var o=this.getLastPreset(),n={};return o&&(n.preset=o),new e.Polygon([[t]],i||{},n)},afterMapClick:function(t){t.editor.startDrawing()},onGeoObjectAdd:function(t){var e=t.get("child");this._setEditorMaxPoints(e),e.events.add("simplifyButtonClick",this._simplifyButtonClickHandler,this).add("mustSimplify",this._simplifyButtonClickHandler,this),h.superclass.onGeoObjectAdd.call(this,t)},onGeoObjectRemove:function(t){h.superclass.onGeoObjectRemove.call(this,t),t.get("child").events.remove("simplifyButtonClick",this._simplifyButtonClickHandler,this)},_simplifyButtonClickHandler:function(t){this.simplifyPolygon(t.get("target"),Math.floor(.99*u))},onGeoObjectEditingChange:function(t,e){this._getViewCallback&&(this._getViewCallback.cancel(),this._getViewCallback=null),this._vertexListener&&(this._vertexListener.removeAll(),this._vertexListener=null),e&&(this._getViewCallback=d.createCanceableCallback(function(e){this._vertexListener=e.getVertexPlacemarks().events.group(),this._vertexListener.add("mouseup",function(i){this.onVertexMouseUp(t,i.get("target"),e)},this)},this),t.editor.getView().then(this._getViewCallback,this))},simplifyPolygon:function(t,e){var i=this._commonDataProvider.get("editableGeoObject");this.events.fire("simplifyStart",{text:o("popup","data_import_step4"),geoObjectId:i.properties.get("geoObjectId")});var n=t.geometry.getCoordinates();n=c(n,e),t.geometry.setCoordinates(n);var s=n.reduce(function(t,e){return t+e.length-1},0);this.events.fire("simplifyEnd",{type:"poly",geoObjectPoints:this._getGeoObjectPoints(i),geoObjectId:i.properties.get("geoObjectId"),count:s,total:u})},_getGeoObjectPoints:function(t){return t.geometry.getCoordinates().reduce(function(t,e){return e.forEach(function(e){t.push(e)}),t},[])},onGeoObjectGeometryChange:function(t){this._checkEmptiness(t)||(this._setEditorMaxPoints(t),h.superclass.onGeoObjectGeometryChange.call(this,t))},onVertexMouseUp:function(t){return this._lastEditingGeoObject=t,t.state.get("popupShown")||!this._checkLimit(t)?void t.options.unset("editorMenuLayout"):(t.options.set("editorMenuLayout",l(this._commonDataProvider)),void t.state.set("popupShown",!0))},_setEditorMaxPoints:function(t){var e=u+t.geometry.getCoordinates().length;t.options.set("editorMaxPoints",e)},_checkEmptiness:function(t){return 0===t.geometry.getCoordinates()[0].length?(this.removeGeoObject(t),!0):!1},_checkLimit:function(t){return this._getTotalVertex(t)>=u},_getTotalVertex:function(t){return t.geometry.getCoordinates().reduce(function(t,e){return t+e.length-1},0)},_onGeoObjectDragStart:function(t){var e=t.get("target");this.events.fire("geoObjectDragStart",{geoObjectId:e.properties.get("geoObjectId")})},_onGeoObjectDragEnd:function(t){var e=t.get("target");this.events.fire("geoObjectDragEnd",{geoObjectId:e.properties.get("geoObjectId")})}});t(h)}),modules.define("polygon-balloon-layout",["i-bem-dom","bh","jquery","ymaps-api","i18n-plus","ymaps-geoObject-colors","config","history-manager","balloon-setup","textarea","input","select","button"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p){var m=function(t,e,i,o,n,s){return{elem:t,tag:"label",content:[{elem:"label-text",content:e},{block:"input",mods:{theme:"islands",size:"m",type:"number",range:!0},mix:{block:"balloon-setup",elem:o},maxLength:i,min:n,max:s}]}},g=function(t,e){return{elem:"color-option",tag:"label",content:[{elem:"label-text",tag:"span",content:t},{block:"select",mix:{block:"balloon-setup",elem:e},mods:{mode:"radio",theme:"colors",size:"m"},name:"color",val:0,options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15].map(function(t){return{val:t,text:t}})}]}},f="MacOS"===a.uatraits.OSFamily?"Cmd + (← Backspace)":"(Delete)",_={block:"balloon-setup",content:[{elem:"limits",content:[{elem:"limits-text",content:"В объекте 1000 точек из 1000 возможных. "},{block:"link",url:"#",content:s("popup","simplify_poly"),mix:[{block:"balloon-setup",elem:"limits-simplify-link"}]},{block:"link",url:a.hosts.createHelp,title:s("popup","simplify_help_hint"),target:"_blank",mix:[{block:"balloon-setup",elem:"limits-help-link"}]}]},{elem:"description",tag:"label",content:[{elem:"description-label-text",content:s("balloon","balloon_content")},{block:"textarea",mods:{theme:"islands",size:"m",width:"available","fire-blur-change":!0},validate:{message:s("popup","limit_warning_desc"),conditionals:"length:"+a.limits.size.iconDescription},attrs:{rows:4},placeholder:s("balloon","balloon_content_example")}]},{elem:"poly-options",mix:{block:"balloon-setup",elem:"flex-grid"},content:[{elem:"flex-grid-col",content:[g(s("balloon","stroke"),"stroke-color"),g(s("balloon","fill"),"fill-color")],mix:{elem:"flex-grid-col-color"}},{elem:"flex-grid-col",content:[m("transparency-field",s("balloon","geoobject_opacity"),3,"stroke-opacity",0,100),m("transparency-field",s("balloon","geoobject_opacity"),3,"fill-opacity",0,100)]},{elem:"flex-grid-col",content:[m("width-field",s("balloon","stroke_width"),2,"stroke-width",0,99)]}]},{elem:"button-holder",content:[{block:"button",mods:{theme:"islands",size:"s",view:"action",id:"save-button"},text:s("balloon","save"),mix:{block:"balloon-setup",elem:"save-button"}},{block:"button",mods:{theme:"islands",size:"s",view:"pseudo",id:"remove-button"},title:s("balloon","remove")+" "+f,text:s("balloon","remove"),mix:{block:"balloon-setup",elem:"remove-button"}}]}]},b=n.templateLayoutFactory.createClass("",{build:function(){b.superclass.build.call(this),this._bemContent=e.append(this.getElement(),i.apply(_)).bem(l),this._bemContent.setMod("lang",a.lang),this._balloonContentTextarea=this._bemContent.findChildBlock(d);var t=this._bemContent.findChildBlocks(u),o=this._bemContent.findChildBlocks(h);this._strokeOpacityInput=t.get(0),this._strokeWidthInput=t.get(2),this._strokeColorSelector=o.get(0),this._fillOpacityInput=t.get(1),this._fillColorSelector=o.get(1),this._saveButton=this._bemContent.findChildBlocks({block:p,modName:"id",modVal:"save-button"}),this._removeButton=this._bemContent.findChildBlocks({block:p,modName:"id",modVal:"remove-button"});var s=this.getData().geoObject;this._updateStyle(s.options),this._updateProperties(s.properties),this._styleMonitor=new n.Monitor(s.options),this._propertiesMonitor=new n.Monitor(s.properties),this._styleMonitor.add(["strokeColor","strokeWidth","fillColor"],this._onGeoObjectStyleChange,this),this._propertiesMonitor.add("description",this._onGeoObjectPropertyChange,this),this._checkLimits(),s.events.add("geometrychange",this._checkLimits,this),this._simplifyLink=this._bemContent.findChildElem("limits-simplify-link"),this._bemContent._events(this._balloonContentTextarea).on("change",this._onBalloonContentChange,this).on("blurChange",this._onBalloonContentBlurChange,this),this._bemContent._events(this._strokeOpacityInput).on("change",this._onStrokeOpacityChange,this),this._bemContent._events(this._fillOpacityInput).on("change",this._onFillOpacityChange,this),this._bemContent._events(this._strokeWidthInput).on("change",this._onStrokeWidthChange,this),this._bemContent._events(this._strokeColorSelector).on("change",this._onStrokeColorChange,this),this._bemContent._events(this._fillColorSelector).on("change",this._onFillColorChange,this),this._bemContent._events(this._removeButton).on("click",this._onRemoveButtonClick,this),this._bemContent._events(this._saveButton).on("click",this._closeBalloon,this),this._bemContent._domEvents(this._simplifyLink).on("click",this._simplifyGeoObject.bind(this))},clear:function(){e.destruct(this._bemContent.domElem),b.superclass.clear.call(this)},isEmpty:function(){return!1},_updateStyle:function(t){var e=r.colorToColorAndOpacity(t.get("strokeColor")),i=r.getIndexByColor(e[0]);i>-1&&this._strokeColorSelector.setVal(i);var o=r.colorToColorAndOpacity(t.get("fillColor")),n=r.getIndexByColor(o[0]);n>-1&&this._fillColorSelector.setVal(n),this._strokeOpacityInput.getMod("focused")||this._strokeOpacityInput.setVal(Math.round(100-100*e[1])),this._strokeWidthInput.getMod("focused")||this._strokeWidthInput.setVal(t.get("strokeWidth")),this._fillOpacityInput.getMod("focused")||this._fillOpacityInput.setVal(Math.round(100-100*o[1]))},_updateProperties:function(t){this._balloonContentTextarea.setVal(t.get("description",""))},_checkLimits:function(){var t=this.getData().geoObject,e=t.geometry.getCoordinates().reduce(function(t,e){return t+e.length-1},0);e>=a.limits.count.vertexes?(this._bemContent.setMod("limits",!0),this._bemContent.findChildElem("limits-text").domElem.text(s("popup","import_vlimit_header",{$thousands:["total","num"],$conjugate:e,num:e,total:a.limits.count.vertexes})+". ")):this._bemContent.setMod("limits",!1),this.events.fire("change")},_onBalloonContentChange:function(){this.getData().geoObject.properties.set("description",this._balloonContentTextarea.getVal())},_onBalloonContentBlurChange:function(t,e){c.addGeoObjectPropertyState("description",this.getData().geoObject.properties.get("geoObjectId"),e.newVal,e.oldVal)},_onFillOpacityChange:function(){var t=this.getData().geoObject.options;t.set("fillColor",r.createRGBA(t.get("fillColor"),(100-this._fillOpacityInput.getVal())/100))},_onFillColorChange:function(){var t=this._fillColorSelector.getVal();this.getData().geoObject.options.set("fillColor",r.createRGBA(r.getColorById(t),(100-this._fillOpacityInput.getVal())/100))},_onStrokeOpacityChange:function(){var t=this.getData().geoObject.options;t.set("strokeColor",r.createRGBA(t.get("strokeColor"),(100-this._strokeOpacityInput.getVal())/100))},_onStrokeColorChange:function(){var t=this._strokeColorSelector.getVal();this.getData().geoObject.options.set("strokeColor",r.createRGBA(r.getColorById(t),(100-this._strokeOpacityInput.getVal())/100))},_onStrokeWidthChange:function(){this.getData().geoObject.options.set("strokeWidth",this._strokeWidthInput.getVal()||0)},_onGeoObjectStyleChange:function(){this._updateStyle(this.getData().geoObject.options)},_onGeoObjectPropertyChange:function(t){var e=this._balloonContentTextarea.getVal()!==(t.description||"");e&&this._updateProperties(this.getData().geoObject.properties)},_onRemoveButtonClick:function(){var t=this.getData().geoObject;t.getParent().remove(t)},_simplifyGeoObject:function(t){this.getData().geoObject.events.fire("mustSimplify"),t.preventDefault()},_closeBalloon:function(){this._balloonContentTextarea.validate(),this.getData().geoObject.balloon.close()}});t(b)}),modules.define("ymaps-selection-geoObject",["ymaps-utils","ymaps-api","map-data-default"],function(t,e,i,o){function n(t,n){var s=e.getBoundingRect(t),r="point"===t.geometry.getType().toLowerCase(),a=r?0:t.options.get("strokeWidth"),c=a?Math.round(a/2):0;if(!s)return null;var l=(r?1:2)+Math.round(o.outerSelectionStyle.strokeWidth/2);return s=[[s[0][0]-l-c,s[0][1]-l-c],[s[1][0]+l+c,s[1][1]+l+c]],i.util.bounds.fromGlobalPixelBounds(s,n.getZoom())}t({create:function(t,e){t.panes.get("selection")||t.panes.append("selection",new i.pane.StaticPane(t,{zIndex:499}));var s=n(e,t);if(!s)return null;if(t.action.getCurrentState().isTicking)return null;var r=new i.GeoObjectCollection;r.add(new i.Rectangle(s,{},o.outerSelectionStyle)).add(new i.Rectangle(s,{},o.innerSelectionStyle)),t.geoObjects.add(r);var a=t.events.group().add(["actionbegin","actiontick"],function(){t.geoObjects.indexOf(r)>-1&&t.geoObjects.remove(r)}).add("actionend",function(){if(-1===t.geoObjects.indexOf(r)){t.geoObjects.add(r);var i=n(e,t);r.get(0).geometry.setCoordinates(i),r.get(1).geometry.setCoordinates(i)}});return{destroy:function(){r&&(t.geoObjects.indexOf(r)>-1&&t.geoObjects.remove(r),r=null,a.removeAll(),a=null)}}}})}),modules.define("ymaps-traffic-button",["ymaps-api","util-inline-image","i18n-plus"],function(t,e,i,o){var n=["green","yellow","red"],s=e.util.defineClass(function(){s.superclass.constructor.call(this,{data:{content:o("sidebar","traffic"),image:i.getImage("traffic")},options:{maxWidth:150}}),this._stateMonitor=new e.Monitor(this.state),this._stateMonitor.add("selected",this._checkSelected,this)},e.control.Button,{setParent:function(){s.superclass.setParent.apply(this,arguments),this._checkSelected()},_checkSelected:function(){this.state.get("selected")&&this.getMap()?this._showTrafficLayer():this._hideTrafficLayer()},_hideTrafficLayer:function(){this._trafficLayer&&(this._trafficLayer.setMap(null),this._trafficLayer=null,this._stateMonitor.removeAll(),this._stateMonitor=null)},_showTrafficLayer:function(){this._trafficLayer||(this._trafficLayer=new e.traffic.provider.Actual,this._trafficLayer.setMap(this.getMap()),this._stateMonitor=new e.Monitor(this._trafficLayer.state),this._stateMonitor.add("level",this._applyLevel,this))},_applyLevel:function(t){var e="traffic";null!==t&&this.state.get("selected")&&this._trafficLayer.state.get("isInited")&&(e+="_"+n[Math.max(Math.ceil(t/3)-1,0)]),this.data.set("image",i.getImage(e)).set("content","124").set("content",o("sidebar","traffic"))}});t(s)}),modules.define("map-editor",["i-bem-dom","bh","jquery","config","resizer","ymaps-utils","interactive-script-preview-controller","interactive-iframe-preview-controller","static-preview-controller","print-preview-controller"],function(t,e,i,o,n,s,r,a,c,l,d,u){var h=["drag","dblClickZoom","scrollZoom","multiTouch"],p={interactiveScript:a,interactiveIframe:c,print:d,"static":l};t(e.declBlock(u,{onSetMod:{mapType:function(){this.createPreview()}},createPreview:function(){var t=this.getDataProvider();if(t)if("preview"===this.getMod("step")){this._destroyPreviewMap();var e=this._previewState,i=this._events(this._resizer);i.un("sizechange",this._onResize,this),this._resizer.setOptions({minSize:t.get("minContainerSize"),maxSize:t.get("maxContainerSize")}).setState(e),i.on("sizechange",this._onResize,this),this._createPreviewController(),this._createPreviewMap()}else this._createPreviewController()},applyStep:function(t,e){"preview"===t?(this._setupResizer(),this._createPreviewMap(),this._hideCopyrights()):"preview"===e&&(this._destroyPreviewMap(),this._teardownResizer(),this._showCopyrights()),this.__base.apply(this,arguments)},createEditorMap:function(){this.__base.apply(this,arguments),this._createPreviewController(!0),this._map.container.events.add("sizechange",this._onMapSizeChange,this)},destroyEditorMap:function(){this._destroyPreviewMap(),this._map&&this._map.container.events.remove("sizechange",this._onMapSizeChange,this),this.__base.apply(this,arguments)},setDataProvider:function(t){var e=this.__base.apply(this,arguments);return this._dataListener.add("containerSize",this._onContainerSizeChange,this).add("mapType",function(t){this.setMod("mapType",t)},this),this.setMod("mapType",t.get("mapType")),this._onContainerSizeChange(this._dataListener.get("containerSize")),e},clearDataProvider:function(){return this._dataListener&&this._dataListener.destroy(),this.__base.apply(this,arguments)},_onContainerSizeChange:function(t){if(this._resizer){this._events(this._resizer).un("sizechange",this._onResize,this);var e=this._getPreviewGlobalPixelCenter();this._previewState=o.extend(this._previewState,{size:t}),this._resizer.setState(this._previewState),this._resizer.recalculate(),this._events(this._resizer).on("sizechange",this._onResize,this),this._previewState=this._resizer.getState(),this._map.setGlobalPixelCenter(e),this._resizePreviewMap()}else{var i=this._map.container.getSize();this._previewState=o.extend(this._previewState,{size:t,offset:[(i[0]-t[0])/2,(i[1]-t[1])/2]})}return this.getDataProvider().set("centerClientOffset",[0,0]),this.__base.apply(this,arguments)},_setupResizer:function(){if(!this._resizer){this._resizer=e.append(this._elem("resizer-holder").domElem,i.apply({block:"resizer"})).bem(s);var t=this.getDataProvider();this._resizer.setOptions({minSize:t.get("minContainerSize"),maxSize:t.get("maxContainerSize"),holderSize:this._map.container.getSize()}).setState(this._previewState),this._events(this._resizer).on("sizechange",this._onResize,this),this._previewState.firstRun&&(delete this._previewState.firstRun,this._resizer.recalculate())}},_teardownResizer:function(){this._resizer&&(this._events(this._resizer).un("sizechange",this._onResize,this),e.destruct(this._resizer.domElem),this._resizer=null)},_onResize:function(t,e){this._dataListener.remove("containerSize",this._onContainerSizeChange,this),this._previewState=e,this._resizePreviewMap();var i=this._map.container.getSize(),o=this._previewState.size,n=["available"===o[0],"available"===o[1]],s=[0,0];n[0]||(s[0]=e.offset[0]+o[0]/2-i[0]/2,o[0]=Math.round(o[0])),n[1]||(s[1]=e.offset[1]+o[1]/2-i[1]/2,o[1]=Math.round(o[1])),this.getDataProvider().set("centerClientOffset",s).set("containerSize",o),this._dataListener.add("containerSize",this._onContainerSizeChange,this)},_onMapSizeChange:function(t){if("preview"===this.getMod("step")){var e=this._getPreviewGlobalPixelCenter(t.get("oldSize"));this._events(this._resizer).un("sizechange",this._onResize,this),this._resizer.setOptions({holderSize:this._map.container.getSize()}),this._previewState=this._resizer.getState(),this._map.setGlobalPixelCenter(e),this._destroyPreviewMap(),this._createPreviewMap(),this._events(this._resizer).on("sizechange",this._onResize,this),this.getDataProvider().set("centerClientOffset",[0,0]).set("containerSize",this._previewState.size)}},_showCopyrights:function(){this._map.panes.get("copyrights").getElement().style.visibility="visible"},_hideCopyrights:function(){this._map.panes.get("copyrights").getElement().style.visibility="hidden"},_createPreviewController:function(t){var e=this.getMod("mapType");this._previewController=new p[e](this,this._map),(!this._previewState||t)&&(this._previewState={size:this.getDataProvider().get("containerSize"),firstRun:!0})},_createPreviewMap:function(){if(!this._previewController.isMapCreated()){var t=this._elem("preview-holder").domElem.get(0);t.style.display="block",this._map.behaviors.disable(h),this._createPreviewCallback=r.createCanceableCallback(function(){this._map.behaviors.enable(h),this._createPreviewCallback=null},this),this._previewController.createMap(t,this._previewState).then(this._createPreviewCallback,this)}},_destroyPreviewMap:function(){if(this._previewController&&this._previewController.isMapCreated()){this._createPreviewCallback&&(this._createPreviewCallback.cancel(),this._createPreviewCallback=null,this._map.behaviors.enable(h));var t=this._elem("preview-holder").domElem.get(0);this._previewController.destroyMap(),t.style.display="none"}},_resizePreviewMap:function(){this._previewController.resize(this._previewState)},_getPreviewGlobalPixelCenter:function(t){t||(t=this._map.container.getSize());var e=this._previewState.size.concat(),i=["available"===e[0],"available"===e[1]],o=[i[0]?0:this._previewState.offset[0],i[1]?0:this._previewState.offset[1]],n=[i[0]?t[0]:this._previewState.size[0],i[1]?t[1]:this._previewState.size[1]],s=this._map.action.getCurrentState().globalPixelCenter;return[s[0]-t[0]/2+o[0]+n[0]/2,s[1]-t[1]/2+o[1]+n[1]/2]}}))}),modules.define("resizer",["i-bem-dom","ymaps-api","jquery"],function(t,e,i,o){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._minSize=[0,0],this._maxSize=[1/0,1/0],this._size=[300,300],this._offset=[0,0],this._holderSize=[300,300],this._mouseDownHandler=this._onMouseDown.bind(this),this._sliderListeners=[],this._elems("slider").forEach(function(t){this._sliderListeners.push(i.domEvent.manager.group(t.domElem.get(0)).add("mousedown",this._mouseDownHandler))},this)},"":function(){this._sliderListeners.forEach(function(t){t.removeAll()}),this._sliderListeners=null,this._mouseDownHandler=null,this._destroyDragger()}}},setOptions:function(t){var e=!1;return t.hasOwnProperty("minSize")&&(e=!0,this._minSize=t.minSize),t.hasOwnProperty("maxSize")&&(e=!0,this._maxSize=t.maxSize),t.hasOwnProperty("holderSize")&&(e=!0,this._holderSize=t.holderSize,this._elem("filler").domElem.css({width:this._holderSize[0],height:this._holderSize[1]})),e&&(this._recalculate(),this._redraw()),this},setState:function(t){var e=!1;return t.hasOwnProperty("size")&&(e=!0,this._size=t.size.concat()),t.hasOwnProperty("offset")&&(e=!0,this._offset=t.offset.concat()),e&&(this._fixSize(),this._redraw(),this._fireSizeChange()),this},getOptions:function(){return{minSize:this._minSize.concat(),maxSize:this._maxSize.concat(),holderSize:this._holderSize.concat()}},getState:function(){return{size:this._size.concat(),offset:this._offset.concat()}},recalculate:function(){return this._recalculate(),this._redraw(),this},_onMouseDown:function(t){this._dragDirection=o(t.get("target")).data("position"),this._destroyDragger(),this._createDragger(t.originalEvent),t.originalEvent.preventDefault()},_createDragger:function(t){this._dragger||(this._dragger=new i.util.Dragger,this._dragger.events.add("start",this._onDragStart,this).add("move",this._onDragMove,this).add("stop",this._onDragStop,this),this._dragger.start(new i.DomEvent(t)))},_destroyDragger:function(){this._dragger&&(this._dragger.events.remove("start",this._onDragStart,this).remove("move",this._onDragMove,this).remove("stop",this._onDragStop,this),this._dragger.stop(),this._dragger=null)},_onDragStart:function(t){this._startPosition=t.get("position"),this._startOffset=this._offset.slice(),this._startSize=this._size.slice()},_onDragMove:function(t){var e=this._size.concat(),o=t.get("position"),n=[o[0]-this._startPosition[0],o[1]-this._startPosition[1]],s=["available"===this._size[0],"available"===this._size[1]];s[0]||(this._dragDirection.indexOf("left")>-1?(this._size[0]=this._startSize[0]-n[0],this._offset[0]=this._startOffset[0]+n[0]):this._dragDirection.indexOf("right")>-1&&(this._size[0]=this._startSize[0]+n[0])),s[1]||(this._dragDirection.indexOf("top")>-1?(this._size[1]=this._startSize[1]-n[1],this._offset[1]=this._startOffset[1]+n[1]):this._dragDirection.indexOf("bottom")>-1&&(this._size[1]=this._startSize[1]+n[1]));var r=this._minSize;r&&(s[0]||this._size[0]<r[0]&&(this._size[0]=r[0],this._dragDirection.indexOf("left")>-1&&(this._offset[0]=this._startOffset[0]+this._startSize[0]-r[0])),s[1]||this._size[1]<r[1]&&(this._size[1]=r[1],this._dragDirection.indexOf("top")>-1&&(this._offset[1]=this._startOffset[1]+this._startSize[1]-r[1])));var a=this._maxSize;a&&(s[0]||this._size[0]>a[0]&&(this._size[0]=a[0],this._dragDirection.indexOf("left")>-1&&(this._offset[0]=this._startOffset[0]+this._startSize[0]-a[0])),s[1]||this._size[1]>a[1]&&(this._size[1]=a[1],this._dragDirection.indexOf("top")>-1&&(this._offset[1]=this._startOffset[1]+this._startSize[1]-a[1]))),i.util.math.areEqual(e,this._size)||(this._redraw(),this._fireSizeChange())},_onDragStop:function(){this._destroyDragger()},_recalculate:function(){this._fixSize(),this._offset=["available"===this._size[0]?0:(this._holderSize[0]-this._size[0])/2,"available"===this._size[1]?0:(this._holderSize[1]-this._size[1])/2],this._fireSizeChange()},_fixSize:function(){"available"!==this._size[0]&&(this._size[0]=Math.max(this._minSize[0],Math.min(this._maxSize[0],this._size[0]))),"available"!==this._size[1]&&(this._size[1]=Math.max(this._minSize[1],Math.min(this._maxSize[1],this._size[1])))},_redraw:function(){var t=["available"===this._size[0],"available"===this._size[1]],e=[t[0]?this._holderSize[0]:this._size[0],t[1]?this._holderSize[1]:this._size[1]],i=[t[0]?0:this._offset[0],t[1]?0:this._offset[1]],o=[[0,0,this._holderSize[0],i[1]],[i[1]+e[1],0,this._holderSize[0],this._holderSize[1]-(e[1]+i[1])],[i[1],0,i[0],e[1]],[i[1],i[0]+e[0],this._holderSize[0]-(i[0]+e[0]),e[1]]],n=this._elems("blackout");o.forEach(function(t,e){n.get(e).domElem.css({top:t[0],left:t[1],width:t[2],height:t[3]})},this);var s=[[i[0],i[1]],[i[0]+e[0]/2,i[1]],[i[0]+e[0],i[1]],[i[0],i[1]+e[1]/2],[i[0]+e[0],i[1]+e[1]/2],[i[0],i[1]+e[1]],[i[0]+e[0]/2,i[1]+e[1]],[i[0]+e[0],i[1]+e[1]]],r=this._elems("slider");s.forEach(function(e,i){var o=r.get(i),n=o.domElem.attr("class"),s=n.indexOf("left")>-1||n.indexOf("right")>-1,a=n.indexOf("top")>-1||n.indexOf("bottom")>-1;o.domElem.css({left:e[0],top:e[1],display:s&&t[0]||a&&t[1]?"none":"block"})},this)},_fireSizeChange:function(){this._emit("sizechange",this.getState())}}))}),modules.define("interactive-script-preview-controller",["base-interactive-preview-controller","ymaps-api"],function(t,e,i){var o=i.util.defineClass(function(t,e){o.superclass.constructor.call(this,t,e)},e,{getMapInitData:function(t){var e=o.superclass.getMapInitData.call(this,t);return e.mapState.controls=["fullscreenControl","rulerControl","routeEditor","searchControl","trafficControl","typeSelector","zoomControl","geolocationControl"],e},createMap:function(t,e){var i=o.superclass.createMap.call(this,t,e);return this._disablePreviewControls(),this._previewMap.controls.get("searchControl").options.set("provider","yandex#search"),i},_disablePreviewControls:function(){var t=this._previewMap.panes.get("controls").getElement();t.style["pointer-events"]="none",t.style.opacity="0.7"}});t(o)}),modules.define("base-interactive-preview-controller",["base-preview-controller","jquery","ymaps-api","ymaps-utils","ymaps-map-factory","ymaps-geoObject-colors","config","ymaps-maps-synchronizer","map-data-default"],function(t,e,i,o,n,s,r,a,c,l){var d=o.util.defineClass(function(t,e){d.superclass.constructor.call(this,t,e)},e,{createMap:function(t,e){var i=d.superclass.createMap.call(this,t,e);return this._previewMap=s(this.getMapInitData(e)),this._enableMapsSync(),this._applyContainerSize(e),this._previewMap.container.fitToViewport(),this._previewMap.container.getElement().addEventListener("click",function(t){return"A"===t.target.tagName?(window.open(t.target.href),t.preventDefault(),t.stopPropagation(),!1):void 0},!0),i},destroyMap:function(){var t=d.superclass.destroyMap.call(this);return this._disableMapsSync(),this._previewMap.destroy(),this._previewMap=null,this._applyContainerSize({size:[0,0],offset:[0,0]}),t},onResize:function(t){d.superclass.onResize.call(this,t),this._disableMapsSync(),this._applyContainerSize(t),this._previewMap&&(this._previewMap.balloon.close(),this._previewMap.container.fitToViewport(!0),this._previewMap.container.getOffset()),this._enableMapsSync()},getMapInitData:function(t){var e=this.getMap(),i=e.action.getCurrentState().globalPixelCenter.concat(),n=e.getZoom(),s=e.container.getSize(),r=t.offset.concat(),a=t.size.concat(),c=this.getMapEditor().getDataProvider(),d=["available"===a[0],"available"===a[1]];d[0]&&(r[0]=0,a[0]=s[0]),d[1]&&(r[1]=0,a[1]=s[1]),i=[i[0]-s[0]/2+r[0]+a[0]/2,i[1]-s[1]/2+r[1]+a[1]/2];var u=c.get("geoObjects"),h=[].concat(u.getByType("polygon"),u.getByType("linestring"),u.getByType("point"));return{container:this.getContainer(),mapState:{center:e.options.get("projection").fromGlobalPixels(i,n),zoom:n,type:e.getType(),controls:[]},mapOptions:o.util.extend({geoObjectBalloonAutoPan:!1},l.defaultMapOptions),geoObjectsData:h,traffic:{shown:c.get("trafficShown")}}},_applyContainerSize:function(t){var e=["available"===t.size[0],"available"===t.size[1]];i(this.getContainer()).css({left:e[0]?0:Math.floor(t.offset[0]),top:e[1]?0:Math.floor(t.offset[1]),width:e[0]?"100%":Math.floor(t.size[0]),height:e[1]?"100%":Math.floor(t.size[1])})},_enableMapsSync:function(){this.getMap()&&this._previewMap&&c.enable(this.getMap(),this._previewMap)
},_disableMapsSync:function(){this.getMap()&&this._previewMap&&c.disable(this.getMap(),this._previewMap)}});t(d)}),modules.define("base-preview-controller",["vow"],function(t,e){var i=function(t,e){this._mapEditor=t,this._map=e,this._isMapCreated=!1};i.prototype.createMap=function(t){var i=e.defer();return this._container=t,this._isMapCreated=!0,i.resolve(!0),i.promise()},i.prototype.destroyMap=function(){var t=e.defer();return t.resolve(!0),this._isMapCreated=!1,t.promise()},i.prototype.isMapCreated=function(){return this._isMapCreated},i.prototype.resize=function(t){this.getContainer()&&this.onResize(t)},i.prototype.onResize=function(){return this},i.prototype.getMap=function(){return this._map},i.prototype.getMapEditor=function(){return this._mapEditor},i.prototype.getContainer=function(){return this._container},t(i)}),modules.define("ymaps-map-factory",["ymaps-api"],function(t,e){t(function(t){function i(t){var e=(t[0]>t[1]?t[0]:t[1])*r,i=Math.pow(t[0]>t[1]?t[0]:t[1],2),o=Math.max(a,i*c/v);b.style.bottom=Math.round(e-Math.ceil(o/n*s))+"px",b.style.right=Math.round(e)+"px",b.style.height=Math.round(o)+"px",b.style.width=Math.round(o/n*v)+"px"}var o=218,n=96,s=9,r=.02,a=24,c=.0045,l="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjE4IiBoZWlnaHQ9Ijk2IiB2aWV3Qm94PSIwIDAgMjE3LjkgOTYuMiI+PGcgaWQ9IlhNTElEXzIxOV8iPjxwYXRoIGlkPSJYTUxJRF8yMzhfIiBmaWxsPSIjRkZGRkZGIiBkPSJNMjE3LjcgNzQuMWwtLjctMy4yLS4xLS4zLS4xLS4zYy0xLjItMy42LTQuMy01LjktOC4xLTUuOS0xLjIgMC0yLjEuMi0yLjkuNS0uOS4yLTIuMi42LTMuOC42LS41IDAtLjYgMC0xLjEtLjgtLjUtLjgtMS42LTMuNC0xLjYtOS4xIDAtNC4xLjYtNy4zIDEuMy05LjUgMS44IDEuMSAzLjUgMS40IDQuOCAxLjQgMy4xIDAgNS45LTEuNiA3LjctNC41bDIuNS00LjFjMS0xLjYgMS41LTMuMyAxLjUtNS4xIDAtMS42LS41LTUuNy01LjMtOC4xLTQuNC0yLjItOC4yLTMuMi0xMi40LTMuMi00LjcgMC05IDEuNy0xMi42IDQuNy0xLjYtMi4yLTQuMS0zLjUtNi44LTMuNWgtNS42Yy0yLjIgMC00LjkuNS03LjEgMi41LTEuNS0xLjYtMy43LTIuNS02LjEtMi41SDE1NWMtMy4zIDAtNi4yIDEuOS03LjYgNC44LTMuOC00LjEtOC42LTUuOS0xMy4zLTUuOS01LjkgMC0xMC44IDIuNS0xNC42IDctMS4xLTMuNC00LjMtNS44LTguMS01LjhIOTIuNWMtMy43IDAtNi44IDIuMi04LjEgNS40LTEuMy0zLjItNC40LTUuNC04LTUuNGgtNS45Yy0yLjQgMC00LjYgMS02LjEgMi41LTEuNi0xLjUtMy43LTIuNS02LjEtMi41aC01LjljLS45IDAtMS43LjEtMi41LjNWOC45YzAtNS00LTguOS05LTguOUgzMC4xQzEzLjkgMCAyLjYgMTMgMi42IDMxLjdjMCA5LjIgMy40IDE3IDkuNSAyMi4zTDEuMiA3My42Yy0xLjYgMi45LTEuNiA2LjMgMCA5UzUuOCA4NyA4LjkgODdoNi43YzMuNyAwIDYuOC0yIDguMy01LjJsMi42LTUuMXYxLjdjMCA0LjggMy45IDguNyA4LjcgOC43aDUuOWMyLjIgMCA0LjEtLjcgNS42LTIgMS41IDEuMiAzLjQgMiA1LjUgMmg1LjljMi40IDAgNC41LS45IDYuMS0yLjVDNjUuOSA4NiA2OCA4NyA3MC41IDg3aDMuN3YuNmMwIDQuOCAzLjkgOC43IDguNyA4LjdoNC41YzUuMiAwIDkuMy00LjEgOS40LTkuM2g0LjJ2LjZjMCA0LjggMy45IDguNyA4LjcgOC43aDQuOGM1LjEgMCA5LjEtNC4xIDkuMS05LjR2LTJjMy4zIDIuMSA3LjMgMy4zIDExLjYgMy4zIDYuMyAwIDExLjMtMi4zIDEzLjgtMy42IDEuNSAxLjUgMy43IDIuNSA2IDIuNWg2LjFjMi43IDAgNS4xLTEuMiA2LjctMy4yIDEuNiAxLjcgNC4xIDMuMiA3LjkgMy4yaDZjMi4yIDAgNC4zLS45IDUuOC0yLjMgMy41IDIuMyA3LjYgMy41IDEyIDMuNSA1LjYgMCAxMS41LTIuNCAxNC42LTQuN2guMmMyLjktMi40IDQuMi02IDMuNC05LjV6Ii8+PC9nPjxnIGlkPSJYTUxJRF8yMV8iPjxnIGlkPSJYTUxJRF8yNDNfIj48ZyBpZD0iWE1MSURfMjY0XyI+PHBhdGggaWQ9IlhNTElEXzIwXyIgZD0iTTc2LjMgMzEuNWgtNS45Yy0uNSAwLS44LjQtLjguN3YxOC4xSDU4LjlWMzIuMmMwLS41LS4yLS43LS43LS43aC01LjljLS41IDAtLjguMy0uOC43djQ2YzAgLjUuMi44LjcuOGg1LjljLjQgMCAuNy0uMy43LS44di0yMmgxMC45djIyYzAgLjUuMy44LjguOGg1LjljLjUgMCAuNy0uNC43LS44di00NmMtLjEtLjQtLjQtLjctLjgtLjd6Ii8+PC9nPjxnIGlkPSJYTUxJRF8yNjFfIj48cGF0aCBpZD0iWE1MSURfMThfIiBkPSJNMjA5LjkgNzUuOWwtLjgtMy4yYy0uMS0uMy0uMi0uNC0uNS0uNC0uNSAwLTMgMS02LjcgMS03LjIgMC0xMC43LTYuOS0xMC43LTE3LjkgMC05LjcgMi45LTE5LjIgNy44LTE5LjIgMS4zIDAgMi45LjQgNS41IDIuNy4zLjMuNS40LjguNC4zIDAgLjYtLjIuOS0uN2wyLjUtNC4yYy4yLS4zLjMtLjYuMy0uOSAwLS40LS40LS43LS45LS45LTMuOS0yLTYuNS0yLjQtOC44LTIuNC04LjkgMC0xNS44IDEwLjYtMTUuOCAyNy4yIDAgMTQuMyA2LjYgMjIuNSAxNiAyMi41IDQgMCA4LjItMS45IDkuOS0zLjEuNS0uMS42LS41LjUtLjl6Ii8+PC9nPjxnIGlkPSJYTUxJRF8yNThfIj48cGF0aCBpZD0iWE1MSURfMTRfIiBkPSJNMTY4LjkgNTIuOWwxMS4zLTIwLjdjLjItLjMuMS0uNy0uMy0uN2gtNS42Yy0xLjYgMC0yLjIuNi0yLjcgMS44TDE2My4xIDUxYy0uNSAxLS45IDEuNy0xLjQgMlYzMi4yYzAtLjQtLjItLjctLjYtLjdIMTU1Yy0uMyAwLS42LjMtLjYuN3Y0Ni4xYzAgLjMuMi43LjYuN2g2LjFjLjQgMCAuNi0uMy42LS43VjU0LjVjLjMuMi41LjUuNy45bDEwLjggMjIuMWMuNiAxLjEgMS40IDEuNCAyLjYgMS40aDZjLjQgMCAuNS0uNC4zLS43bC0xMy4yLTI1LjN6Ii8+PC9nPjxnIGlkPSJYTUxJRF8yNTFfIj48cGF0aCBpZD0iWE1MSURfMzFfIiBkPSJNMTE0LjggNzNoLTEuMWMtMS40IDAtMS44LS42LTEuOC0xLjdWMzIuMmMwLS41LS4yLS43LS42LS43SDkyLjVjLS41IDAtLjguMy0uOC43djMuNGMwIDExLjUtLjcgMjYuMi02LjcgMzcuNGgtMi4xYy0uNiAwLS44LjMtLjguOHYxMy44YzAgLjUuNC43LjcuN2g0LjVjMSAwIDEuNC0uOCAxLjQtMS40Vjc5SDEwOXY4LjZjMCAuNC4zLjcuNy43aDQuOGMuNiAwIDEuMS0uNSAxLjEtMS40VjczLjhjMC0uNS0uMy0uOC0uOC0uOHptLTEwLjIgMEg5MC45YzQuOC04LjIgNi43LTE3LjUgNy40LTI4LjkuMi0yLjUuMy01IC4zLTYuNmg2VjczeiIvPjwvZz48ZyBpZD0iWE1MSURfMjQ0XyI+PHBhdGggaWQ9IlhNTElEXzI3XyIgZD0iTTEzNC4xIDMwLjRjLTEwLjIgMC0xNC43IDEyLjktMTQuNyAyNi45IDAgMTQuMyA2LjQgMjIuOCAxNS45IDIyLjggNC42IDAgOC43LTEuOCAxMC44LTMuMS40LS4yLjUtLjUuNC0uOGwtLjgtMy4yYy0uMS0uNC0uMy0uNi0uOC0uNi0uNCAwLTMuMSAxLTcgMS03LjMgMC0xMC43LTYuMy0xMC43LTE0Ljd2LTIuMnMzLjcuNCA1LjkuNGgxMy44di00Yy0uMS0xNC42LTUuMy0yMi41LTEyLjgtMjIuNXpNMTMzIDUwLjljLTIuMiAwLTUuNi40LTUuNi40czAtMS40LjItMi45Yy44LTggMi44LTEyLjEgNi4xLTEyLjEgMyAwIDQuOSA0LjIgNS40IDExLjUuMSAxLjUuMSAzLjIuMSAzLjJIMTMzeiIvPjwvZz48L2c+PHBhdGggaWQ9IlhNTElEXzI4NV8iIGZpbGw9IiNGRjAwMDAiIGQ9Ik00MC44IDhIMzAuMWMtMTAuNiAwLTE5LjUgOC0xOS41IDIzLjcgMCA5LjQgNC4zIDE2LjMgMTIuMSAxOS43TDguMiA3Ny41Yy0uNS45IDAgMS41LjggMS41aDYuN2MuNiAwIC45LS4yIDEuMS0uN2wxMy4xLTI1LjdoNC43djI1LjdjMCAuMy4zLjcuNy43aDUuOWMuNiAwIC44LS4zLjgtLjhWOC45Yy0uMS0uNi0uNS0uOS0xLjItLjl6bS02LjIgMzguNmgtNGMtNi4yIDAtMTIuMy00LjUtMTIuMy0xNS45QzE4LjMgMTguOSAyNCAxNCAyOS43IDE0aDQuOHYzMi42eiIvPjwvZz48L3N2Zz4=",d="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjE2LjYiIGhlaWdodD0iOTUiIHZpZXdCb3g9IjAgMCAyMTYuNiA5NSI+PHBhdGggaWQ9IlhNTElEXzE2N18iIGZpbGw9IiNGRkZGRkYiIGQ9Ik0yMTIuOCA3NC42Yy0xLjYtMy44LTMuNi04LjYtNS41LTEzIDguNC0xOC42IDguNi0xOSA4LjctMTkuNCAxLTIuOC42LTUuOC0xLTguMXMtNC4zLTMuNi03LjItMy42aC01LjJjLTIuOCAwLTUuMyAxLjItNyAzLjMtMi40LTMtNS44LTMuMy03LTMuM2gtNS43Yy0yLjcgMC01LjIgMS4yLTYuOSAzLjQtMy41LTMtNy42LTQuMy0xMS43LTQuMy01LjMgMC0xMCAyLjEtMTMuOCA2LjJWMTUuNmMwLTQuOS0zLjgtOC43LTguNy04LjdIMTM2Yy00LjkgMC04LjggMy44LTguOCA4Ljd2MTMuOWMtNS42LjUtMTEuMSAzLjItMTUuMiA4LjgtMi44LTUuMi04LjUtOC40LTE1LjctOC40LTIuNCAwLTQuNy41LTYuNyAxLjItMS0uNC0yLjEtLjYtMy4zLS42aC01LjljLTMuNSAwLTYuNSAyLTcuOSA0LjktMy42LTMuOS04LjYtNi0xNC40LTYtMiAwLTQuNS40LTcgMSAxLjgtNC44IDMuNy0xMC4yIDUuOS0xNiAuNi0xLjUuOS0yLjQuOS0yLjUgMS0yLjkuNi01LjgtMS04LjJDNTUuMiAxLjMgNTIuNiAwIDQ5LjYgMEg0M2MtNC4yIDAtNy43IDIuNy04LjggNi42LS4zIDEtMi4xIDYuNC0zLjggMTEuNi0uOCAyLjUtMS42IDQuOS0yLjMgNy4xLTEuNy00LjgtMy43LTEwLjUtNC4xLTExLjVDMjIuOCA5LjYgMTkuMyA3IDE1LjEgN0g4LjhjLTMgMC01LjggMS41LTcuNSA0LjEtMS42IDIuNS0xLjggNS40LS43IDguMS4yLjUgMS4xIDMgMi4yIDUuOCAzLjYgOS40IDEwLjEgMjYuNiAxMy43IDM1Ljd2MjQuNGMwIDQuOSAzLjggOC44IDguNyA4LjhoNi4xYzQuNiAwIDguMi0zLjQgOC42LTcuOSAzLjYgNS42IDkuMiA5LjEgMTUuNiA5LjEgMi43IDAgNS4zLS42IDcuOC0xLjggMSAuNCAyLjEuNiAzLjMuNkg3MGMyIDAgMy44LS42IDUuMi0xLjcgMS40IDEuMSAzLjIgMS43IDUuMiAxLjdoNmMyLjcgMCA1LTEuMiA2LjYtMyAxLjYgMS45IDQgMyA2LjcgM2g1LjljMy42IDAgNi42LTIuMSA3LjktNS4yIDMuOSA0LjEgOSA2LjQgMTQuNiA2LjQgMi42IDAgNS4xLS42IDcuNi0xLjcuOS4zIDEuOS41IDMgLjVoMy40YzMuOCAwIDYuOS0yLjMgOC4xLTUuNiA0LjEgNC4zIDkuNSA2LjYgMTUuNSA2LjYgNC42IDAgOC43LTEuNCAxMS42LTIuNyAxLjUgMSAzLjIgMS42IDUuMSAxLjZoNWMyLjUgMCA1LjYtMS4xIDcuNi0zLjkgMiAyLjggNC45IDMuOSA3LjQgMy45aDUuN2MzIDAgNS43LTEuNSA3LjMtNCAxLjYtMi42IDEuOC01LjguNS04LjYtLjYtLjYtMS45LTMuNi0zLjEtNi42eiIvPjxnIGlkPSJYTUxJRF8xMjRfIj48cGF0aCBpZD0iWE1MSURfMzI1XyIgZmlsbD0iI0ZGMDAwMCIgZD0iTTQ5LjYgOEg0M2MtLjYgMC0uOS4zLTEgLjctLjEuNC05LjkgMzAuMy0xMC42IDMyLjgtLjUgMS44LTIuMiA4LTIuNSA5LjVsLTMuNC05LjNjLS44LTIuNi04LjgtMjQuNy05LTI1LjYtLjEtLjUtLjQtMS4xLTEuMi0xLjFIOC44Yy0uNiAwLTEgLjctLjggMS4xLjIuMyAxMS44IDMxLjIgMTYuNSA0M3YyNmMwIC41LjIuOC43LjhoNi4xYy40IDAgLjctLjMuNy0uOFY1OS40YzMuOS0xMSAxOC4xLTQ5LjkgMTguMy01MC4zLjItLjUuMS0xLjEtLjctMS4xeiIvPjxnIGlkPSJYTUxJRF8xODdfIj48cGF0aCBpZD0iWE1MSURfNDRfIiBkPSJNOTYuMyAzNy45Yy00LjYgMC05LjQgMy40LTkuNCAzLjR2LTIuMmMwLS41LS4yLS43LS43LS43aC01LjljLS41IDAtLjguMy0uOC43Vjg1YzAgLjUuMi44LjcuOGg2Yy40IDAgLjctLjMuNy0uOFY0NS44Uzg5LjcgNDQgOTMgNDRjMy4yIDAgNS43IDEuNiA1LjcgNC44Vjg1YzAgLjUuMy44LjguOGg1LjljLjUgMCAuNy0uNC43LS44VjQ2LjhjLS4xLTUuOC0zLjYtOC45LTkuOC04Ljl6Ii8+PC9nPjxnIGlkPSJYTUxJRF8xNzFfIj48cGF0aCBpZD0iWE1MSURfNjRfIiBkPSJNMTQxLjggMTQuOUgxMzZjLS41IDAtLjguMy0uOC43djIzLjJjLTIuMi0uOS00LjMtMS4zLTYtMS4zLTkuNSAwLTE2IDkuMS0xNiAyNi42IDAgMTUgNi40IDIzIDE0LjYgMjMgMy41IDAgNi40LTIgOC41LTMuOWwxLjMgMi4yYy4yLjQuNC41LjguNWgzLjRjLjQgMCAuNy0uMy43LS44VjE1LjZjMC0uNS0uMi0uNy0uNy0uN3ptLTYuNiA2NC40Yy0xLjQuOC0zLjMgMS41LTUuMiAxLjUtNi4zIDAtOS03LjQtOS0xOC40IDAtOS42IDIuOC0xOS4yIDguNi0xOS4yIDEuOSAwIDMuOC42IDUuNyAyLjF2MzR6Ii8+PC9nPjxnIGlkPSJYTUxJRF8xNjBfIj48cGF0aCBpZD0iWE1MSURfNjBfIiBkPSJNMTYzLjIgNjMuOGgxMy42di0zLjljMC0xNC41LTUuMS0yMi4zLTEyLjYtMjIuMy05LjggMC0xNC42IDEyLjgtMTQuNiAyNi43IDAgMTQuNSA2LjkgMjIuNyAxNS43IDIyLjcgMy45IDAgNy43LTEuNSAxMC4zLTIuOS40LS4yLjUtLjUuNC0uOWwtLjctMy4xYy0uMS0uNC0uMy0uNi0uNy0uNi0uMiAwLTMuNC45LTYuNS45LTcuMiAwLTEwLjUtNi40LTEwLjUtMTV2LTIuMWMtLjEgMCAzLjUuNSA1LjYuNXptLTUuMi04LjVjLjgtOCAyLjctMTIgNi0xMiAyLjkgMCA0LjggNC4xIDUuMyAxMS40LjEgMS41LjEgMy4yLjEgMy4yaC01LjZjLTIuMiAwLTYuMS41LTYuMS41cy4xLTEuNi4zLTMuMXoiLz48L2c+PGcgaWQ9IlhNTElEXzEzM18iPjxwYXRoIGlkPSJYTUxJRF81Nl8iIGQ9Ik02OC41IDQzLjVjLTIuMi00LjMtNi02LjEtMTAuNC02LjEtMi44IDAtNy4zIDEuMS0xMC4yIDIuNC0uNi4zLS45LjUtLjkuOSAwIC4zLjEuNi4zLjlsMiA0LjNjLjIuNS41LjYuOC42LjMgMCAuNS0uMS44LS4zIDIuOS0xLjggNS0yLjkgNi43LTIuOSAyLjIgMCAzLjcgMS41IDQuNiAzLjcuOSAyLjEgMS4yIDQuOSAxLjIgOC4ydjFjLTEuOC0xLjEtNS0xLjgtNi41LTEuOC04LjUgMC0xMyA4LTEzIDE2LjYtLjIgOS4yIDUuMSAxNiAxMS42IDE2IDMuNiAwIDYuOC0yLjEgOS00LjcgMCAwIDEuMiAyLjcgMS4zIDMuMS4yLjMuMy41LjcuNWgzLjRjLjQgMCAuNy0uMy43LS44VjU4LjRjMC02LjUtLjQtMTEuNS0yLjEtMTQuOXptLTUuMiAzNC45Yy0xLjcgMS42LTMuNyAyLjUtNS41IDIuNXMtMy4yLS44LTQuMy0yLjRjLTEuNC0xLjktMi00LjgtMi04IDAtNS4xIDEuOS0xMC4zIDUuOS0xMC4zIDIgMCA0LjEuNiA2IDIuMXYxNi4xeiIvPjwvZz48ZyBpZD0iWE1MSURfNDJfIj48cGF0aCBpZD0iWE1MSURfMzJfIiBkPSJNMjA3LjggMzguNWgtNS4yYy0uNiAwLS45LjMtMSAuNy0uMy45LTIuNSA2LjctMy40IDkuMS0uNiAxLjctMi40IDYuNi0yLjQgNi42aC0uMnMtMS4zLTMuNi0yLTUuNGMtLjYtMS40LTMuNS05LjEtMy44LTEwLjEtLjItLjUtLjQtMS0xLjItMWgtNS43Yy0uNiAwLTEgLjctLjggMS4xLjIuNCA5LjMgMjEuMiA5LjMgMjEuMnMtOS44IDIzLjItMTAuMSAyMy44Yy0uMy41LjEgMS4zLjggMS4zaDVjLjkgMCAxLjItLjQgMS40LTEuMi43LTIgMS44LTQuOCAzLjMtOS4yIDEtMi45IDIuNi03LjkgMi42LTcuOWguMnMxLjcgNS4xIDIuNCA2LjhjMS42IDQuMyAzLjcgOS44IDQgMTAuNC4yLjYuNiAxIDEuMSAxaDUuN2MuNiAwIC44LS42LjYtMS4yLS42LTEuMy02LTE0LjQtOS44LTIzLjEgMCAwIDkuNy0yMS41IDkuOS0yMiAuMi0uNC4xLS45LS43LS45eiIvPjwvZz48L2c+PC9zdmc+",u=t.ns?t.ns:e,h=new u.Map(t.container,t.mapState,t.mapOptions);if(t.geoObjectsData){var p=t.geoObjectsData;for(var m in p)if(p.hasOwnProperty(m)){var g=p[m];h.geoObjects.add(new u.GeoObject({geometry:g.geometry,properties:g.properties},{preset:g.options.preset,zIndex:g.options.zIndex}))}}if(t.showStretchLogo){var f=new u.pane.StaticPane(h,{zIndex:1e3,css:{pointerEvents:"none",width:"100%",height:"100%"}});h.panes.append("stretchLogo",f);var _=h.container.events.group().add("sizechange",function(t){i(t.get("newSize"))});h.events.once("destroy",function(){_.removeAll()});var b=new Image;b.style.position="absolute",b.src="ru"===t.showStretchLogo?l:d,b.id="stretchLogo";var v=o;f.getElement().appendChild(b),i(h.container.getSize())}if(t.traffic&&(t.traffic.hasOwnProperty("active")&&!t.traffic.active&&h.layers.options.set({dontChangeCursor:!0,trafficJamOpenHintOnHover:!1}),t.traffic.shown)){var y=h.controls.get("trafficControl");if(y)y.state.set("trafficShown",!0);else{var M=new u.traffic.provider.Actual;M.setMap(h),h.events.add("destroy",function(){M.setMap(null)})}}return h})}),modules.define("ymaps-maps-synchronizer",[],function(t){var e=0,i={};t({enable:function(t,o){t.syncerId||(t.syncerId=++e),o.syncerId||(o.syncerId=++e);var n=t.events.group(),s=o.events.group();i[t.syncerId]={map:t,anotherMap:o,group:n},i[o.syncerId]={map:o,anotherMap:t,group:s},n.add("actionbegin",this._onActionBegin,this),s.add("actionbegin",this._onActionBegin,this)},disable:function(t,e){this._destroyGroup(t.syncerId),this._destroyGroup(e.syncerId)},_onActionBegin:function(t){var e=t.get("target"),o=e.syncerId;if(this._checkGroups(o)&&!i[o].isFollower){var n=i[o].anotherMap,s=e.options.get("projection"),r=e.action.getCurrentState(),a=n.action.getCurrentState(),c=r.globalPixelCenter.concat(),l=a.globalPixelCenter.concat();c=s.toGlobalPixels(s.fromGlobalPixels(c,r.zoom),r.zoom),l=s.toGlobalPixels(s.fromGlobalPixels(l,a.zoom),r.zoom!==a.zoom?r.zoom:a.zoom),i[o].offset=[c[0]-l[0],c[1]-l[1]],i[o].group.add("actiontick",this._onActionTick,this).add("actionend",this._onActionEnd,this)}},_onActionTick:function(t){var e=t.get("target").syncerId;this._checkGroups(e)&&this._sync(i[e],t.get("tick"))},_onActionEnd:function(t){var e=t.get("target").syncerId;if(this._checkGroups(e)){var o=i[e].anotherMap.syncerId;i[e].group.remove("actiontick",this._onActionTick,this).remove("actionend",this._onActionEnd,this);var n=i[o];n.callback&&(n.callback.cancel(),n.callback=null),this._sync(i[e],i[e].map.action.getCurrentState())}},_destroyGroup:function(t){i.hasOwnProperty(t)&&(i[t].group.removeAll(),delete i[t])},_sync:function(t,e){var o=t.anotherMap,n=i[o.syncerId];n.isFollower=!0;var s=o.setGlobalPixelCenter([e.globalPixelCenter[0]-t.offset[0],e.globalPixelCenter[1]-t.offset[1]],e.zoom,{duration:e.duration});return n.isFollower=!1,s},_checkGroups:function(t){return i.hasOwnProperty(t)&&i.hasOwnProperty(i[t].anotherMap.syncerId)}})}),modules.define("interactive-iframe-preview-controller",["base-interactive-preview-controller","ymaps-api"],function(t,e,i){var o=i.util.defineClass(function(t,e){o.superclass.constructor.call(this,t,e)},e,{createMap:function(t,e){var i=o.superclass.createMap.call(this,t,e);return i.then(this._setControls,this),i},getMapInitData:function(t){var e=o.superclass.getMapInitData.call(this,t);return e.mapState.controls=["rulerControl","trafficControl","zoomControl","geolocationControl"],i.util.extend(e.mapState,{type:"yandex#map"}),e},_setControls:function(){this._previewMap&&(this._previewMap.controls.get("zoomControl").options.set("size","small"),this._disablePreviewControls())},_disablePreviewControls:function(){var t=this._previewMap.panes.get("controls").getElement();t.style["pointer-events"]="none",t.style.opacity="0.7"}});t(o)}),modules.define("static-preview-controller",["base-preview-controller","jquery","ymaps-api","result-link"],function(t,e,i,o,n){var s=o.util.defineClass(function(t,e){s.superclass.constructor.call(this,t,e)},e,{createMap:function(t,e){var o=s.superclass.createMap.call(this,t,e);this._imgElem=i("img"),this._lastState=e;var n=this.getMapEditor().getDataProvider();return"saved"===n.get("saveState")&&this._createImage(),this.getMap().events.add("actionbegin",this._removeImage,this),this._listener=n.createListener(),this._listener.add("saveState",this._createImage,this),o},destroyMap:function(){var t=s.superclass.destroyMap.call(this);return this._removeImage(),this.getMap().events.remove("actionbegin",this._removeImage,this),this._listener&&this._listener.destroy(),i(this.getContainer()).css({left:0,top:0,width:0,height:0,"pointer-events":""}),t},onResize:function(t){this._lastState=t,s.superclass.onResize.call(this,t),this._removeImage()},_createImage:function(){this._removeImage(),this._createImageNode()},_createImageNode:function(){if("saved"===this.getMapEditor().getDataProvider().get("saveState")){var t=this._lastState,e=n.getLink("static",this.getMapEditor().getDataProvider().get("sid"),t.size,!1)+"&rand="+Math.random();i(this.getContainer()).css({"pointer-events":"none",left:t.offset[0],top:t.offset[1],width:t.size[0],height:t.size[1]}).append(this._imgElem=i("<img>").attr("src",e).css({width:t.size[0],height:t.size[1]}))}},_removeImage:function(){this._imgElem&&this._imgElem.remove()}});t(s)}),modules.define("print-preview-controller",["base-interactive-preview-controller","ymaps-api","ymaps-loader","ymaps-utils","ymaps-preset-utils","map-data-default","config","vow"],function(t,e,i,o,n,s,r,a,c){var l=i.util.defineClass(function(t,e){l.superclass.constructor.call(this,t,e)},e,{createMap:function(t,e){return a.canExportMap?l.superclass.createMap.call(this,t,e).then(function(t){return this._onMapCreated(),t},this):c.reject()},onResize:function(t){l.superclass.onResize.call(this,t)},getMapInitData:function(t){var e=l.superclass.getMapInitData.call(this,t);return e.mapOptions.copyrightProvidersVisible=!1,e.mapOptions.copyrightUaVisible=!1,e.mapOptions.dragInertia=!1,e.mapOptions.geoObjectInteractiveZIndex=!1,e.showStretchLogo=a.printLogoLang,i.util.extend(e.mapOptions,r.disabledGeoObjectCollection),i.util.extend(e.mapState,{type:"yandex#map"}),e},_onMapCreated:function(){this._previewMap&&(this._previewMap.panes.get("copyrights").getElement().style.display="none",this._previewMap.layers.options.set("trafficJamInteractivityModel","default#silent"))}});t(l)}),modules.define("hotkey-manager",["jquery","history-manager","copy-manager","yametrika","config"],function(t,e,i,o,n,s){function r(t,e){return Object.keys(e).every(function(i){return t[i]===e[i]||"callback"===i})}function a(t,e){return t.length===e.length&&t.every(function(t,i){return t===e[i]})}var c={C:"C".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),P:"P".charCodeAt(0),O:"O".charCodeAt(0),V:"V".charCodeAt(0),Z:"Z".charCodeAt(0),Y:"Y".charCodeAt(0),ruM:192,enter:13,esc:27,backspace:8,"delete":46,downArrow:40,upArrow:38},l=!0,d=["input","textarea"],u={setDataProvider:function(t){this._dataProvider=t,this._attached||(this._attachHotkeysListener(),this._attached=!0)},_dataProvider:null,_attached:!1,_enabled:!0,_attachHotkeysListener:function(){e(window).on("keydown",function(t){var e=t.target.tagName.toLowerCase();this._dataProvider&&-1===d.indexOf(e)&&this._enabled&&(t.isMac="MacOS"===s.OSFamily,t.specialKey=t.isMac?t.metaKey:t.ctrlKey,this._hotkeys.forEach(function(e){r(t,e)&&e.callback.call(this,t)},this))}.bind(this)),e(window).on("keyup",function(t){this._dataProvider&&44===t.keyCode&&n.printScreen(this._dataProvider)}.bind(this))},setEnabled:function(t){this._enabled=t},_hotkeys:[{which:c.L,altKey:l,callback:function(t){this._toggleTool("linestring")&&t.preventDefault()}},{which:c.M,altKey:l,callback:function(t){this._toggleTool("polygon")&&t.preventDefault()}},{which:c.ruM,altKey:l,callback:function(t){this._toggleTool("polygon")&&t.preventDefault()}},{which:c.P,altKey:l,callback:function(t){this._toggleTool("point")&&t.preventDefault()}},{which:c.enter,callback:function(t){this._finishDrawing(!0,!1),t.preventDefault()}},{which:c.esc,callback:function(t){this._finishDrawing(!1,!0),t.preventDefault()}},{metaKey:!0,which:c.backspace,callback:function(t){t.preventDefault(),this._dataProvider.get("activeGeoObjectsIds").length&&n.hotkeyUsed("delete"),this._removeActiveGeoObjects()}},{which:c.delete,callback:function(t){t.preventDefault(),this._dataProvider.get("activeGeoObjectsIds").length&&n.hotkeyUsed("delete"),this._removeActiveGeoObjects()}},{shiftKey:!0,specialKey:!0,which:c.downArrow,callback:function(t){this._moveGeoObject("bottom")&&t.preventDefault()}},{shiftKey:!0,specialKey:!0,which:c.upArrow,callback:function(t){this._moveGeoObject("top")&&t.preventDefault()}},{shiftKey:!1,specialKey:!0,which:c.downArrow,callback:function(t){this._moveGeoObject("down")&&t.preventDefault()}},{shiftKey:!1,specialKey:!0,which:c.upArrow,callback:function(t){this._moveGeoObject("up")&&t.preventDefault()}},{specialKey:!0,shiftKey:!1,which:c.Z,callback:function(t){t.preventDefault(),i.can("undo")&&(i.undo(),n.hotkeyUsed("undo"))}},{specialKey:!0,shiftKey:!0,which:c.Z,callback:function(t){t.preventDefault(),i.can("redo")&&(i.redo(),n.hotkeyUsed("redo"))}},{ctrlKey:!0,shiftKey:!1,which:c.Y,callback:function(t){t.preventDefault(),i.can("redo")&&(i.redo(),n.hotkeyUsed("redo"))}},{specialKey:!0,shiftKey:!1,which:c.C,callback:function(t){t.preventDefault(),o.saveCopy(),this._dataProvider.get("activeGeoObjectsIds").length&&n.hotkeyUsed("copy")}},{specialKey:!0,shiftKey:!1,which:c.V,callback:function(t){t.preventDefault(),o.insertCopy(),this._dataProvider.get("activeGeoObjectsIds").length&&n.hotkeyUsed("paste")}}],_finishDrawing:function(t,e){var i=this._dataProvider.get("activeGeoObjectsIds"),o=this._dataProvider.get("drawingMode"),s=this._dataProvider.get("drawingController");if(this._dataProvider.set("drawingController",null),i.length){var r=this._dataProvider.get("geoObjectsWithBalloonIds");a(r,i)?this._dataProvider.set("geoObjectsWithBalloonIds",[]):(this._dataProvider.set("activeGeoObjectsIds",[]),(t||o)&&this._dataProvider.set("geoObjectsWithBalloonIds",i)),n.hotkeyUsed("finish_drawing")}e||this._dataProvider.set("drawingController",s)},_moveGeoObject:function(t){var e=this._dataProvider.get("activeGeoObjectsIds"),i=this._dataProvider.get("geoObjects");if(!e.length)return!1;e=i.get(e[0]);var o=i.getByType(e.geometry.type.toLowerCase()),s=o.indexOf(e);s={up:Math.min(s+1,o.length-1),down:Math.max(s-1,0),top:o.length-1,bottom:0}[t];var r=e.properties.geoObjectId;return i.reorderGeoObject(r,s),n.hotkeyUsed("zindex_"+t),!0},_toggleTool:function(t){if(this._dataProvider.get("drawingController")===t){var e=this._dataProvider.get("drawingMode");this._dataProvider.set("drawingController",null),e&&this._dataProvider.set("geoObjectsWithBalloonIds",this._dataProvider.get("activeGeoObjectsIds"))}else this._dataProvider.set("drawingController",t);return n.hotkeyUsedTool(t),!0},_removeActiveGeoObjects:function(){var t=this._dataProvider.get("activeGeoObjectsIds");t.length&&this._dataProvider.get("geoObjects").removeGeoObjects(t)}};t(u)}),modules.define("copy-manager",["ymaps-api","jquery"],function(t,e,i){var o=e.util.bounds,n={setDataProvider:function(t){this._dataProvider=t,this._activeGeoObject=null,this._focusedGeoObject=null,this._copyGeoObject=null,t.createListener().add("activeGeoObjectsIds",function(e){this._activeGeoObject=t.get("geoObjects").get(e[0])},this).add("focusedGeoObjectsIds",function(e){this._focusedGeoObject=t.get("geoObjects").get(e[0])},this)},clearCopy:function(){this._copyGeoObject=null},saveCopy:function(){this._activeGeoObject&&this._checkExceptions(this._activeGeoObject)&&(this._copyGeoObject=this._createCopyOfGeoObject(this._activeGeoObject))},insertCopy:function(){var t=this._dataProvider.get("geoObjects");if(this._copyGeoObject&&t.canAddGeoObject()){var e=this._getCenterAndZoom(this._copyGeoObject).zoom;e<this._dataProvider.get("zoom")&&this._dataProvider.set("zoom",e),this._setOffset(this._copyGeoObject),this._isMapContains(this._copyGeoObject)||this._dataProvider.set("center",this._getCenterAndZoom(this._copyGeoObject).center);var i=t.addGeoObjects([this._copyGeoObject])[0];return this._copyGeoObject=this._createCopyOfGeoObject(i.data),this._clearFocus(),this._setFocus(i.id),i.id}},_setOffset:function(t){t.geometry.coordinates=this._calculateOffset(t)},_checkExceptions:function(t){var e=t.geometry.type,i=t.geometry.coordinates;return"LineString"===e&&i.length<2?!1:"Polygon"===e&&i[0].length<4?!1:!0},_calculateOffset:function(t){var i=t.geometry.coordinates,o=t.geometry.type,n=this._dataProvider.get("zoom"),s=e.projection.wgs84Mercator,r=50,a=function(t){var e=s.toGlobalPixels(t,n);return e=[e[0]+r,e[1]-r],s.fromGlobalPixels(e,n)};return"Point"===o?a(i):"LineString"===o?i.map(function(t){return a(t)},this):i.map(function(t){return t.map(function(t){return a(t)},this)},this)},_getCenterAndZoom:function(t){var e=this._getBounds(t),i=this._dataProvider.get("currentContainerSize");return o.getCenterAndZoom(e,i)},_isMapContains:function(t){var e=this._dataProvider.get("bounds"),i=this._getBounds(t);return o.containsBounds(e,i)},_getBounds:function(t){return o.fromPoints(this._getGeoObjectCoordinates(t))},_getGeoObjectCoordinates:function(t){return t.geometry.coordinates.toString().split(",").map(Number).reduce(function(t,e,i,o){return i%2>0&&t.push([o[i-1],e]),t},[])},_clearFocus:function(){this._dataProvider.set({activeGeoObjectsIds:[],geoObjectsWithBalloonIds:[]})},_setFocus:function(t){this._dataProvider.set({activeGeoObjectsIds:[t]})},_createCopyOfGeoObject:function(t){var e={geometry:i.extend(!0,{},t.geometry),options:{preset:t.options.preset},properties:i.extend(!0,{},t.properties)};return delete e.properties.geoObjectId,delete e.properties.serverId,delete e.properties.source,e}};t(n)}),modules.define("export-image",["vow","export-isolated-map-factory","util-require-plus","yadisk-client","config","i18n-plus","rpc-client","html-resize-canvas","export-utils","html-canvas-to-blob"],function(t,e,i,o,n,s,r,a,c,l){function d(t,r){function a(){e.all([i.createMap(t,b),o(["html-renderer"])]).spread(function(t,e){M=t,p.notify(m(++f));var i=e[0],o=t.getMapObject().container.getElement().parentNode.parentNode;i(o).then(l,d)},d,function(){p.notify(m(++f))})}function l(i){try{var o="image/"+_;v&&(i=c(i,t.get("imageExportScale")/b)),i.toBlob(function(i){var o=h(_,t,r.saveToDisk);p.notify(m(++f)),r.saveToDisk?e.all([n.getOrCreateDirectory(g),u(t)]).then(function(){p.notify(m(++f)),n.upload(o,i).then(function(){p.resolve({blob:i,fileName:o})},d)},d):p.resolve({blob:i,fileName:o})},o,1)}catch(s){d(s)}}function d(t){p.reject(t||{})}var p=e.defer(),f=0;setTimeout(function(){p.notify(m(++f))},0);var _=t.get("imageExportFileType"),b=t.get("imageExportScale"),v=b!==Math.ceil(b)&&(s.browser.isSafari||s.browser.isGecko||s.browser.isEdge);v&&(b=Math.ceil(b));var y=p.promise(),M=null;return y.always(function(){M&&(M.destroy(),M=null)},this),r.saveToDisk?u(t).then(a,d):a(),y}function u(t){return a.checkMapOwner(t.get("sid"))}function h(t,e,i){return l.generateFileName(i?g+"/":"",f,{fileName:e.get("mapName")||_,imageFormat:t})}function p(t,e,i){this.message=t,this.step=e,this.total=i}function m(t){return new p(r("popup","map_print_loader_step"+t),t,b)}var g=r("login-form","yadisk_folder_name"),f=r("login-form","yadisk_file_name_pattern"),_=r("map-selection","no-name-map"),b=5;t(d)}),modules.define("html-renderer",["vow","ymaps-api","html-to-canvas"],function(t,e,i,o){function n(t){var n=e.defer(),s=i.util.defineClass(function(){s.superclass.constructor.apply(this,arguments)},o.CanvasRenderer,{renderBackgroundRepeating:function(t,e,i){this.renderImage(t,e,t.borders,i)}});return o(t,{useCORS:!0,onrendered:function(t){n.resolve(t)},renderer:s}),n.promise()}t(n)}),modules.define("html-to-canvas",["loader_type_js","config"],function(t,e,i){window.html2canvas?t(window.html2canvas):e(i.baseURL+"res/libs/html2canvas.min.js",function(){t(window.html2canvas)})}),modules.define("export-isolated-map-factory",["vow","ymaps-api","ymaps-loader","ymaps-utils","ymaps-map-factory","config","map-data-default","util-string"],function(t,e,i,o,n,s,r,a,c){function l(t,i){var n=e.defer(),l=t.get("containerSize"),u=t.getData(),h=document.createElement("iframe");this._iframe=h,h.setAttribute("width","400"),h.setAttribute("height","400"),document.body.appendChild(h),h.style.position="absolute",r.browser.isChromium?(h.style.left="0px",h.style.top="0px",h.style.visibility="hidden"):(h.style.left="-99999px",h.style.top="-99999px"),h.style.zIndex=3e4,h.style.width="1000px",h.src="about:blank",window.onApiLoaded=function(){n.notify("API_LOADED"),delete window.onApiLoaded};var p=setTimeout(function(){p=0,n.reject()},18e4);window.onReady=function(t){this._map=t,p&&(clearTimeout(p),p=0),n.resolve(this),delete window.onReady}.bind(this);var m=s.toString().replace(/function ?\(/,"function createMap ("),g=a.getDefaultMapOptions.toString().replace(/function ?\(/,"function getDefaultMapOptions ("),f=c.removeUtfMagic(JSON.stringify({data:u,config:r}).replace(/<\/script>/g,"")),_=["<!DOCTYPE html>","<html>","<head>",'<script src="',o.getLink({load:r.exportLoadModules}),'" charset="utf-8" type="text/javascript"></script>',"<script nonce="+r.cspNonceKey+' charset="utf-8" type="text/javascript">',"var ua = "+JSON.stringify(r.browser)+";"+m+"; "+g+"; "+d.toString().replace(/function.*?\((.*?)\)/,"function onInit($1)")+" onInit("+f+");","</script>","<style nonce="+r.cspNonceKey+">#container {","width: ",l[0],"px; ","height: ",l[1],"px; ","transform: scale(",i,"); transform-origin: 0px 0px;","}</style>","</head>","<body>","<div id=container></div>","</body>","</html>"],b=h.contentDocument;return b.open(),b.write(_.join("")),b.close(),h.contentWindow.devicePixelRatio=i,h.contentWindow.customDPR=i,n.promise()}function d(t){var e=t.data,i=t.config,o=window.ymaps;o.ready(function(){parent.onApiLoaded(),o.util.hd.getPixelRatio=function(){return window.customDPR},o.modules.require(["graphics.render.canvas.support","theme.islands.geoObject.pictogram.icons","util.dom.styleSheet","util.dom.style"],function(t,n,s,r){function a(t){function e(t){var e=t.parentNode,i=document.defaultView.getComputedStyle(t,null),o=i.bottom,n=i.right,s=i.top,r=i.left,a=i.width,c=i.height,l=document.createElement("div"),d=t.src;d||(d=document.defaultView.getComputedStyle(t,null).backgroundImage,d=d.replace(/url\("?/g,"").replace(/"?\)/g,"")),l.innerHTML=atob(d.split(",")[1].replace(/\s/g,"").replace(/\)$/,"")),e.removeChild(t),t=l.children[0],t.setAttribute("width",Math.round(a.replace("px",""))),t.setAttribute("height",Math.round(c.replace("px",""))),l.style.position="absolute",o&&(l.style.bottom=o),n&&(l.style.right=n),s&&(l.style.top=s),r&&(l.style.left=r),e.appendChild(l)}var i=t.panes.get("stretchLogo").getElement();i.firstChild&&e(i.firstChild);var n,s,r=".ymaps-"+o.meta.version.replace(/\./g,"-"),a=document.querySelectorAll(r+"-pictogramIconContent");for(n=0,s=a.length;s>n;n++)e(a[n]);for(a=document.querySelectorAll(r+"-pictogramCircleIconContent"),n=0,s=a.length;s>n;n++)e(a[n])}function c(){for(var t={},e=".ymaps-"+i.ymaps.version.replace(/\./g,"-")+"-pictogram_icon_",o=[],a=0;a<document.styleSheets.length;a++)for(var c=document.styleSheets[a].rules||document.styleSheets[a].cssRules,l=0;l<c.length;l++)o.push(c[l]);for(var d=0;d<o.length;d++){var u=o[d].selectorText;u&&-1!==u.indexOf(e)&&(t[u]=o[d].cssText||o[d].style.cssText)}n.map(function(i){var o=e+i,n=t[o];if(!n)return null;var s=[/background-image: url\("?(.+?)"?\)/g,/list-style-image: url\("?(.+?)"?\)/g],a=s.map(function(t){var e=t.exec(n)[1],i=e.replace("data:image/svg+xml;base64,",""),o=(new DOMParser).parseFromString(atob(i),"image/svg+xml");return r.attr(o.documentElement,{width:22,height:22}),"data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(o.documentElement))});return n=n.replace(s[0],"background-image: url("+a[0]+")"),n=n.replace(s[1],"list-style-image: url("+a[1]+")"),n=n.replace(o,""),{selector:o,body:n}}).filter(function(t){return t}).forEach(function(t){s.addStyle(t.selector,t.body)})}var l=e.presetStorage;for(var d in l)l.hasOwnProperty(d)&&o.option.presetStorage.add(d,l[d]);var u=e.map,h=u.state.trafficControlEnabled,p=h?2:1;c();var m=createMap({ns:o,container:"container",mapState:{center:u.state.center,zoom:u.state.zoom,type:"yandex#map",controls:[],behaviors:[]},showStretchLogo:i.printLogoLang,traffic:{shown:h,active:!1},mapOptions:o.util.extend({},{layerCrossOrigin:!0,layerTileContainerClass:o.layer.tileContainer.CanvasContainer,layerNotFoundTile:["data:image/png;base64,iVBORw0K","GgoAAAANSUhEUgAAAAEAAAABCAAAAAA","6fptVAAAACklEQVQI12PYBwAAwAC/UkxR6Q","AAAABJRU5ErkJggg=="].join(""),suppressMapOpenBlock:!0,geoObjectSyncOverlayInit:!0,groundPaneViewportMargin:0,copyrightProvidersVisible:!1,copyrightUaVisible:!1,layerTileAnimateOpacity:!1,layerTileAnimationDuration:0,geoObjectRenderType:"canvas"},getDefaultMapOptions(o)),geoObjectsData:u.geoObjects&&u.geoObjects.features});m.container.getElement().style.background="white";var g=["copyrights","hint","controls","shadows","events","overlaps","balloon","outerBalloon","outerHint"];if(g.forEach(function(t){var e=m.panes.get(t);e&&e.getElement()&&(e.getElement().style.display="none")}),h){var f=m.options.get("actualProviderUrlTemplate");m.options.set("actualProviderUrlTemplate",f+"#crossOrigin")}var _=m.panes.get("ground").getElement();
_.style.display="none",m.layers.events.add("ready",function(t){t.get("target").getTileUrl&&0===--p&&setTimeout(function(){requestAnimationFrame(function(){ua.isSafari&&a(m),_.style.display=null,parent.onReady(m)})},2e3)},this)})})}l.prototype.getMapObject=function(){return this._map},l.prototype.destroy=function(){this._iframe&&(this._iframe.parentNode.removeChild(this._iframe),this._iframe=null)},t({createMap:function(t,e){return new l(t,e)}})}),modules.define("html-resize-canvas",function(t){t(function(t,e){var i=document.createElement("canvas"),o=t.width*e,n=t.height*e;return i.width=o,i.height=n,i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,o,n),i})}),modules.define("html-canvas-to-blob",[],function(t){HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,i){for(var o=atob(this.toDataURL(e,i).split(",")[1]),n=o.length,s=new Uint8Array(n),r=0;n>r;r++)s[r]=o.charCodeAt(r);t(new Blob([s],{type:e||"image/png"}))}}),t({})}),modules.define("loader_type_js",function(t){var e={},i={},o=document.getElementsByTagName("head")[0],n=function(t,i){var o,n=e[t],s=0;for(delete e[t];o=n[s++];)o[i]&&o[i]()},s=function(t){i[t]=!0,n(t,"success")},r=function(t){n(t,"error")};t(function(t,n,a){if(i[t])return void(n&&n());if(e[t])return void e[t].push({success:n,error:a});e[t]=[{success:n,error:a}];var c=document.createElement("script");c.type="text/javascript",c.charset="utf-8",c.src=("file:"!==location.protocol||t.indexOf("//")?"":"http:")+t,"onload"in c?(c.onload=function(){c.onload=c.onerror=null,s(t)},c.onerror=function(){c.onload=c.onerror=null,r(t)}):c.onreadystatechange=function(){var e=this.readyState;("loaded"===e||"complete"===e)&&(c.onreadystatechange=null,s(t))},o.insertBefore(c,o.lastChild)})}),modules.define("i-bem-dom__events_type_dom",["i-bem-dom__events","inherit","jquery"],function(t,e,i,o){var n=function(t){return t},s=i(e.EventManagerFactory,{_createEventManager:function(t,e,i){function s(n){return function(s){var r;if(i)r=t;else{var a=o(s.target).closest(e.ctxSelector);a.length&&(r=a.bem(t))}r&&(e.bindEntityCls&&(s.bemTarget=o(this).bem(e.bindEntityCls)),n.call(r,s))}}return new this._eventManagerCls(e,s,n)}});t({EventManagerFactory:s})}),modules.define("page",["i-bem-dom","bh","map-data-manager","config","yametrika","modal","map-selection","header"],function(t,e,i,o,n,s,r,a,c,l){t(e.declBlock(l,{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),o.events.add("LIST_UPDATED",function(){this._checkMapCount(),n.user.isUserAuthorized&&!o.getTotal()&&this.setMod("step","editor")},this).add("MAP_REMOVED",function(t){t.get("sid")===this._mapDataProvider.get("sid")&&this.selectMap(null,"constructor")},this).add("NETWORK_ERROR",function(t){this.showErrorMessage(t.get("error"))},this),this._checkMapCount()}}},applyState:function(t){if("mapselection"===t){var e=this._getMapSelectionPopup();e.setMod("visible"),e.findChildBlock(a).setMod("active",!0)}else this._mapSelectionPopup&&(this._mapSelectionPopup.setMod("visible",!1),this._mapSelectionPopup.findChildBlock(a).setMod("active",!1));this.__base.apply(this,arguments),this._checkMapCount()},_getMapSelectionPopup:function(){if(!this._mapSelectionPopup){this._mapSelectionPopup=e.append(this.domElem,i.apply({block:"modal",mix:[{block:"z-index-group",mods:{level:6}},{block:"page",elem:"map-selection"}],zIndexGroupLevel:6,mods:{theme:"custom",transparent:!0,autofocus:!0,closable:!0},content:{block:"map-selection",mods:{source:"constructor"}}})).bem(r);var t=this._mapSelectionPopup.findChildBlock(a);this._events(this._mapSelectionPopup).on({modName:"visible",modVal:""},function(){this.setMod("step","editor")},this),this._events(t).on("mapSelect",function(t,e){this.setMod("step","editor"),this.selectMap(e.id),s.mapSelection(e)},this).on("importMap",function(t){this.selectMap(null,"constructor"),this.setMod("step","import-modal"),s.mapSelection(t)},this),t.setDataProvider(o)}return this._mapSelectionPopup},_checkMapCount:function(){var t=o.getTotal(),e=t<n.limits.count.maps;this._mapSelectionPopup&&this._mapSelectionPopup.findChildBlock(a).setMod("can-create-new-map",e),this._sidebar.setMod("can-create-new-map",e),this.findChildBlock(c).setMod("nomaps",!t)}}))}),modules.define("modal",["i-bem-dom","popup"],function(t,e,i){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._popup=this.findMixedBlock(i)},"":function(){this.delMod("visible")}},visible:function(t,e){this._popup.setMod(t,e)}},setContent:function(t){return e.update(this._elem("content").domElem,t),this}},{lazyInit:!0}))}),modules.define("map-selection",["i-bem-dom","bh","jquery","i18n-plus","config","vow","yametrika","map-selection-item","button"],function(t,e,i,o,n,s,r,a,c,l){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._mapItemById={},this._createNewMapButton=this.findChildBlock({block:l,modName:"id",modVal:"create-button2"}),this._events(this._createNewMapButton).on("click",this._createNewMap,this),this._domEvents(this.findChildBlock({block:l,modName:"id",modVal:"import-button"})).on("click",this._onImportMapClick,this),this._domEvents().on("keydown",this._onKeyDown,this),this._elem("map-list").domElem[0].onscroll=function(t){var e=o(t.target);e.scrollTop()>0&&Math.ceil(e.scrollTop()+e.height())>=e[0].scrollHeight&&this._makeNextPageRequest(),this._hideDropDownItem(),this._onFirstItemModChange()}.bind(this),this._holder=this._elem("map-list-constructor-holder"),this._applyNewMapButtonState()}},"can-create-new-map":function(){this._applyNewMapButtonState()}},setDataProvider:function(t){return this._dataProvider=t,t.events.add("LIST_UPDATED",this._listUpdateHandler,this),this._listUpdateHandler(),this},_listUpdateHandler:function(){0===this._dataProvider.getTotal()?this.setMod("nomaps"):this._updateList()},_applyNewMapButtonState:function(){this._createNewMapButton.setMod("disabled",!this.getMod("can-create-new-map"))},_selectMap:function(t){this._emit("mapSelect",{id:t})},_updateList:function(){var t=this._holder.findChildBlocks(c).toArray();this._dataProvider.getLoadedList().forEach(function(i,o){var n=i.get("sid"),s=this._mapItemById[n],r=t.indexOf(s);s?r!==o&&(0===o?e.before(t[0].domElem,s.domElem):e.after(t[o-1].domElem,s.domElem),t.splice(r,1),t.splice(o,0,s)):t.splice(o,0,this._createItem(i,o))},this),this._setNoItemsMessageVisibility(0===this.findChildBlocks(c).length),this.setMod("no-bottom-border",!1),this._setFirstItemListener()},_setFirstItemListener:function(){this._firstItem&&(this._events(this._firstItem).un({modName:"hover",modVal:"*"},this._onFirstItemModChange,this),this._events(this._firstItem).un({modName:"active",modVal:"*"},this._onFirstItemModChange,this)),this._firstItem=this._holder.findChildBlock(c),this._firstItem&&(this._domEvents(this._firstItem).on("mouseenter mouseleave",this._onFirstItemModChange,this),this._events(this._firstItem).on({modName:"active",modVal:"*"},this._onFirstItemModChange,this))},_createItem:function(t,n){var s,r=t.get("sid"),a=i.apply({block:"map-selection-item",id:r,sourceType:r.indexOf("mymaps")>-1?"mymaps":"constructor"}),l=this._holder.domElem[0];s=0===n?e.prepend(l,a):n>l.childNodes.length-1?e.append(l,a):e.before(o(".map-selection-item",l).eq(n),a);var d=s.bem(c);return this._events(d).on("select",this._onSelectItem,this).on("remove",this._onRemoveItem,this).on("duplicate",this._onDuplicateItem,this).on("dropdown",this._onDropdown,this),this._mapItemById[r]=d,d.setMapEntry(t),d},_removeItem:function(t,i){e.destruct(t.domElem),delete this._mapItemById[i]},_onSelectItem:function(t,e){this._dropdownItem?(this._hideDropDownItem(),t.target.domElem.blur()):this._selectMap(e.id)},_onDuplicateItem:function(t,e){this._applyLoaderState(!0),this.setMod("map-list-loader",!0),this._setupBeforeUnload(),this._dataProvider.duplicateMap(e.id).always(function(){this._teardownBeforeUnload(),this._applyLoaderState(!1),this.setMod("map-list-loader",!1)},this),a.reachGoal("CLICK_DUPLICATE")},_onRemoveItem:function(t,e){this._applyLoaderState(!0),this.setMod("map-list-loader",!0),this._dataProvider.removeMap(e.id).then(function(){this._removeItem(t.target,e.id)},this).always(function(){this._applyLoaderState(!1),this.setMod("map-list-loader",!1)},this),a.reachGoal("CLICK_DELETE")},_onKeyDown:function(t){var e=13;if(t.which===e){var i=o(".map-selection-item:focus");i&&i.click()}},_onDropdown:function(t,e){this._hideDropDownItem(),this._dropdownItem=e},_onFirstItemModChange:function(t){t&&"mouseenter"===t.type&&0!==(t.buttons||0)||this.setMod("no-bottom-border",Boolean(this._firstItem)&&(this._firstItem.getMod("hover")||this._firstItem.getMod("active"))&&0===this._elem("map-list").domElem.scrollTop())},_applyLoaderState:function(t){this._elem("map-list-loader").setMod("hidden",!t),t&&this._setNoItemsMessageVisibility(!1)},_setNoItemsMessageVisibility:function(t){this._elem("map-list-no-items-message").setMod("hidden",!t)},_makeNextPageRequest:function(){this._applyLoaderState(!0),this._dataProvider.loadNextPage().always(function(){this._applyLoaderState(!1)},this)},_createNewMap:function(){this._selectMap(null,"constructor")},_onImportMapClick:function(t){t.stopPropagation(),this._emit("importMap"),a.reachGoal("CLICK_IMPORT"),o(window).trigger("pointerclick")},_hideDropDownItem:function(){this._dropdownItem&&this._dropdownItem._popup.setMod("visible",!1)},_setupBeforeUnload:function(){window.addEventListener("beforeunload",this._beforeUnloadHander,this)},_teardownBeforeUnload:function(){window.removeEventListener("beforeunload",this._beforeUnloadHander,this)},_beforeUnloadHander:function(t){t.returnValue=n("map-selection","close-editor-confirm"),t.preventDefault()}}))}),modules.define("jquery",function(t,e){function i(t){var i=e.extend(new e.Event,t);return t.preventDefault&&(i.preventDefault=function(){t.preventDefault()}),i}e.each({pointerpress:"pointerdown",pointerrelease:"pointerup pointercancel"},function(t,o){function n(o){if(1===o.which){var n=i(o);return n.type=t,n.originalEvent=o,e.event.dispatch.call(this,n)}}e.event.special[t]={setup:function(){return e(this).on(o,n),!1},teardown:function(){return e(this).off(o,n),!1}}}),t(e)}),modules.define("popup",["objects"],function(t,e,i){t(i.declMod({modName:"theme",modVal:"islands"},{getDefaultParams:function(){return e.extend(this.__base(),{mainOffset:5,viewportOffset:10})}}))}),modules.define("popup",["i-bem-dom","jquery","objects","functions__throttle","z-index-group"],function(t,e,i,o,n,s,r){var a,c=i(e.doc[0].body),l=100;t(r.declMod({modName:"target",modVal:"anchor"},{beforeSetMod:{visible:{"true":function(){if(!this._anchor)throw Error("Can't show popup without anchor")}}},onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._destructorClass=e.declBlock("_"+this.__self.getName()+"-destructor"),this._anchor=null,this._anchorParents=null,this._destructor=null,this._isAnchorVisible=a,this._updateIsAnchorVisible=n(this._updateIsAnchorVisible,l,!1,this)},"":function(){this.__base.apply(this,arguments),this._unbindFromDestructor()}},visible:{"true":function(){this._anchorParents=this._anchor.parents(),this._bindToAnchorParents(),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this._unbindFromAnchorParents(),this._anchorParents=null,this._isAnchorVisible=a}}},setAnchor:function(t){return this._unbindFromAnchorParents()._unbindFromParentPopup()._unbindFromDestructor(),this._anchor=t.domElem||t,this._destructor=this._anchor.bem(this._destructorClass),this._isAnchorVisible=a,this._bindToDestructor(),this.hasMod("visible")?(this._anchorParents=this._anchor.parents(),this._recaptureZIndex()._bindToAnchorParents()._bindToParentPopup().redraw()):(this._anchorParents=null,this._zIndexGroupLevel=null),this},_calcTargetDimensions:function(){var t=this._anchor,e=t.offset(),i="static"===c.css("position")?{left:0,top:0}:c.offset();return{left:e.left-i.left,top:e.top-i.top,width:t.outerWidth(),height:t.outerHeight()}},_calcDrawingCss:function(t){return"undefined"==typeof this._isAnchorVisible&&(this._isAnchorVisible=this._calcIsAnchorVisible()),o.extend(this.__base(t),{display:this._isAnchorVisible?"":"none"})},_calcIsAnchorVisible:function(){var t=this._anchor,e=t.offset(),o=e.left,n=e.top,s=o+t.outerWidth(),r=n+t.outerHeight(),a=this.getMod("direction"),c=Math.floor(this._checkMainDirection(a,"top")||this._checkSecondaryDirection(a,"top")?n:r),l=Math.floor(this._checkMainDirection(a,"left")||this._checkSecondaryDirection(a,"left")?o:s),d=!0;return this._anchorParents.each(function(){if("BODY"===this.tagName)return!1;var t=i(this),e=t.css("overflow-y"),o="scroll"===e||"hidden"===e||"auto"===e,n=t.css("overflow-x"),s="scroll"===n||"hidden"===n||"auto"===n;if(o||s){var r=t.offset();if(o){var a=Math.floor(r.top);if(a>c||a+t.outerHeight()<c)return d=!1}if(s){var u=Math.floor(r.left);return d=!(u>l||u+t.outerWidth()<l)}}}),d},_calcZIndexGroupLevel:function(){var t=this.__base.apply(this,arguments);return this._destructor.findParentBlocks(s).reduce(function(t,e){return t+Number(e.getMod("level"))},t)},_bindToAnchorParents:function(){return this._domEvents(this._anchorParents).on("scroll",this._onAnchorParentsScroll),this},_unbindFromAnchorParents:function(){return this._anchorParents&&this._domEvents(this._anchorParents).un("scroll",this._onAnchorParentsScroll),this},_onAnchorParentsScroll:function(){this.redraw()._updateIsAnchorVisible()},_onWinScrollAndResize:function(){this.__base.apply(this,arguments),this._updateIsAnchorVisible()},_updateIsAnchorVisible:function(){if(this.hasMod("js","inited")&&this.hasMod("visible")){var t=this._calcIsAnchorVisible();t!==this._isAnchorVisible&&(this._isAnchorVisible=t,this.redraw())}},_bindToDestructor:function(){return this._events(this._destructor).on({modName:"js",modVal:""},this._onPopupAnchorDestruct,this),this},_unbindFromDestructor:function(){return this._destructor&&this._events(this._destructor).un({modName:"js",modVal:""},this._onPopupAnchorDestruct,this),this},_onPopupAnchorDestruct:function(){e.destruct(this.domElem)},_getParentPopup:function(){if(this._parentPopup)return this._parentPopup;var t=this._anchor.closest(r._buildSelector());return this._parentPopup=!!t.length&&t.bem(r)}}))}),modules.define("input",["jquery"],function(t,e,i){t(i.declMod({modName:"autoselect",modVal:!0},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._domEvents().on("mouseup",this._onMouseUp)}},_onMouseUp:function(t){this.selectAll(),t.preventDefault()},selectAll:function(){e(this.domElem).find("input")[0].setSelectionRange(0,9999)}}))}),modules.define("dropdown",["i-bem-dom","popup"],function(t,e,i){t(e.declBlock(this.name,{beforeSetMod:{opened:{"true":function(){return this.hasMod("disabled")?!1:void 0}}},onSetMod:{js:{inited:function(){this._switcher=null,this._popup=null}},opened:function(t,e){this.getPopup().setMod("visible",e),this._switcher.domElem.attr("aria-expanded",!!e)},disabled:{"*":function(t,e){this.getSwitcher().setMod(t,e)},"true":function(){this.getPopup().delMod("visible")}}},getPopup:function(){return this._popup?this._popup:(this._popup=this.findMixedBlock(i).setAnchor(this.getSwitcher()),this._popup._events().on({modName:"visible",modVal:"*"},this._onPopupVisibilityChange,this),this._popup)},getSwitcher:function(){return this._switcher||(this._switcher=this.findMixedBlock(this._getSwitcherClass()))},_getSwitcherClass:function(){return e.declBlock(this.getMod("switcher"))},onSwitcherClick:function(t){this._switcher||(this._switcher=t.target),this.toggleMod("opened")},_onPopupVisibilityChange:function(t,e){this.setMod("opened",e.modVal)}},{lazyInit:!0}))}),modules.define("dropdown",["link"],function(t,e,i){t(i.declMod({modName:"switcher",modVal:"link"},{getSwitcher:function(){return this._switcher||(this._switcher=this.findMixedBlock(e))}},{onInit:function(){return this._events(e).on("click",this.prototype.onSwitcherClick),this.__base.apply(this,arguments)}}))}),modules.define("menu__item",["link"],function(t,e,i){t(i.declMod({modName:"type",modVal:"link"},{onSetMod:{hovered:{"true":function(){this._block().hasMod("focused")&&this._getLink().setMod("focused")},"":function(){var t=this._block();t.hasMod("focused")&&t.domElem.focus()}},disabled:function(t,e){this.__base.apply(this,arguments),this._getLink().setMod(t,e)}},_getLink:function(){return this._link||(this._link=this.findChildBlock(e))},_onFocus:function(){this.setMod("hovered")}},{lazyInit:!0,onInit:function(){return this._domEvents().on("focusin",this.prototype._onFocus),this.__base.apply(this,arguments)}}))}),modules.define("attach",["i-bem-dom","i-bem__internal","control","button","jquery","strings__escape"],function(t,e,i,o,n,s,r){function a(t){return t.split("\\").pop()}t(e.declBlock(this.name,o,{onSetMod:{disabled:function(t,e){this.__base.apply(this,arguments),this._getButton().setMod(t,e)}},clear:function(t){return this.getVal()?this._clear(t):this},_clear:function(t){var i=this._elem("control").domElem,o=i.attr("name"),n=i.attr("tabindex");return e.replace(i,'<input class="'+i.attr("class")+'" type="file"'+(o?' name="'+o+'"':"")+(n?' tabindex="'+n+'"':"")+"/>"),this._elem("file")&&e.destruct(this._elem("file").domElem),this.domElem.append(this._elem("no-file").domElem),this._emitChange(t)},_onClearClick:function(){this.clear({source:"clear"})},_onChange:function(){this._elem("no-file").domElem.detach(),this.getVal()?this._updateFileElem()._emitChange():this._clear()},_emitChange:function(t){return this._emit("change",t)},_updateFileElem:function(){var t=a(this.getVal());return this._elem("file")&&e.destruct(this._elem("file").domElem),e.append(this.domElem,'<span class="'+this.__self._buildClassName("file")+'"><span class="'+this.__self._buildClassName("text")+'">'+r.html(t)+'</span><span class="'+this.__self._buildClassName("clear")+'"/></span>'),this},_getButton:function(){return this.findChildBlock(n)}},{lazyInit:!0,onInit:function(){return this._domEvents("clear").on("pointerclick",this.prototype._onClearClick),this._domEvents("control").on("change",this.prototype._onChange),this.__base.apply(this,arguments)}}))}),modules.define("attach",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{onSetMod:{js:function(){var t=this.domElem.find(".button").attr("title");this.domElem.find("input").attr("title",t),this.__base.apply(this,arguments)}},_clear:function(){var t=this._elem("control").domElem.attr("accept"),e=this.__base.apply(this,arguments);return t&&this._elem("control").domElem.attr("accept",t),e}}))}),modules.define("sidebar",["i-bem-dom"],function(t,e){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this.onInit()},"":function(){this.clearDataProvider()}}},onInit:function(){},setDataProvider:function(t){return this.clearDataProvider(),this.setupDataListeners(),this._dataProvider=t,this},getDataProvider:function(){return this._dataProvider},clearDataProvider:function(){return this.teardownDataListeners(),this._dataProvider=null,this},setupDataListeners:function(){},teardownDataListeners:function(){}}))}),modules.define("input",[],function(t,e){t(e.declMod({modName:"fire-blur-change",modVal:!0},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._events().on({modName:"focused",modVal:"*"},this._onFocusedModChange,this)}},_onFocusedModChange:function(t,e){if(e.modVal)this._oldVal=this.getVal();else{var i=this._oldVal,o=this.getVal();i!==o&&this._emit("blurChange",{oldVal:i,newVal:o})}}}))}),modules.define("input",function(t,e){t(e.declMod({modName:"type",modVal:"number"},{setVal:function(t){if(t=String(t),this._val!==t){t=t.replace(/[^0-9,\.]+/gi,"").replace(/,/gi,"."),isNaN(Number(t))&&(t=this._val);var e=this._val!==t,i=this._elem("control");i.domElem.val()!==t&&i.domElem.val(t),e&&(this.__base.apply(this,arguments),this._val=t)}return this}}))}),modules.define("select",function(t,e){t(e.declMod({modName:"mode",modVal:"radio"},{_updateControl:function(){var t=this.getVal();this._elem("control").domElem.val(t)},_updateButton:function(){this._button.setText(this._getCheckedItems().get(0).getText())},_onMenuItemClick:function(t,e){"pointer"===e.source&&this.delMod("opened")}}))}),modules.define("menu",function(t,e){t(e.declMod({modName:"mode",modVal:"radio"},{_getVal:function(){for(var t,e=this.getItems(),i=0;t=e.get(i++);)if(t.hasMod("checked"))return t.getVal()},_setVal:function(t){var e=!1,i=!1,o=this.getItems().map(function(o){return o.isValEq(t)?(o.hasMod("checked")||(e=!0),i=!0):!1});return i?(this._updateItemsCheckedMod(o),e):!1},_onItemClick:function(t){this.__base.apply(this,arguments);var e=!1;this.getItems().forEach(function(i){i===t?i.hasMod("checked")||(i.setMod("checked",!0),this._isValValid=!1,e=!0):i.delMod("checked")},this),e&&this._emit("change")}}))}),modules.define("sidebar",["i-bem-dom","jquery","i18n-plus","config","history-manager","geoObject-list","input","textarea","link","button"],function(t,e,i,o,n,s,r,a,c,l,d,u){t(e.declBlock(u,{onSetMod:{step:function(t,e){this._elem("map-content-panel").setMod("hidden","map-content"!==e),this.__base.apply(this,arguments)},"can-create-new-map":function(){this._applySaveMapButtonState()}},onInit:function(){this._middleElem=this._elem("map-content-panel-inner-middle"),this.__base.apply(this,arguments),this._saveButton=this.findChildBlock({block:d,modName:"id",modVal:"saveBtn"}),this._importButton=this.findChildBlock({block:d,modName:"id",modVal:"importBtn"});var t=this._elem("map-content-panel-warning-close");t&&this._domEvents(t).on("click",function(){t.domElem.parent().remove()},this),this._events(this._saveButton).on("click",function(){this._validateValues(),this._emit("userSaveMapRequest")},this),this._events(this._importButton).on("click",function(){this._emit("importMapRequest")},this),this._nameInput=this.findChildBlock({block:a,modName:"id",modVal:"name"}),this._descriptionInput=this.findChildBlock({block:c,modName:"id",modVal:"desc"}),this._limitLink=this.findChildBlock({block:l,modName:"id",modVal:"limit-link"}),this._placesList=this.findChildBlock(r)},setDataProvider:function(t){var e=this.__base.apply(this,arguments);return this._placesList.setDataProvider(t),this._dataListener=this._dataProvider.createListener(),this._dataListener.add("mapName",function(t){this._nameInput.setVal(t)},this).add("mapDescription",function(t){this._descriptionInput.setVal(t)},this).add("sid",this._applyHeader,this).add("activeGeoObjectsIds",this._positionScroll,this),this._nameInput.setVal(this.getDataProvider().get("mapName","")),this._descriptionInput.setVal(this.getDataProvider().get("mapDescription","")),this._setGeoObjectList(this._dataProvider.get("geoObjects")),this._applyHeader(this._dataListener.get("sid")),this._applySaveMapButtonState(),e},clearDataProvider:function(){var t=this.__base.apply(this,arguments);return this._dataListener&&(this._dataListener.destroy(),this._dataListener=null),this._removeGeoObjectListener(),this._placesList.clearDataProvider(),t},setupDataListeners:function(){this._events(this._nameInput).on("change",this._onNameChange,this).on("blurChange",this._onNameBlurChange,this),this._events(this._descriptionInput).on("change",this._onDescriptionChange,this).on("blurChange",this._onDescriptionBlurChange,this),this.__base.apply(this,arguments)},teardownDataListeners:function(){this._events(this._nameInput).un("change",this._onNameChange,this),this._events(this._descriptionInput).un("change",this._onDescriptionChange,this),this.__base.apply(this,arguments)},_validateValues:function(){this._nameInput.validate(),this._descriptionInput.validate()},_positionScroll:function(t){if(t.length){var e=this._middleElem.domElem,i=e.position().top,o=e.height(),n=i+o,s=this._placesList.findChildElem("item_active_true").domElem;if(s.length){var r=s.position().top,a=s.height(),c=r+a;(i>r||c>n)&&(e.scrollTop(0),e.scrollTop(s.position().top-(a+o)/2))}}},_onNameChange:function(){this.getDataProvider().set("mapName",this._nameInput.getVal())},_onNameBlurChange:function(t,e){s.addPropertyState("mapName",e.newVal,e.oldVal)},_onDescriptionChange:function(){this.getDataProvider().set("mapDescription",this._descriptionInput.getVal())},_onDescriptionBlurChange:function(t,e){s.addPropertyState("mapDescription",e.newVal,e.oldVal)},_removeGeoObjectListener:function(){this._geoObjectsListener&&(this._geoObjectsListener.removeAll(),this._geoObjectsListener=null)},_setGeoObjectList:function(t){this._removeGeoObjectListener(),this._geoObjectsListener=t.events.group().add("geoObjectsAdd",this._checkGeoObjects,this).add("geoObjectsRemove",this._checkGeoObjects,this),this._checkGeoObjects()},_checkGeoObjects:function(){var t=this._dataProvider.get("geoObjects"),e=t.getLength(),i=e>0;this._elem("no-geoobjects").setMod("hidden",i),this._elem("geoObject-list-holder").setMod("hidden",!i),this._saveButton.setMod("view",i?"action":""),this._middleElem.setMod("list",i?"full":"");var s=o("sidebar","limit-link-hint",{$thousands:["num","total"],$conjugate:e,num:e,total:n.limits.count.geoObjects});this._limitLink.domElem.html(e+" / "+n.limits.count.geoObjects).attr("title",s),this._limitLink.setMod("warning",e>=.99*n.limits.count.geoObjects),this._limitLink.setMod("visible",e>=.5*n.limits.count.geoObjects),e>.5*n.limits.count.geoObjects?this._limitLink.domElem.show():this._limitLink.domElem.hide()},_applyHeader:function(t){this._elem("map-content-panel-heading").domElem.text(o("sidebar",t?"title_edit":"title_new"))},_applySaveMapButtonState:function(){this._saveButton.setMod("disabled",!this.getMod("can-create-new-map")&&!this._dataProvider.get("sid"))}}))}),modules.define("map-editor",["i-bem-dom","point-controller","line-controller","polygon-controller","ymaps-selection-geoObject","ymaps-geoObject-colors","ymaps-preset-utils","ymaps-api","config","jquery","map-data-default","yametrika","util-id","data-provider","ymaps-traffic-button","ymaps-zIndex","i18n-plus"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p,m,g,f,_,b){var v={point:i,linestring:o,polygon:n};t(e.declBlock(b,{applyStep:function(t,e){"edit"===t?(this._setupControls(),this._addEditorControllers()):"edit"===e&&(this._removeEditorControllers(),this._teardownControls()),this._setupBackgroundMap(t,e),this.__base.apply(this,arguments)},createEditorMap:function(){this.__base.apply(this,arguments),this._controllerData={};var t=new m;for(var e in v)if(v.hasOwnProperty(e)){var i=new v[e](this._map,t);this._controllerData[e]={controller:i,listener:this._setupControllerListener(i.events.group())}}},destroyEditorMap:function(){this._eachControllersData(function(t,e){t.destroy(),e.removeAll()},this),this.__base.apply(this,arguments)},setDataProvider:function(t){var e=this.__base.apply(this,arguments);return this._dataListener.add("saveState",function(e){"saving"===e&&t.set("drawingController",null)},this).add("drawingController",function(e,i){if(i&&this._controllerData[i].controller.stopDrawing(!0),e){var o=this._controllerData[e].controller;o.startDrawing()||t.unset("drawingController")}},this).add("focusedGeoObjectsIds",function(t,e){if(this._removeSelectionGeoObject(),t.length){var i=this._geoObjectById[t[0]];i&&(this._createSelectionGeoObject(i),f.setZIndex(i,"focus"))}if(e.length){var o=this._geoObjectById[e[0]];o&&f.unsetZIndex(o,"focus")}},this).add("activeGeoObjectsIds",function(t,e){var i;t.length?(i=this._geoObjectById[t[0]],i&&this._getControllerByGeoObject(i).setEditableGeoObject(i)):e.length&&(i=this._geoObjectById[e[9]],i&&this._getControllerByGeoObject(i).setEditableGeoObject())},this).add("geoObjectsWithBalloonIds",function(t,e){var i;t.length?(i=this._geoObjectById[t[0]],i&&!i.balloon.isOpen()&&i.balloon.open()):e.length&&(i=this._geoObjectById[e[0]],i&&i.balloon.isOpen()&&i.balloon.close())},this),this._processGeoObjects(this._dataProvider.get("geoObjects")),e},clearDataProvider:function(){var t=this.__base.apply(this,arguments);return this._clearGeoObjectsProviderListener(),t},_setupBackgroundMap:function(t,e){"edit"===t?(this._map.options.unset(Object.keys(u.disabledGeoObjectCollection)),this._map.behaviors.enable("rightMouseButtonMagnifier")):"edit"===e&&(this._map.options.set(u.disabledGeoObjectCollection),this._map.behaviors.disable("rightMouseButtonMagnifier"))},_processGeoObjects:function(t){function e(t,e,i){var o=new c.GeoObject({geometry:t.geometry,properties:t.properties},{preset:t.options.preset});f.setBaseZIndex(o,e),this._geoObjectById[t.properties.geoObjectId]=o,this._getControllerByGeoObject(o).addGeoObject(o,i)}if(this._clearGeoObjectsProviderListener(),t){this._geoObjectsProviderListener=t.events.group(),this._geoObjectsProviderListener.add("geoObjectsAdd",function(t){t.get("geoObjectsData").forEach(function(t){this._findGeoObjectByData(t.data)||"map"===t.data.properties.source||e.call(this,t.data,t.data.options.zIndex,"history"===t.data.properties.source)},this),t.get("canAddMore")||this._applyCanAddMoreState(!1)},this).add("geoObjectsRemove",function(t){t.get("geoObjectsData").forEach(function(t){var e=this._findGeoObjectByData(t.data);if(e){this._getControllerByGeoObject(e).removeGeoObject(e);var i=t.collection;i.length&&this._reorderGeoObject(i,0,i.length-1)}},this),t.get("canAddMore")&&this._applyCanAddMoreState(!0)},this).add("geoObjectsUpdate",function(t){var e=t.get("updates");t.get("geoObjectsData").forEach(function(t,i){var o=this._findGeoObjectByData(t.data);this._getControllerByGeoObject(o).updateGeoObject(o,e[i].data)},this)},this).add("geoObjectReorder",function(t){this._reorderGeoObject(t.get("collection"),t.get("newIndex"),t.get("oldIndex"))},this),this._disableControllerListeners(),this._eachControllersData(function(t){t.removeAllGeoObjects()},this);for(var i in this._controllerData)this._controllerData.hasOwnProperty(i)&&t.getByType(i).forEach(e,this);this._enableControllerListeners(),t.canAddGeoObject()||this._applyCanAddMoreState(!1)}},_clearGeoObjectsProviderListener:function(){this._geoObjectById={},this._geoObjectsProviderListener&&(this._geoObjectsProviderListener.removeAll(),this._geoObjectsProviderListener=null)},_reorderGeoObject:function(t,e,i){var o,n;if(i>e)for(o=e,n=i;n>=o;o++)f.setBaseZIndex(this._findGeoObjectByData(t[o]),o);else for(o=e,n=i;o>=n;o--)f.setBaseZIndex(this._findGeoObjectByData(t[o]),o)},_createSelectionGeoObject:function(t){this._geoObjectSelection=s.create(this._map,t)},_removeSelectionGeoObject:function(){this._geoObjectSelection&&(this._geoObjectSelection.destroy(),this._geoObjectSelection=null)},_findGeoObjectByData:function(t){return this._geoObjectById[t.properties.geoObjectId]},_addEditorControllers:function(){this._eachControllersData(function(t){t.addToMap()},this)},_removeEditorControllers:function(){this._eachControllersData(function(t){t.removeFromMap()},this)},_enableControllerListeners:function(){this._eachControllersData(function(t,e){this._setupControllerListener(e)},this)},_setupControllerListener:function(t){return t.add("startDrawing",function(t){this._lastActiveController=t.get("target"),this._teardownRuler(),this.getDataProvider().set("drawingController",t.get("controllerName"))},this).add("stopDrawing",function(){this._lastActiveController=null,this.getDataProvider().set("drawingController",null)},this).add("setDrawingMode",function(t){this._dataProvider.set("drawingMode",t.originalEvent.state)},this).add("geoObjectAdd",this._onGeoObjectAdd,this).add("geoObjectUpdate",this._onGeoObjectUpdate,this).add("geoObjectRemove",this._onGeoObjectRemove,this).add("setFocusedGeoObject",function(t){var e=t.get("target").properties.get("geoObjectId");this.getDataProvider().set("focusedGeoObjectsIds",[e])},this).add("unsetFocusedGeoObject",function(){this.getDataProvider().set("focusedGeoObjectsIds",[])},this).add("setActiveGeoObject",function(t){var e=t.get("target").properties.get("geoObjectId");this.getDataProvider().set("activeGeoObjectsIds",[e])},this).add("unsetActiveGeoObject",function(){this.getDataProvider().set("activeGeoObjectsIds",[])},this).add("geoObjectBalloonOpen",function(t){var e=t.get("target").properties.get("geoObjectId");
this.getDataProvider().set("geoObjectsWithBalloonIds",[e])},this).add("geoObjectBalloonClose",function(){this.getDataProvider().set("geoObjectsWithBalloonIds",[])},this).add("simplifyStart",function(t){this._emit("simplifyStart",t.originalEvent)},this).add("simplifyEnd",function(t){this._emit("simplifyEnd",t.originalEvent);var e=t.get("geoObjectPoints");if(e){var i=this.getDataProvider(),o=c.util.bounds.fromPoints(e),n=this._map.getBounds();if(!c.util.bounds.containsBounds(n,o)){var s=c.util.bounds.getCenterAndZoom(o,i.get("currentContainerSize"));c.getZoomRange(i.get("type"),s.center).then(function(t){var e=Math.max(Math.min(s.zoom,t[1]),t[0]);i.set("center",s.center),i.set("zoom",e)})}}},this).add("geoObjectDragStart",function(t){var e=t.get("geoObjectId");this.getDataProvider().set("draggingGeoObject",e)},this).add("geoObjectDragEnd",function(){this.getDataProvider().set("draggingGeoObject",null)},this)},_disableControllerListeners:function(){this._eachControllersData(function(t,e){e.removeAll()},this)},_onStartDrawing:function(t){this._lastActiveController=t.get("target"),this._teardownRuler()},_onStopDrawing:function(){this._lastActiveController=null},_stopDrawing:function(){this._lastActiveController&&this._lastActiveController.stopDrawing()},_onGeoObjectAdd:function(t){var e=t.get("geoObject");if(!e.properties.get("geoObjectId")){var i=this.getDataProvider().get("geoObjects"),o=i.addGeoObjects([this._getGeoObjectData(e,!0)]),n=o[0].id;this._geoObjectById[n]=e,e.properties.set("geoObjectId",n),f.setBaseZIndex(e,i.getIndex(n))}},_onGeoObjectUpdate:function(t){var e=t.get("geoObject"),i={},o=t.get("field");i[o]=this._getGeoObjectData(e)[o],this.getDataProvider().get("geoObjects").updateGeoObjects([{id:e.properties.get("geoObjectId"),data:i}])},_onGeoObjectRemove:function(t){var e=t.get("geoObject").properties.get("geoObjectId");delete this._geoObjectById[e];var i=this.getDataProvider().get("geoObjects"),o=i.getCollection(e);if(o){var n=i.getIndex(e);i.removeGeoObjects([e]),n<o.length&&this._reorderGeoObject(o,n,o.length-1)}},_getGeoObjectData:function(t,e){var i={iconContent:t.properties.get("iconContent"),iconCaption:t.properties.get("iconCaption"),description:t.properties.get("description"),name:t.properties.get("name")};return e&&(i.source="map"),{options:{preset:t.options.get("preset")},properties:i,geometry:{coordinates:t.geometry.getCoordinates(),type:t.geometry.getType()}}},_setupControls:function(){this._trafficControl||(this._trafficControl=new g,this._trafficMonitor=new c.Monitor(this._trafficControl.state),this._trafficMonitor.add("selected",function(t){this.getDataProvider().set("trafficShown",t),this._trafficControl.state.get("metrika")&&h.reachGoal("MAP_CONTROL",{cnstControlUsed:"traffic"})},this)),this._addHistoryControls(),this._map.controls.add("zoomControl"),this._map.controls.get("zoomControl").options.set("size","small"),this._map.controls.add("searchControl",{position:{left:76,top:10},noCentering:!0,noPlacemark:!0,useMapBounds:!0}).add("rulerControl"),this._trafficControl.getParent()!==this._map.controls&&this._map.controls.add(this._trafficControl,{"float":"left",floatIndex:200}),this._trafficControl.options.set("visible",!0),this._typeSelector=new c.control.TypeSelector,this._typeSelector.options.set("panoramasItemMode","off"),this._map.controls.add(this._typeSelector,{"float":"left",floatIndex:100}),this._typeSelector.events.add("collapse",this._onTypeSelectorCollapse,this);var t=this._map.controls.get("searchControl");t.options.set("noPlacemark",!0);var e=this.getDataProvider();this._trafficControl.state.set("metrika",!1),this._trafficControl.state.set("selected",e&&e.get("trafficShown",!1)),this._trafficControl.state.set("metrika",!0),this._map.controls.get("rulerControl").events.add("select",this._onRulerSelect,this),this._map.controls.getContainer().firstChild.style.marginTop="50px",t.events.add("resultselect",this._onSearchResult,this).add("submit",this._onSearchSubmit,this),this._applySearchControlState()},_teardownControls:function(){this._teardownRuler(!0),this._teardownHistoryButtons(),this._map.controls.get("searchControl").events.remove("resultselect",this._onSearchResult,this).remove("submit",this._onSearchSubmit,this),this._map.controls.get("rulerControl").events.remove("select",this._onRulerSelect,this),this._typeSelector.events.remove("collapse",this._onTypeSelectorCollapse,this),this._map.controls.remove("zoomControl").remove("searchControl").remove("typeSelector").remove("rulerControl").remove(this._typeSelector),this._trafficControl.options.set("visible",!1),this._trafficControl.state.set("metrika",!1)},_teardownRuler:function(t){var e=this._map.behaviors.get("ruler");e&&(e.disable(),t&&e.setState(""))},_eachControllersData:function(t,e){for(var i in this._controllerData)if(this._controllerData.hasOwnProperty(i)){var o=this._controllerData[i],n=t.call(e,o.controller,o.listener);if(n===!1)return}},_onRulerSelect:function(){this._stopDrawing(),h.reachGoal("MAP_CONTROL",{cnstControlUsed:"ruler"})},_onTypeSelectorCollapse:function(t){var e,i=t.get("target").getAll();i.every(function(t){return t.state.get("selected")?(e=t.data.get("mapType").split("#")[1],!1):!0}),this._map._lastMapType!==e&&(this._map._lastMapType=e,h.reachGoal("MAP_CONTROL",{cnstControlUsed:e+"Layer"}))},_onSearchResult:function(t){var e=t.get("target");e.getResult(t.get("index")).then(function(t){var e=t.geometry.getCoordinates(),i=this._dataProvider&&this._dataProvider.get("geoObjects").canAddGeoObject();if(i){var o=t.properties,n=o.get("description"),s=o.get("name");s&&n?s=n+", "+s:n&&(s=n);var r=this._controllerData.point.controller.createGeoObject(e,{description:s});this._controllerData.point.controller.addGeoObject(r),r.balloon.open()}else this._map.setCenter(e)},this)},_onSearchSubmit:function(){h.reachGoal("MAP_CONTROL",{cnstControlUsed:"search"})},_getControllerByGeoObject:function(t){return this._controllerData[t.geometry.getType().toLowerCase()].controller},_applyCanAddMoreState:function(t){this._eachControllersData(function(e){t?e.enableAddingNewObjects():e.disableAddingNewObjects()},this)},_applySearchControlState:function(){var t=this._map.controls.get("searchControl");t.options.set("fitMaxWidth",!0),t.options.set("maxWidth",[30,72,516])}}))}),modules.define("popup",["objects"],function(t,e,i){t(i.declMod({modName:"theme",modVal:"colors"},{getDefaultParams:function(){return e.extend(this.__base(),{mainOffset:5,viewportOffset:10})}}))}),modules.define("select",function(t,e){t(e.declMod({modName:"theme",modVal:"icons"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._updateButton()}}},getPopup:function(){return this._popup},_updateButton:function(){this._button.findChildElem("text").domElem.html(this._getCheckedItems().get(0).domElem.find(".menu-preview").clone().css("display","block"))}}))}),modules.define("popup",["objects"],function(t,e,i){t(i.declMod({modName:"theme",modVal:"icons"},{getDefaultParams:function(){return e.extend(this.__base(),{mainOffset:5,viewportOffset:10})}}))}),modules.define("input",[],function(t,e){t(e.declMod({modName:"range",modVal:!0},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._events().on({modName:"focused",modVal:""},this._onRangeInputBlur,this)}},_onRangeInputBlur:function(){var t,e=Number(this.getVal());isNaN(e)?t=this.domElem.data("min"):(t=e,t=Math.max(t,this.domElem.data("min")),t=Math.min(t,this.domElem.data("max"))),t!==this.getVal()&&this.setVal(t)}}))}),modules.define("dropdown",["button"],function(t,e,i){t(i.declMod({modName:"switcher",modVal:"button"},{onSetMod:{opened:function(t,e){this.__base.apply(this,arguments);var i=this.getSwitcher();i.hasMod("togglable","check")&&i.setMod("checked",e)}},getSwitcher:function(){return this._switcher||(this._switcher=this.findMixedBlock(e))}},{onInit:function(){return this._events(e).on("click",this.prototype.onSwitcherClick),this.__base.apply(this,arguments)}}))}),modules.define("popup-close-button",["i-bem-dom","modal"],function(t,e,i){t(e.declBlock(this.name,{onSetMod:{js:{inited:function(){this._modal=this.findParentBlock(i),this._modal&&this._domEvents().on("click",this._onClick)}}},_onClick:function(){this._modal.setMod("visible",!1)}}))}),modules.define("sidebar",["i-bem-dom","jquery","config","result-link","i18n-plus","util-deferred-action","util-size-converter","ymaps-utils","yametrika","ymaps-counter","radio-group","input","textarea","button","link","select","popup","checkbox","error-hint"],function(t,e,i,o,n,s,r,a,c,l,d,u,h,p,m,g,f,_,b,v,y){function M(t){return"print-error-map"===t}function j(t,e,i){return"interactiveScript"===i?['<script type="text/javascript" charset="utf-8" async src="',n.getLink("interactiveScript",t,e,!0),'"></script>'].join(""):['<iframe src="',n.getLink("interactiveIframe",t,e,!0),'&amp;source=constructor" width="',"available"===e[0]?"100%":e[0],'" height="',"available"===e[1]?"100%":e[1],'" frameborder="0"></iframe>'].join("")}function I(t,e){return['<a href="',n.getMapLink(t,{source:"constructorStatic",specChars:!0}),'" target="_blank">','<img src="',n.getLink("static",t,e,!0),'" alt="" style="border: 0;" /></a>'].join("")}var C,k={interactive:j,"static":I},x="export-settings-panel-";t(e.declBlock(y,{onSetMod:{step:function(t,e){this._elem("export-settings-panel").setMod("hidden","export-settings"!==e),this._checkSize(),this._hideMessageHints(!0),this.__base.apply(this,arguments)}},onInit:function(){this.__base.apply(this,arguments),this._interactiveMapSwitcher=this.findChildBlock({block:u,modName:"id",modVal:"interactive-map-switcher"}),this.noticeScript=this._elem(x+"about-api-link"),this.noticeIframe=this._elem(x+"iframe-confines-link"),this.iframeErrorMap=this._elem(x+"iframe-error-map"),this.iframeErrorZoom=this._elem(x+"iframe-error-zoom"),this._mapTypeSwitcher=this.findChildBlock({block:u,modName:"id",modVal:"main-switcher"}),this._staticSwitcher=this.findChildBlock({block:u,modName:"id",modVal:"static-switcher"}),this._mapWidth=this.findChildBlock({block:h,modName:"id",modVal:"map-width"}),this._mapHeight=this.findChildBlock({block:h,modName:"id",modVal:"map-height"}),this._codePreview=this.findChildBlock({block:p,modName:"id",modVal:"code-preview"}),this._fitWidthCheckbox=this.findChildBlock({block:b,modName:"id",modVal:"fit-width"}),this._mapLinkInput=this.findChildBlock({block:h,modName:"id",modVal:"map-link"}),this._onInYmapsButton=this.findChildBlock({block:m,modName:"id",modVal:"open-in-ymaps"}),this._getCodeHint=this.findChildBlock({block:_,modName:"id",modVal:"code-popup"}),this._sizeErrorHint=this.findChildBlock({block:_,modName:"id",modVal:"error-popup"}),this._imageDpiSelector=this.findChildBlock({block:f,modName:"id",modVal:"dpi-selector"}),this._imageExtensionSelector=this.findChildBlock({block:f,modName:"id",modVal:"image-extension"}),this._imageSizeTypeSelector=this.findChildBlock({block:f,modName:"id",modVal:"image-size-type"}),-1===["ru","en","tr"].indexOf(o.lang)&&this._elem(x+"about-api-link").domElem.remove(),this.setMod("cant-use-disk",!o.user.hasLogin),this._domEvents(this.domElem.find(".classic-print-button")).on("click",function(){this._emit("classicPrintRequest"),d.countByKey("distribution","constructorToMapsPrint."+d.getPlatform())},this),this._setupControls()},setDataProvider:function(t){var e=this.__base.apply(this,arguments);this._exportDataListener=this._dataProvider.createListener(),this._exportDataListener.add("type",function(t){this.iframeErrorMap&&this.iframeErrorMap.setMod("hidden","yandex#map"===t||"interactiveIframe"!==this._dataProvider.get("mapType"))},this).add("previewError",this._applyLayoutType,this).add("containerSize",function(t){this._mapWidth.getMod("disabled")||parseFloat(t[0])===this._getSize(this._mapWidth)||this._setSize(this._mapWidth,t[0]),this._mapHeight.getMod("disabled")||parseFloat(t[1])===this._getSize(this._mapHeight)||this._setSize(this._mapHeight,t[1]),this._hideMessageHints(),this._updateCodePreview()},this).add("sid",this._updateCodePreview,this).add("mapType",function(){this._imageSizeTypeSelector.setVal("px"),this.teardownDataListeners(),this._setupControlGroups();var t=this._getSize(this._mapWidth),e=this._getSize(this._mapHeight),i=this.getDataProvider(),o=i.get("minContainerSize"),n=i.get("maxContainerSize");t<o[0]?this._mapWidth.setVal(o[0]):t>n[0]&&this._mapWidth.setVal(n[0]),e<o[1]?this._mapHeight.setVal(o[1]):e>n[1]&&this._mapHeight.setVal(n[1]),this._checkFitWidth(),this._setProviderSize(),this._checkSize(),this._hideMessageHints(),this._updateCodePreview(),this._applyLayoutType(),this.setupDataListeners(),C=i.get("mapType")},this),this._imageDpiSelector.setVal(t.get("imageExportScale")),this._imageExtensionSelector.setVal(t.get("imageExportFileType")),this._imageSizeTypeSelector.setVal("px"),this._fitWidthCheckbox.setMod("checked",!1),this._setType(t.get("mapType")),this._applyLayoutType();var i=t.get("containerSize");return i&&(this._mapWidth.setVal(i[0]),this._mapHeight.setVal(i[1])),this._setupControlGroups(),this._checkFitWidth(),this._updateCodePreview(),this._updateSidebarNoticeText(),c.isInteractiveType(t.get("mapType"))?(this._interactiveMapSwitcher.setVal(t.get("mapType")),this._setType("interactiveScript")):this._setType(t.get("mapType")),e},clearDataProvider:function(){var t=this.__base.apply(this,arguments);return this._exportDataListener&&(this._exportDataListener.destroy(),this._exportDataListener=null),t},setupDataListeners:function(){this._events(this._mapWidth).on("change",this._onResize,this),this._events(this._mapHeight).on("change",this._onResize,this),this._events(this._interactiveMapSwitcher).on("change",this._onInteractiveMapSwitcherChange,this),this._events(this._mapTypeSwitcher).on("change",this._onMapTypeSwitcherChange,this),this._events(this._staticSwitcher).on("change",this._onMapTypeSwitcherChange,this),this._events(this._imageDpiSelector).on("change",this._onImageDpiChange,this),this._events(this._imageExtensionSelector).on("change",this._onImageExtensionChange,this),this._events(this._imageSizeTypeSelector).on("change",this._onImageSizeTypeChange,this),this._events(this._fitWidthCheckbox).on({modName:"checked",modVal:"*"},this._onFullSizeChecked,this),this.__base.apply(this,arguments)},teardownDataListeners:function(){this._events(this._mapWidth).un("change",this._onResize,this),this._events(this._mapHeight).un("change",this._onResize,this),this._events(this._imageDpiSelector).un("change",this._onImageDpiChange,this),this._events(this._imageExtensionSelector).un("change",this._onImageExtensionChange,this),this._events(this._imageSizeTypeSelector).un("change",this._onImageSizeTypeChange,this),this._events(this._interactiveMapSwitcher).un("change",this._onInteractiveMapSwitcherChange,this),this._events(this._mapTypeSwitcher).un("change",this._onMapTypeSwitcherChange,this),this._events(this._staticSwitcher).un("change",this._onMapTypeSwitcherChange,this),this._events(this._fitWidthCheckbox).un({modName:"checked",modVal:"*"},this._onFullSizeChecked,this),this.__base.apply(this,arguments)},getData:function(){var t=[this._getSize(this._mapWidth),this._getSize(this._mapHeight)],e=this._fitWidthCheckbox.getMod("checked");return e&&(t[0]="available"),i.extend(this.__base.apply(this,arguments),{size:t})},_getType:function(){var t=this._mapTypeSwitcher.getVal();return"site"===t&&(t=this._staticSwitcher.getVal()),t},_setType:function(t){"print"===t?this._mapTypeSwitcher.setVal(t):(this._mapTypeSwitcher.setVal("site"),this._staticSwitcher.setVal(t))},_checkFitWidth:function(){c.isInteractiveType(this.getDataProvider().get("mapType"))?this._fitWidthCheckbox.setMod("checked",this._fitWidthCheckbox.getMod("checked")):this._fitWidthCheckbox.setMod("checked",!1)},_setupControlGroups:function(){var t=this.getDataProvider().get("mapType"),e=["interactive","static","print"];e.forEach(function(e){t=c.isInteractiveType(t)?"interactive":t,this.findChildElems(x+e+"-group").setMod("hidden",t!==e),this.findChildElems(x+"un"+e+"-group").setMod("hidden",t===e)},this),this._applyMapWidthDisabled()},_setupControls:function(){function t(t){this._emit("saveMapToImageRequest",{saveToDisk:t})}this._events(this.findChildBlock({block:g,modName:"id",modVal:"back-button"})).on("click",function(){this._hideMessageHints(!0),this.setMod("step","map-content")},this),this._events(this.findChildBlock({block:g,modName:"id",modVal:"export-link"})).on("click",function(){this._emit("saveMapDataRequest")},this),this._domEvents(this.findChildElem("export-settings-panel-get-code-close-button")).on("click",this._hideCodeHint,this),this.showCodeButton=this.findChildBlock({block:m,modName:"id",modVal:"get-code-btn"}),this._events(this.showCodeButton).on("click",function(){this._getCodeHint.setAnchor(this.showCodeButton).setMod("visible",!this._getCodeHint.getMod("visible"));var t=this._getCodeHint.findChildBlock(p);this._domEvents(t).on("click",function(){i(t.domElem).select(),l.clickCode(this.getDataProvider())})},this),this._mapLinkInput.domElem.on("mouseup",function(){l.reachGoal("CLICK_LINK")}),this._events(this._onInYmapsButton).on("click",function(){var t=this.getDataProvider();if(t.get("sid")){var e=n.getMapLink(t.get("sid"),{source:"constructorLink"});window.open(e,"_blank"),l.reachGoal("OPEN_IN_YMAPS"),d.countByKey("distribution","constructorToMaps."+d.getPlatform())}},this),this._printButton=this.findChildBlock({block:m,modName:"id",modVal:"export-image-button"}),this._events(this._printButton).on("click",function(){t.call(this,!0)},this),this._downloadButton1=this.findChildBlock({block:m,modName:"id",modVal:"download-button"}),this._events(this._downloadButton1).on("click",function(){t.call(this,!1)}),this._downloadButton2=this.findChildBlock({block:m,modName:"id",modVal:"download-file-button"}),this._events(this._downloadButton2).on("click",function(){t.call(this,!1)})},_onFullSizeChecked:function(t,e){c.isInteractiveType(this._dataProvider.get("mapType"))?(e.modVal&&(this._oldContainerWidth=this._dataProvider.get("containerSize")[0]),this._mapWidth.setMod("disabled",e.modVal),this._dataProvider.set("containerSize",[e.modVal?"available":this._oldContainerWidth,this._dataProvider.get("containerSize")[1]]),e.modVal&&this._mapWidth.setVal(this._oldContainerWidth,null,!0)):this._mapWidth.setMod("disabled",e.modVal),this._updateCodePreview()},_onResize:function(){this._checkSize()&&this._setProviderSize(),this._hideMessageHints(!0)},_checkSize:function(){function t(t){return Number(t===Math.floor(t)?t:t.toFixed(2))}if("export-settings"!==this.getMod("step"))return this._hideSizeErrorHint(),!0;var e=this.getDataProvider(),i=e.get("mapType");i=c.isInteractiveType(i)?"interactive":i;var o=[this._mapWidth,this._mapHeight],n=o.every(function(e,o){if(e.getMod("disabled"))return!0;var n,s=e.getVal()||0,r=this.getDataProvider(),c=r.get("imageExportSizeType"),l=r.get("minContainerSize").concat(),d=r.get("maxContainerSize").concat();return l[0]=t(a.fromPixels(c,l[0])),d[0]=t(a.fromPixels(c,d[0])),l[1]=t(a.fromPixels(c,l[1])),d[1]=t(a.fromPixels(c,d[1])),s<l[o]?(n="size-error-hint-min-"+i,"print"===r.get("mapType")&&"px"!==c&&(n+="_"+c),this._showSizeErrorHint(e,n,l),!1):s>d[o]?(n="size-error-hint-max-"+i,"print"===r.get("mapType")&&"px"!==c&&(n+="_"+c),this._showSizeErrorHint(e,n,d),!1):!0},this);return n&&this._hideSizeErrorHint(),n},_setProviderSize:function(){var t=this._fitWidthCheckbox.getMod("checked");this.getDataProvider().set("containerSize",[t?"available":this._getSize(this._mapWidth),this._getSize(this._mapHeight)])},_updateCodePreview:function(){var t=this.getDataProvider().get("sid"),e=this.getDataProvider().get("containerSize"),i=this._dataProvider.get("mapType"),o=c.isInteractiveType(i)?"interactive":"static";if(k.hasOwnProperty(o)){var s=k[o](t,e,i),r=n.getMapLink(t,{source:"constructorLink"});this._codePreview.setVal(s),this._mapLinkInput.setVal(r)}},_updateSidebarNoticeText:function(){var t="interactiveIframe"===this.getDataProvider().get("mapType");this.noticeScript.setMod("hidden",t),this.noticeIframe.setMod("hidden",!t)},_updateInteractiveSwitcherVisibility:function(){var t=this.getDataProvider().get("mapType");this._interactiveMapSwitcher.setMod("hidden",Boolean(!c.isInteractiveType(t)))},_onInteractiveMapSwitcherChange:function(){var t=this._interactiveMapSwitcher.getVal();this.getDataProvider().set("mapType",t),this._updateCodePreview(),this._updateSidebarNoticeText(),this._getCodeHint.setAnchor(this.showCodeButton)},_onMapTypeSwitcherChange:function(){var t=this._getType();t="interactiveScript"===t?this._interactiveMapSwitcher.getVal():t,this.getDataProvider().set("mapType",t),this._updateCodePreview(),this._updateSidebarNoticeText(),this._updateInteractiveSwitcherVisibility(),t=c.isInteractiveType(t)?"interactive":t,l.reachGoal("CHOOSE_"+t.toUpperCase())},_onImageDpiChange:function(){this.getDataProvider().set("imageExportScale",this._imageDpiSelector.getVal())},_onImageExtensionChange:function(){this.getDataProvider().set("imageExportFileType",this._imageExtensionSelector.getVal())},_onImageSizeTypeChange:function(){var t=this.getDataProvider(),e=this._imageSizeTypeSelector.getVal(),i=t.get("containerSize");this._events(this._mapWidth).un("change",this._onResize,this),this._events(this._mapHeight).un("change",this._onResize,this);var o=[0,0];"px"===e?o=i.concat():(o[0]=a.fromPixels(e,i[0]),o[1]=a.fromPixels(e,i[1]),o[0]=o[0].toFixed(2),o[1]=o[1].toFixed(2)),this._mapWidth.setVal(o[0]),this._mapHeight.setVal(o[1]),this._events(this._mapWidth).on("change",this._onResize,this),this._events(this._mapHeight).on("change",this._onResize,this),t.set("imageExportSizeType",e),l.reachGoal("EXPORT_TO_YADISK_CHOOSE_"+e.toUpperCase())},_showSizeErrorHint:function(t,e,i){r.createAction("showSizeHint",function(){t.setMod("error",!0),this._sizeErrorHint.findChildBlock(v).setContent(s("sidebar",e).replace("{width}",i[0]).replace("{height}",i[1])),this._sizeErrorHint.setAnchor(t).setMod("visible",!0)}.bind(this),500)},_hideSizeErrorHint:function(){r.cancelAction("showSizeHint"),this._mapWidth.setMod("error",!1),this._mapHeight.setMod("error",!1),this._sizeErrorHint.setMod("visible",!1)},_hideCodeHint:function(){this._getCodeHint.setMod("visible",!1)},_hideMessageHints:function(t){if(t)return void this._hideCodeHint();var e=c.isInteractiveType(this.getDataProvider().get("mapType"));if(C||!e){var i=C&&c.isInteractiveType(C)&&e;i||this._hideCodeHint()}},_setSize:function(t,e){var i=this.getDataProvider(),o=i.get("imageExportSizeType");t.setVal("print"===i.get("mapType")&&"px"!==o?a.fromPixels(o,e).toFixed(2):e)},_getSize:function(t){var e=t.getVal()||"0",i=parseFloat(e.replace(/,/g,".")),o=this.getDataProvider(),n=o.get("imageExportSizeType");return Math.round("print"===o.get("mapType")&&"px"!==n?a.toPixels(n,i):i)},_applyLayoutType:function(){var t,e=!1,i=!1,o=!1,n=this.getDataProvider(),s=n.get("previewError").code,r=n.get("mapType");if("print"===r&&s?t="print-error-"+s:"interactiveIframe"===r&&("zoom"===s?(e=!0,i=!0):"map"===s&&(this.iframeErrorMap.setMod("hidden",!1),o=!0)),this._codePreview.setMod("hidden",e),this.iframeErrorZoom.setMod("hidden",!i),this.iframeErrorMap.setMod("hidden",!o),this._getCodeHint.setAnchor(this.showCodeButton),this._printErrorBlock!==t){this._printErrorBlock&&this._elem(x+this._printErrorBlock).setMod("hidden",!0),t&&this._elem(x+t).setMod("hidden",!1),this._printErrorBlock=t,this._elems(x+"map-usage-notice").setMod("hidden",Boolean(t)),this._elems(x+"standard-print-block").setMod("hidden",Boolean(t)),this._elems(x+"print-error-notice").setMod("hidden",!Boolean(t));var a=Boolean(t&&!M(t));this._applyMapWidthDisabled(),this._mapHeight.setMod("disabled",a),this._imageDpiSelector.setMod("disabled",a),this._imageExtensionSelector.setMod("disabled",a),this._imageSizeTypeSelector.setMod("disabled",a),this._printButton.setMod("disabled",a),this._downloadButton1.setMod("disabled",a),this._downloadButton2.setMod("disabled",a),this._checkSize()}},_applyMapWidthDisabled:function(){var t=this.getDataProvider().get("mapType");this._mapWidth.setMod("disabled",Boolean("print"===t&&this._printErrorBlock&&!M(this._printErrorBlock)||c.isInteractiveType(t)&&this._fitWidthCheckbox.getMod("checked")))}}))}),modules.define("modal",["dom","jquery"],function(t,e,i,o){function n(){return Number(new Date)}var s=27;t(o.declMod({modName:"closable",modVal:!0},{onSetMod:{visible:{"true":function(){this.__base.apply(this,arguments),this._domEvents(window).on("keyup",this._onWindowKeyUp,!0),this._startTime=n(),this._domEvents().un("pointerclick"),this._domEvents().on("pointerclick",this._onPointerClickHandler,this)},"":function(){this.__base.apply(this,arguments),this._domEvents(window).un("keyup",this._onWindowKeyUp,!0)}}},_onPointerClickHandler:function(t){n()-this._startTime<800||e.contains(this._elem("content").domElem,i(t.target))||this.delMod("visible")},_onWindowKeyUp:function(t){t.which===s&&this.setMod("visible",!1)}}))}),modules.define("modal",function(t,e){function i(t,e){for(;t.parentNode;){if(t.parentNode===e)return!0;t=t.parentNode}return!1}var o=9;t(e.declMod({modName:"autofocus",modVal:!0},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._content=this.findChildElem("content"),this._content.domElem.attr("tabindex",0),this._domEvents(window).on("keyup",function(t){if(t.which===o&&this.getMod("visible")){var e=document.querySelector("*:focus");e&&!i(e,this.domElem[0])&&this._content.domElem.focus()}},this)}},visible:function(t,e){this.__base.apply(this,arguments),e===!0&&this._content.domElem.focus()}}}))}),function(){function t(t){return t&&"function"==typeof t||(t=function(){function t(){var t=function(e,i,o){var n=t._keysets[e];if(!n)throw new Error('Keyset "'+e+'" was not found.');var s=n[i];if(void 0===s)throw new Error('Key "'+i+'" in keyset "'+e+'" was not found.');return"function"==typeof s?s(o||{}):s};return t._keysets={},t._language="ru",t.add=function(e,i){return t._keysets[e]=i,t},t.setLanguage=function(t){return this._language=t,this},t.getLanguage=function(){return this._language},t.utils={plural:function(t){var e=t.count,i=t.one,o=t.some,n=t.many;void 0===n?n=o:void 0===o&&(o=n);var s=e%10,r=e%100;return 1===s&&11!==r?i:s>1&&5>s&&(10>r||r>20)?o:n},include:function(e){var i={};for(var o in e)e.hasOwnProperty(o)&&"key"!==o&&"keyset"!==o&&(i[o]=e[o]);return t(e.keyset,e.key,i)}},t}return t()}()),t.add("attach",{"button-text":"Выбрать файл","no-file":"файл не выбран"}),t.add("balloon",{balloon_content:"Описание",balloon_content_example:"Текст будет виден при клике по объекту",caption:"Контент",color:"Цвет",fill:"Заливка",geoobject_opacity:"Прозрачность (%)",hint_content:"Всплывающая подсказка",hint_content_example:"Текст будет отображаться при наведении",icon:"Иконка",icon_caption_example:"Подпись метки",none:"Нет",or_caption:"или текст",placemark_type_caption:"С подписью",placemark_type_empty:"Пустая",placemark_type_numeric:"С номером",remove:"Удалить",save:"Готово",stroke:"Контур",stroke_width:"Толщина",type:"Тип"}),t.add("login-form",{login:"Войти",loginform_dont_remember_me:"Чужой компьютер",loginform_emptyvalue:"Заполните это поле",loginform_enter:"Войти",loginform_forgot_password:"Напомнить пароль",loginform_login:"Логин",loginform_password:"Пароль",loginform_registration:"Регистрация",message:"Войдите в свою учётную запись или зарегистрируйтесь на Яндексе, чтобы создавать и редактировать карты.",registration:"Регистрация",user_add_user:"Войти под другим именем ",user_disk:"Мой Диск",user_exit:"Выйти",user_passport:"Паспорт",user_settings:"Настройки",yadisk_file_name_pattern:"{map_name}_{dd}-{mo}-{yy}_{hh}-{mm}-{ss}",yadisk_folder_name:"Конструктор карт Яндекса"}),t.add("map-notice",{"map-notice":"Карта готова. Она будет выглядеть так.","return-to-map-list":"Список карт",service_description:"Конструктор карт Яндекса позволяет создать карту онлайн без навыков программирования. Можно отметить на карте нужные объекты, нарисовать схему проезда, маршрут прогулки или отметить зону доставки. Готовую карту легко разместить на сайте, в приложении или блоге. Её также можно скачать в высоком разрешении для печати или отправить ссылку друзьям",title:"Конструктор карт Яндекса"}),t.add("map-selection",{PRIVATE_MYMAPS:"После сохранения карта станет доступна для просмотра по прямой ссылке всем пользователям. Продолжить?","close-editor-confirm":"Вы уверены, что хотите закрыть редактор без сохранения? Все изменения будут утрачены.",constructor:"Конструктор карт",constructor_source:"Из конструктора",copy:"(Копия %)",copy_link:"Скопировать ссылку",copy_link_complete:"Ссылка скопирована","create-map":"Создать карту",create_new_map:"Создать карту",description:"Создавайте интерактивные или статические карты. На них можно отмечать схемы проезда, зоны доставки интернет-магазинов или просто свои любимые места в городе. Готовую карту можно встроить на сайт или отправить другу в виде ссылки.",description2:"Создавайте интерактивные или статические карты. На них можно отмечать схемы проезда, зоны доставки интернет-магазинов или просто свои любимые места в городе. Готовую карту можно встроить на сайт.",dublicate:"Создать копию",empty_maplist_button:"Список карт пуст. Создайте новую.","import-button":"К импорту →",map_search_button:"Найти",map_selection:"Выбрать из списка",mymaps_source:"Из моих карт","no-name-map":"Без названия",no_maps:"У вас пока нет ни одной карты",open_map:"Открыть карту",or_create_new:"или создайте новую",remove:"Удалить","remove-map-confirm":"Вы уверены, что хотите удалить карту? Восстановить её будет нельзя. Если карта была встроена на сайт, она перестанет отображаться.",select_map:"Список карт",share:"Поделиться",updated:"Обновлено "}),t.add("popup",{data_export_csv_desc:"Файл такого формата можно открывать в&nbsp;текстовых и табличных редакторах. Текст разбивается на&nbsp;столбцы с&nbsp;помощью специальных символов — разделителей.",data_export_csv_point_limits:"(координаты, описание, подпись, номер)",data_export_csv_separator:"Разделитель",data_export_csv_separator_comma:"Запятая",data_export_csv_separator_semicolon:"Точка с запятой",data_export_csv_separator_tab:"Табуляция",data_export_geojson_desc:"Формат геоданных на основе JSON. Поддерживается OpenLayers, Leaflet, Bing Maps, Yahoo! Maps и другими картографическими сервисами. ",data_export_geojson_line_limits:"(координаты, описание)",data_export_geojson_point_limits:"(координаты, описание, подпись, номер)",data_export_geojson_polygon_limits:"(координаты, описание)",data_export_gpx_desc:"Формат для хранения и обмена GPS-данными. Можно использовать в&nbsp;GPS-приложениях и API&nbsp;Яндекс.Карт — например, чтобы задать маршрут. ",data_export_gpx_line_limits:"(координаты, описание)",data_export_gpx_point_limits:"(координаты, описание, подпись)",data_export_header:"Экспорт объектов карты",data_export_help_hint:"Подробнее о форматах и экспорте ",data_export_kml_desc:"Формат на основе XML. Подходит для&nbsp;импорта объектов на&nbsp;карту, созданную в&nbsp;API&nbsp;Яндекс.Карт или Google&nbsp;Earth. ",data_export_kml_point_limits:"(координаты, описание, подпись, цвет)",data_export_limits_header:"В файл сохранятся:",data_export_success:"Файл сохранён",data_export_xlsx_desc:"Табличный формат MS&nbsp;Excel. В&nbsp;такие файлы удобно вносить изменения — например, чтобы загрузить на новую карту в Конструкторе.",data_export_xlsx_point_limits:"(координаты, описание, подпись, номер)",data_import_abort:"Отменить импорт",data_import_approve:"Добавить",data_import_button:"Выбрать файл",data_import_canbeadded:"можно добавить на карту",data_import_desc:'Файлы должны соответствовать <a href="https://yandex.{tld}/support/maps-builder/concept/markers_5.html" target="_blank">формату</a>.<br/> XLSX- и CSV-файлы должны быть заполнены по шаблонам',data_import_dragheader:"Загрузить файл для импорта",data_import_formats:"XLSX, CSV, KML, GPX или GeoJSON",data_import_header:"Импорт",data_import_mapname:"Импорт из «{name}»",data_import_objects:"{num} объект / {num} объекта / {num} объектов / {num} объектов",data_import_step1:"Чтение файла",data_import_step2:"Проверка на ошибки",data_import_step3:"Обработка объектов",data_import_step4:"Удаление лишних точек",data_import_step5:"Добавление на карту",data_import_table_headers:'"Широта";"Долгота";"Описание";"Подпись";"Номер метки"',data_import_template:"Скачать шаблон",data_import_warning:"Не получается добавить некоторые объекты",data_import_warning_limit:"Больше {num} объектов на одной карте отобразить нельзя.",data_import_warning_link:'<a href="https://yandex.{tld}/support/maps-builder/concept/markers_4.html#markers_4__limit" target="_blank">Подробнее об ограничениях</a>',data_import_warning_obs:'Не хватает данных для [{num} объекта / {num} объектов / {num} объектов / {num} объектов].<br/><a href="https://yandex.{tld}/support/maps-builder/concept/markers_5.html" target=_blank>Требования к формату</a>',data_import_warning_template:'<a href="%1">Посмотрите</a>, в каких строках есть ошибки. Вы можете исправить их<br/>по <a href="https://yandex.{tld}/support/maps-builder/concept/markers_5.html" target="_blank">шаблону</a> и импортировать файл снова.',data_import_warning_vlimit:"Объекты, которые состоят больше чем<br/> из {num} точек, будут упрощены.",date_export_file_loading:"Файл сохраняется",error_filetype_desc:'Проверьте, соответствует ли он<br/><a href="https://yandex.{tld}/support/maps-builder/concept/markers_5.html" target=_blank>требованиям к формату</a>',error_filetype_header:"Файл не читается",error_header:"Что-то пошло не так",error_message:'Попробуйте ещё раз позже <br/>или <a href="https://tech.yandex.{tld}/maps/doc/geocoder/desc/feedback/troubleshooting-docpage/" target=_blank>напишите нам</a>',errors_file_name:"ошибки",file_download_desc:'Если загрузка не началась, <br>нажмите на <a href="">ссылку</a>',file_download_header:"Файл загружается..",freedisk_description:"Чтобы сохранить файл,<br/>удалите что-нибудь ненужное",freedisk_header:"Нет места на Диске",helper_step_1_desc:"Ставьте метки на нужных объектах, рисуйте схемы проезда и выделяйте области.",helper_step_1_header:"Создайте собственную карту",helper_step_2_desc:"Вы также можете сохранить её в высоком качестве для печати.",helper_step_2_header:"Добавьте карту на сайт",helper_step_3_desc:'Подробная инструкция — в разделе <a href="https://yandex.{tld}/support/maps-builder/concept/" tabindex="-1" target="_blank">«Помощь».</a>',helper_step_3_header:"Узнайте о возможностях Конструктора",import_vlimit_desc:'Чтобы добавить новую точку, можно вручную удалить лишние или автоматически упростить контур. <a href="https://yandex.{tld}/support/maps-builder/concept/markers_4.html#markers_4__limit" target="_blank">Подробнее</a>',import_vlimit_header:"В объекте {num} точка из {total} возможных / В объекте {num} точки из {total} возможных / В объекте {num} точек из {total} возможных / В объекте {num} точек из {total} возможных",limit_warning_caption:"Подпись не может быть больше 256 символов",limit_warning_content:"Номер не может быть больше 3 символов",limit_warning_desc:"Описание не может быть больше 32000 символов",limit_warning_name:"Название не может быть больше 256 символов",line_simplified:"Линия упрощена. Количество точек: %1/%2",login_error_header:"Войдите в аккаунт",login_error_message:"Похоже, вы вышли из аккаунта, в&nbsp;котором начинали работу в&nbsp;Конструкторе.",login_suggest_another_acc:"",login_suggest_approve:"",login_suggest_text:"",map_print_loader_step1:"Подготовка данных",map_print_loader_step2:"Загрузка данных",map_print_loader_step3:"Создание карты",map_print_loader_step4:"Отрисовка карты",map_print_loader_step5:"Сохранение готовой карты на Яндекс.Диске",network_error_header:"Соединение с&nbsp;интернетом разорвано",network_error_message:"Убедитесь, что соединение восстановлено, и повторите действие. Если ошибка возникнет ещё раз, обновите страницу.",open_yadisk:"Перейти на Яндекс.Диск",open_yadisk_folder:"Открыть в Яндекс.Диске",poly_simplified:"Контур упрощён. Количество точек: %1/%2",save_popup_def_phrase:"Не закрывайте браузер и не выходите из аккаунта, чтобы не потерять данные",save_popup_line_header:"Сохраняем линии: {num} из {total}",save_popup_phrase_1:"Ваша карта получается восхитительной",save_popup_phrase_2:"Проверяем карту на соответствие галактическим стандартам",save_popup_phrase_3:"Можно пока кофе выпить",save_popup_phrase_4:"Съешь ещё этих мягких французских булок, да выпей чаю",save_popup_phrase_p1:"Устраиваем метки поудобнее",save_popup_phrase_p2:"Метка за меткой",save_popup_point_header:"Сохраняем метки: {num} из {total}",save_popup_poly_header:"Сохраняем многоугольники: {num} из {total}",seo_meta_keywords:"карта на сайт, зоны доставки, офис на карте, рисовать на карте, печать карты, карта для флаера, отметить на карте",simplify_help_hint:"Подробнее",simplify_line:"Упростить линию",simplify_poly:"Упростить контур",technical_break_header:"Сервис временно недоступен",technical_break_text:"Команда Конструктора ведёт технические работы,<br/> через несколько часов всё будет как обычно",technical_break_warning:"<b>Внимание!<br/><br/></b> 18 марта с 10:00 по московскому времени сайт будет недоступен из-за технических работ.<br/><br/> Сохраните все изменения заранее – иначе они могут пропасть",undo:"Отменить","ux-poll-button":"Пройти короткий опрос","ux-poll-desc":"Ваши ответы помогут сделать Конструктор карт удобнее","ux-poll-header":"Улучшаем Конструктор",yadisk_export:"Карта сохранена"}),t.add("sidebar",{"about-api":"<a href=https://tech.yandex.{tld}/maps/constructor/>Об API Конструктора</a>",about_constructor_api:"<a href=https://tech.yandex.{tld}/maps/constructor/ target=_blank>Подробнее об API Конструктора карт</a>",about_iframe_confines:"<a href=https://yandex.{tld}/support/maps-builder/concept/markers_2.html#markers_2__kod_iframe target=_blank>Об&nbsp;ограничениях для&nbsp;iframe</a>",circle:"Круги",cm:"см",data_export_button:"Экспорт",download:"Скачать","download-file":"Скачать файл",export_map_header:"Экспортировать карту","file-extension":"Формат файла:",format_km:"%1 км | %1 м | %1 см",format_sqr_km:"%1 км^2 | %1 м^2 | %1 см^2","fullscreen-size":"Растянуть на 100%",get_code:"Получить код карты",help:"Помощь",help_help:"Помощь",help_hotkeys:"Горячие клавиши",help_nk:"Править Яндекс.Карты",help_support:"Обратная связь",history_redo_hint:"Вернуть (Ctrl + Shift + Z)",history_redo_win_hint:"Вернуть (Ctrl + Shift + Z или Ctrl + Y)",history_undo_hint:"Отменить (Ctrl + Z)","html-code":"Код для сайта","iframe-error-map":"С помощью iframe можно вставить на сайт только карту со&nbsp;слоем «Схема».","iframe-error-zoom":"С помощью iframe нельзя отобразить на карте некоторые страны. Чтобы получить код, увеличьте масштаб.","image-dpi":"Качество:","interactive-map":"Вставить на сайт","interactive-map-notice":"Такую карту можно двигать, а объекты отзываются на действия пользователя.",km:"%_% км","limit-link-hint":"{num} объект из {total} возможных / {num} объекта из {total} возможных / {num} объектов из {total} возможных / {num} объектов из {total} возможных",line:"Линии",line_title:"Рисовать линии (Alt + L)\nЗакончить рисование (Esc)",m:"%_% м","map-content-header_notice":"Введите название и описание карты, добавьте на неё объекты","map-export":"Параметры карты","map-export-header_notice":"Задайте тип, размер, масштаб и центр карты","map-size":"Размеры карты:","map-usage-print":"Распечатать","map-usage-site":"На сайт",map_created:"Карта готова",map_description:"Описание",map_list_empty_btn:"Список карт пуст. Создайте новую.",map_name:"Название",map_type:"Тип карты",next:"Сохранить и продолжить","no-items":"Добавьте объекты на карту,<br/> здесь появится их список",noname:"Без описания","online-map":"Интерактивная карта",open_in_ymap:"Открыть в Яндекс.Картах","or-use-standart-print":"или воспользоваться <a href=# class=classic-print-button>стандартной печатью</a>",pixels:"px",places:"Список объектов",point:"Метки",point_title:"Рисовать метки (Alt + P)\nЗакончить рисование (Esc)",polygon:"Многоугольники",polygon_title:"Рисовать многоугольники (Alt + M)\nЗакончить рисование (Esc)",print:"Печать","print-error-browser":"Карты для печати в высоком разрешении можно создать только на компьютере в последних версиях браузеров Firefox, Chrome, Яндекс.Браузер, Edge, Safari и Opera.","print-error-map":"Карты для печати в высоком разрешении можно создать только на основе слоя «Схема».","print-error-notice":"Подробнее <a href=https://yandex.{tld}/support/maps-builder/concept/markers_2.html#markers_2__print_warning target=_blank>об ограничениях</a>.<br/><br/> Если качество не имеет значения, воспользуйтесь <a href=# class=classic-print-button>стандартной печатью</a>.","print-error-zoom":"Карты для печати в высоком разрешении можно создать только на небольших уровнях масштаба и не для всех стран.","printed-map":"Карта для печати","printed-map-notice":"Сохранение изображения карты в высоком разрешении. Есть ограничения — они описаны в <a href=https://yandex.{tld}/support/maps-builder/concept/markers_2.html#markers_2__print_warning target=_blank>документации</a>.",replace_linestring:"Перетащите линию, чтобы изменить порядок объектов",replace_point:"Перетащите метку, чтобы изменить порядок объектов",replace_polygon:"Перетащите фигуру, чтобы изменить порядок объектов","return-back":"← Вернуться к редактированию карты","save-to-yadisk":"Сохранить на Диск","size-error-hint-max-interactive":"Карта не может быть больше {width} на {height} пикселей. <br/>Если вы хотите растянуть карту на всю ширину контейнера, нажмите «Растянуть по ширине».","size-error-hint-max-print":"Карта не может быть больше {width} на {height} пикселей.","size-error-hint-max-print_cm":"Карта не может быть больше {width} на {height} сантиметра.","size-error-hint-max-print_in":"Карта не может быть больше {width} на {height} дюйма.","size-error-hint-max-static":"Карта не может быть больше {width} на {height} пикселей.","size-error-hint-min-interactive":"Карта не может быть меньше {width} на {height} пикселей.","size-error-hint-min-print":"Карта не может быть меньше {width} на {height} пикселей.","size-error-hint-min-print_cm":"Карта не может быть меньше {width} на {height} сантиметра.","size-error-hint-min-print_in":"Карта не может быть меньше {width} на {height} дюйма.","size-error-hint-min-static":"Карта не может быть меньше {width} на {height} пикселей.","static-map":"Статическая карта","static-map-notice":'Получится картинка в формате PNG. На статической карте можно разместить ограниченное число объектов. <a href="https://tech.yandex.{tld}/maps/doc/staticapi/1.x/dg/concepts/About-docpage" target="_blank">Подробнее</a>.',"static-map-notice2":'Получится картинка в формате PNG. Можно разместить <a href="https://tech.yandex.{tld}/maps/doc/staticapi/1.x/dg/concepts/About-docpage" target="_blank">ограниченное число объектов</a>.',stretch_by_width:"Растянуть по ширине",terms_of_use:'Я принимаю <a href="https://yandex.{tld}/legal/maps_api/" target="_blank">условия использования</a> API Яндекс.Карт',title_edit:"Редактирование карты",title_new:"Новая карта","to-map-list":"Вернуться к списку карт",traffic:"Пробки","yandex-map-link":"Ссылка на карту:"}),t.setLanguage("ru"),t
}"undefined"!=typeof modules?modules.define("y-i18n",function(e,i){e(t(i))}):"undefined"!=typeof module?module.exports=function(){return t()}:"undefined"!=typeof window?window.i18n=t():i18n=t()}();